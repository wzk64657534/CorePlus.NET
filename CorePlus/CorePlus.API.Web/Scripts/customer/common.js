T.i18n.currentLocale="zh-CN";T.i18n.number.formatNumber=function(a){if(a==null){return""}if(a=="--"){return a}if(isNaN(parseFloat(a))){return a}return T.i18n.number.format(a,T.i18n.currentLocale)};T.i18n.number.formatRatio=function(a){if(a==null){return""}if(a=="--"){return a}if(isNaN(parseFloat(a))){return a}return T.i18n.number.format(a,T.i18n.currentLocale)+"%"};T.i18n.number.formatTime=function(d,g){var b,f,h,e,a;if(d=="--"){return d}if(g==2){h=d/60|0;e=Math.round(d)-h*60;var c="";if(h){c+=h+"&#039;"}c+=e+"&quot;";return c}b=d/(24*3600)|0;d=Math.round(d)-b*24*3600;f=d/3600|0;d=Math.round(d)-f*3600;h=d/60|0;e=Math.round(d)-h*60;if(Math.round(b)<10){b=b>0?"0"+b:""}if(Math.round(f)<10){f="0"+f}if(Math.round(h)<10){h="0"+h}if(Math.round(e)<10){e="0"+e}if(b){a=b+" "+f+":"+h+":"+e}else{a=f+":"+h+":"+e}return a};T.config=T.config||{};T.config.holidays={"元旦节":/01\/0[1-3]$/,"春节":/(^2011\/02\/0[2-8]$)|(^2012\/01\/2[2-8]$)|(^2013\/02\/(09|1[0-5])$)/,"情人节":/02\/14$/,"愚人节":/04\/01$/,"清明节":/(^2011\/04\/0[3-5]$)|(^2012\/04\/0[2-4]$)|(^2013\/04\/0[4-6]$)/,"劳动节":/(^2011\/(04\/30|05\/0[12])$)|(^201[2-3]\/(04\/(29|30)|05\/01)$)/,"儿童节":/06\/01$/,"端午节":/(^2011\/06\/0[4-6]$)|(^2012\/06\/2[2-4]$)|(^2013\/06\/1[0-2]$)/,"建军节":/08\/01$/,"中秋节":/(^2011\/09\/1[0-2]$)|(^2012\/09\/30$)|(^2013\/09\/(19|2[0-1])$)/,"国庆节":/10\/0[1-7]$/,"圣诞节":/12\/25$/};T.config.lineChartDayTimeMap={"0":"00:00 - 00:59","1":"01:00 - 01:59","2":"02:00 - 02:59","3":"03:00 - 03:59","4":"04:00 - 04:59","5":"05:00 - 05:59","6":"06:00 - 06:59","7":"07:00 - 07:59","8":"08:00 - 08:59","9":"09:00 - 09:59","10":"10:00 - 10:59","11":"11:00 - 11:59","12":"12:00 - 12:59","13":"13:00 - 13:59","14":"14:00 - 14:59","15":"15:00 - 15:59","16":"16:00 - 16:59","17":"17:00 - 17:59","18":"18:00 - 18:59","19":"19:00 - 19:59","20":"20:00 - 20:59","21":"21:00 - 21:59","22":"22:00 - 22:59","23":"23:00 - 23:59"};baidu.lang.Class.create=function(b,a){return new b(a)};T.createClass=function(a){return T.lang.createClass(function(b){this.options=T.extend(T.object.clone(this.options),T.object.clone(b));this._init&&this._init()}).extend(a)};T.createUI=function(a){return T.ui.createUI(function(b){this.uiType=this._type;this.classPrefix=this._type;this.options=T.extend(T.object.clone(this.options),T.object.clone(b));this._init&&this._init()}).extend(a)};T.inlineTip=function(b){if(!T.g(b)){return}if(T.dom.hasAttr(T.g(b),"defaultText")){T.on(b,"click",function(){if(T.trim(this.value)==T.dom.getAttr(this,"defaultText")){T.dom.removeClass(this,"gray");this.value=""}else{T.dom.removeClass(this,"gray")}});T.on(b,"blur",function(){if(T.trim(this.value)==""||T.trim(this.value)==T.dom.getAttr(this,"defaultText")){T.dom.addClass(this,"gray");this.value=T.dom.getAttr(this,"defaultText")}});var a=T.dom.getAttr(T.g(b),"defaultText");if(a!=T.g(b).value){T.dom.removeClass(b,"gray")}else{T.dom.addClass(b,"gray")}}else{T.dom.addClass(b,"gray");T.on(b,"click",function(){if(T.trim(this.value)==this.defaultValue){T.dom.removeClass(this,"gray");this.value=""}});T.on(b,"blur",function(){if(T.trim(this.value)==""){T.dom.addClass(this,"gray");this.value=this.defaultValue}})}};T.getInlineTipInputValue=function(a){if(!T.g(a)){return}if(T.dom.hasAttr(T.g(a),"defaultText")){if(T.dom.getAttr(T.g(a),"defaultText")==T.g(a).value){return""}else{return T.g(a).value}}else{return T.g(a).value}};T.clearInlineTipInputValue=function(b){var a=T.g(b);if(a&&a.defaultValue!=null){T.dom.removeClass(a,"gray");a.value=a.defaultValue;T.event.uns([a],["focus","blur"])}};T.getCornerPosition=function(c,b,d){var c=T.g(c);var a=T.dom.getPosition(c);switch(b){case"br":a.left+=c.offsetWidth;a.top+=c.offsetHeight;break;case"tr":a.left+=c.offsetWidth;break;case"bl":a.top+=c.offsetHeight;break}if(d){if(d.left){a.left+=d.left}if(d.top){a.top+=d.top}}return a};T.setRelatedPosition=function(b,c,a,d){T.dom.setPosition(b,T.getCornerPosition(c,a,d))};T.expose=function(a){T.setRelatedPosition(a,a,"tl");T.dom.addClass(a,"expose")};T.unexpose=function(a){T.dom.removeClass(a,"expose")};T.event.ons=function(d,b,a,c){T.each(d,function(e){if(b instanceof Array){T.each(b,function(f){T.on(e,f,a,c)})}else{T.on(e,b,a,c)}})};T.ons=T.event.ons;T.event.uns=function(c,b,a){T.each(c,function(d){if(b instanceof Array){T.each(b,function(e){T.un(d,e,a)})}else{T.un(d,b,a)}})};T.uns=T.event.uns;baidu.truncat=function(b,a){if(b==null){return b}var c=1;if(/[^\x00-\xff]/.test(b)){a=Math.floor(2*a/3);c=2}if(b.length>a){return b.substr(0,a-2/c)+"..."}else{return b}};baidu.param=function(b){var a=[];baidu.object.each(b,function(d,c){if(d==null){return}if(baidu.lang.isArray(d)){baidu.each(d,function(e){a.push(encodeURIComponent(c+"[]")+"="+encodeURIComponent(e))})}else{a.push(encodeURIComponent(c)+"="+encodeURIComponent(d))}});return a.join("&").replace(/%20/g,"+")};baidu.dragable=function(b,a){var c=baidu.G(a.handler)||baidu.G(b);a.onbeforestart=a.onbeforestart||function(){};a.onstart=a.onafterstart||function(){};delete a.onafterstart;c.onmousedown=function(d){a.onbeforestart();baidu.dragable.orgUpHandler=document.onmouseup;baidu.drag(b,window.event||d,a);document.onmouseup=function(f){baidu.drag.stop();document.onmouseup=baidu.dragable.orgUpHandler};return false};c.onselectstart=function(d){return false}};baidu.ajax.checkConditionalPageTip=function(b){var a=T.g("ConditionalPageTip");if(b){text=T.dom.one(".text",a);text.innerHTML=b;T.show(a)}else{T.hide(a)}};baidu.ajax.jsonPost=function(b,c,a,d){baidu.ajax.request(b,{data:baidu.param(c),onsuccess:function(g){var e=null;try{e=baidu.json.decode(g.responseText);if(e.status===0||e.status>2){a(e.data,e.status);if(e.status===0&&/\/a$/i.test(c.method)){baidu.ajax.checkConditionalPageTip(e.msg)}}else{if(e.status===1){if(d){d(e.msg)}}else{if(e.status===2){window.location=e.data}}}}catch(f){if(d){d("系统错误，请稍候再试…")}}},onfailure:function(e){if(e.status!=0&&d){d("系统错误，请稍候再试…")}},method:"POST",noCache:true})};baidu.ajax.jsonGet=function(b,c,a,d){baidu.ajax.request(b,{data:baidu.param(c),onsuccess:function(g){var e=null;try{e=baidu.json.decode(g.responseText);if(e.status===0||e.status>2){a(e.data,e.status);if(e.status===0&&/\/a$/i.test(c.method)){baidu.ajax.checkConditionalPageTip(e.msg)}}else{if(e.status===1){if(d){d(e.msg)}}else{if(e.status===2){window.location=e.data}}}}catch(f){if(d){d("系统错误，请稍候再试…")}}},onfailure:function(){if(d){d("系统错误，请稍候再试…")}},method:"GET",noCache:true})};baidu.dateSpan=function(a,b){if(a.getTime()!=b.getTime()&&b!=null){return baidu.date.format(a,"（yyyy-MM-dd")+baidu.date.format(b," ~ yyyy-MM-dd）")}else{return baidu.date.format(a,"（yyyy-MM-dd）")}};var EventRouter={_events:{},_owner:null,register:function(a,b){if(this._events[a]){this._events[a].push(b)}else{this._events[a]=[b]}},dispatch:function(a){var d=[].slice.call(arguments,1);var c=this._events[a];if(c){for(var b=0;b<c.length;b++){c[b].apply(this._owner,d)}}if(this._owner&&T.lang.isFunction(this._owner[a])){this._owner[a].apply(this._owner,d)}},setOwner:function(a){this._owner=a}};(function(){var b={};this.tmpl=function a(e,d){var c=!/\W/.test(e)?b[e]=b[e]||a(document.getElementById(e).innerHTML):new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+e.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');");return d?c(d):c}})();(function(){var a={};getUniqueId=function(c){var d=c||8;var e="";while(d--){e+=b()}if(!a[e]){a[e]=1;return e}else{return getUniqueId(d)}};var b=function(){var d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";var c=d.length;return d.charAt(Math.floor(Math.random()*c))}})();var AceTemplate=AceTemplate||{};(function(){var d={log:function(h){window.console&&console.log(h)}};var f={"#39":"'",quot:'"',lt:"<",gt:">",amp:"&",nbsp:" "};var c={"'":"#39",'"':"quot","<":"lt",">":"gt","&":"amp"," ":"nbsp"};var g={g:function(h){if(typeof h!="string"){return h}return document.getElementById(h)},decodeHTML:function(h){return String(h).replace(/&(#39|quot|lt|gt|amp|nbsp);/ig,function(j,i){return f[i]}).replace(/&#u([a-f\d]{4});/ig,function(i,j){return String.fromCharCode(parseInt("0x"+j))}).replace(/&#(\d+);/ig,function(i,j){return String.fromCharCode(+j)})},encodeAttr:function(h){return String(h).replace(/["']/g,function(i){return"&"+c[i]+";"})},encodeHTML:function(h){return String(h).replace(/['"<>& ]/g,function(i){return"&"+c[i]+";"})},elementText:function(h){if(!h||!h.tagName){return""}if(/^(input|textarea)$/i.test(h.tagName)){return h.value}return g.decodeHTML(h.innerHTML)}};var a={};var e=false;function b(j){var i=[],k=[];i.push("with(this){");i.push(j.replace(/[\r\n]+/g,"\n").replace(/^\n+|\s+$/mg,"").replace(/((^\s*[<>!#^&\u0000-\u0008\u007F-\uffff].*$|^.*[<>]\s*$|^(?!\s*(else|do|try|finally)\s*$)[^'":;,\[\]{}()\n\/]+$|^(\s*(([\w-]+\s*=\s*"[^"]*")|([\w-]+\s*=\s*'[^']*')))+\s*$|^\s*([.#][\w-.]+(:\w+)?(\s*|,))*(?!(else|do|while|try|return)\b)[.#]?[\w-.*]+(:\w+)?\s*\{.*$)\s?)+/mg,function(l){l=['"',l.replace(/&none;/g,"").replace(/["'\\]/g,"\\$&").replace(/\n/g,"\\n").replace(/(!?!?#)\{(.*?)\}/g,function(p,m,o){o=o.replace(/\\n/g,"\n").replace(/\\([\\'"])/g,"$1");var n=/^[a-z$][\w+$]+$/i.test(o)&&!(/^(true|false|NaN|null|this)$/.test(o));return['",',n?["typeof ",o,'=="undefined"?"":'].join(""):"",(m=="#"?"_encode_":m=="!!#"?"_encodeAttr_":""),"(",o,'),"'].join("")}),'"'].join("").replace(/^"",|,""$/g,"");if(l){return["_output_.push(",l,");"].join("")}else{return""}}));i.push("}");var h=new Function("_output_","_encode_","helper","_encodeAttr_",i.join(""));return h}AceTemplate.format=function(m,l,k){if(!m){return""}var h,j;if(typeof m=="object"&&m.tagName){j=m;m=j.getAttribute("id")}k=k||this;h=a[m];if(!h){if(!/[^\w-]/.test(m)){if(!j){j=g.g(m)}h=this.register(m,j)}else{h=b(m)}}var i=[];h.call(l||"",i,g.encodeHTML,k,g.encodeAttr);return i.join("")};AceTemplate.register=function(m,l){if(!arguments.length&&!e){e=true;var h=document.getElementsByTagName("script");for(var k=0;k<h.length;k++){var j=h[k];if(/^(text\/template)$/i.test(j.getAttribute("type"))){var m=j.getAttribute("id");m&&arguments.callee.call(this,m,j)}}}if(!m){return}if(a[m]){return a[m]}if(typeof l!="string"){if(typeof l=="undefined"){l=g.g(m)}l=g.elementText(l)}return a[m]=b(l)};AceTemplate.unregister=function(h){delete a[h]}})();function loadedCallback(a){EventRouter.dispatch("onflashLoaded",a)}function createImageSuccess(a){EventRouter.dispatch("onflashCreateImageSuccess",a)}function hasParent(d,e){var c=arguments;if(typeof e==="string"){var b=T.dom.query(e);var a=false;T.element(e).each(function(f){a=a||c.callee(d,f)});return a}else{if(d===e&&d===document.body){return true}else{do{if(d===e){return true}else{if(d===document.body){return false}}}while(d=d.parentNode)}return false}}T.lang.isUrl=T.lang.isUrl||function(a){return/^((https|http|ftp|rtsp|mms)?:\/\/)?(([\w-]+\.)+[a-z]{2,6}|((25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)\.){3}(25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d))(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/i.test(a)};T.lang.isUrlWithoutPrefix=T.lang.isUrlWithoutPrefix||function(a){return new RegExp("^((https|http|ftp|rtsp|mms)?://)?(([0-9a-z_!~*'().&=+$%-]+: )?[0-9a-z_!~*'().&=+$%-]+@)?(([0-9]{1,3}.){3}[0-9]{1,3}|([0-9a-z_!~*'()-]+.)*([0-9a-z][0-9a-z-]{0,61})?[0-9a-z].[a-z]{2,6})(:[0-9]{1,4})?((/?)|(/[0-9a-z_!~*'().;?:@&=+$,%#-]+)+/?)$","i").test(a)};T.dom.one=function(c,b){if(T.isString(b)){b=T.g(b)}var a=T.dom.query(c,b);if(a.length>0){return a[0]}else{return null}};T.initShowLine=function(f,b){if(!f){return}var d=f.value.replace(/\r/gi,"");var e=d.split("\n").length;if(e>b){T.dom.next(f).innerHTML="您最多可输入"+b+"个";f.pass=false}else{f.pass=true;T.dom.next(f).innerHTML=""}var a="";for(var c=1;c<=e;c++){if(document.all){a+=c+"\r\n"}else{a+=c+"\n"}}T.dom.prev(f).value=a;T.dom.prev(f).scrollTop=f.scrollTop;f.onscroll=function(){T.dom.prev(f).scrollTop=f.scrollTop}};T.getTipElement=function(a){var b=T.dom.create("div",{style:"position: absolute;"});b.className="tip-container";b.innerHTML='<div style="position: relative;top:8px; left:-10px;" class="tip-div tip-theme title-theme"><div class="tip-arrow"></div><div class="tip-wrap">'+a+"</div></div>";return b};T.beforeUnloadAlert=function(){window.onbeforeunload=function(){return'您还没有保存刚才的设置。如需要保存设置，请点击"留在此页"，然后点击当前页面的"确定"'}};T.postBtnBind=function(d,b){var c=T.g(d);var a=function(){setTimeout(function(){T.dom.removeClass(c,"disabled")},1000)};T.on(c,"click",function(f){if(T.dom.hasClass(c,"disabled")){T.event.stop(f)}else{T.dom.addClass(c,"disabled");b(f,a)}})};T.isInputsChanged=(function(){return function(b){var c=false;var g=b;for(var e=0;e<g.length;e++){var d=g[e];var f=d.type;if(f=="text"||f=="hidden"||f=="button"){if(!T.dom.hasAttr(d,"dyna-value")){if(d.value!=d.defaultValue){c=true;break}}else{if(d.value!=T.dom.getAttr(d,"dyna-value")){c=true;break}}}else{if(f=="radio"||f=="checkbox"){if(!T.dom.hasAttr(d,"dyna-checked")){if(d.checked!=d.defaultChecked){c=true;break}}else{var a=T.dom.getAttr(d,"dyna-checked")=="true"?true:false;if(d.checked!=a){c=true;break}}}}}return c}})();T.setDynaValue=function(a){var e=a;for(var c=0;c<e.length;c++){var b=e[c];var d=b.type;if(d=="text"||d=="hidden"||d=="textarea"||d=="button"){T.dom.setAttr(b,"dyna-value",b.value)}else{if(d=="radio"||d=="checkbox"){T.dom.setAttr(b,"dyna-checked",b.checked)}}}};T.resetForm=function(b){var f=b;for(var d=0;d<f.length;d++){var c=f[d];var e=c.type;var a=T.dom.hasAttr(c,"defaultText");if(e=="text"||e=="hidden"||e=="textarea"||e=="button"){if(!a){c.value=c.defaultValue}else{c.value=T.dom.getAttr(c,"defaultText");T.dom.addClass(c,"gray")}}else{if(e=="radio"||e=="checkbox"){c.checked=c.defaultChecked}}}};T.getAncestorOrSelfByClass=function(a,c){var b=T.dom.getAncestorByClass(a,c);if(b){return b}else{if(T.dom.hasClass(a,c)){return a}else{return null}}};T.settingTableHover=function(){T.element(T.q("setting-table")).mouseover(function(c){var b=T.event.getTarget(c);var a=T.getAncestorOrSelfByClass(b,"setting-table-tr");if(a){T.dom.addClass(a,"tr-highlight")}});T.element(T.q("setting-table")).mouseout(function(c){var b=T.event.getTarget(c);var a=T.getAncestorOrSelfByClass(b,"setting-table-tr");if(a){T.dom.removeClass(a,"tr-highlight")}})};T.isIco=function(){return T.config.userInfo.roles.ico};T.isUnion=function(){return T.config.userInfo.roles.webmaster};T.isMultipleSite=function(){return T.config.siteInfo&&T.config.siteInfo.isMultipleSite};T.isCustomer=function(){var a=/.*customer$/i,b;T.object.each(T.config.userInfo.roles,function(d,c){if(a.test(c)&&d){b=true}});return b};T.auth=function(a){return T.config.userInfo.auths[a]};T.lang.isEmail=T.lang.isEmail||(function(a){return/^\w+([-\.]\w+)*@\w+([-\.]\w+)*\.\w+([-\.]\w+)*$/i.test(a)});(function(){var b=null;var a=null;T.on(document.body,"click",function(e){var g=T.event.get(e).target;var f=null;var d=null;do{if(g!=document){if(T.dom.hasClass(g,"layer")){d=g}if(T.dom.hasAttr(g,"layer")){f=g}}}while(g=g.parentNode);var c=function(j,i){if(i){T.dom.addClass(j,"selected")}else{T.dom.removeClass(j,"selected")}T.each(T.q("arrow",j),function(k){if(i){T.dom.addClass(k,"selected")}else{T.dom.removeClass(k,"selected")}})};if(f==null){if(a!=null&&d!=a){T.hide(a);c(b,false);a=null;b=null}}else{var h=T.dom.one(T.dom.getAttr(f,"layer"));if(h!=null){if(a!=null&&h!=a){T.hide(a);c(b,false)}a=null;b=null;if(h.style.display=="none"||T.dom.hasClass(h,"shared-layer")){T.show(h);c(f,true);a=h;b=f}else{T.hide(h);c(f,false)}}}})})();baidu.string.format=function(c,a){c=String(c);var b=Array.prototype.slice.call(arguments,1),d=Object.prototype.toString;if(b.length){b=b.length==1?(a!==null&&(/\[object Array\]|\[object Object\]/.test(d.call(a)))?a:b):b;return c.replace(/(#|!)\{(.+?)(?:\s*,\s*(\d+?))*?\}/g,function(e,h,g,i){var f=b[g];if("[object Function]"==d.call(f)){f=f(g)}if(i){f=T.truncat(f,i)}if(h=="!"){f=T.string.encodeHTML(f)}return("undefined"==typeof f?"":f)})}return c};baidu.format=baidu.string.format;(function(a){a.fn.bgiframe=(a.browser.ie&&/msie 6.0/i.test(navigator.userAgent)?function(e,d){d=a.extend({top:"auto",left:"auto",width:"auto",height:"auto",opacity:true,src:"javascript:false;"},d);var c='<iframe class="bgiframe" frameborder="0" tabindex="-1" src="'+d.src+'"style="display:block;position:absolute;z-index:-1;'+(d.opacity!==false?"filter:Alpha(Opacity='0');":"")+"top:"+(d.top=="auto"?"expression(((parseInt(this.parentNode.currentStyle.borderTopWidth)||0)*-1)+'px')":b(d.top))+";left:"+(d.left=="auto"?"expression(((parseInt(this.parentNode.currentStyle.borderLeftWidth)||0)*-1)+'px')":b(d.left))+";width:"+(d.width=="auto"?"expression(this.parentNode.offsetWidth+'px')":b(d.width))+";height:"+(d.height=="auto"?"expression(this.parentNode.offsetHeight+'px')":b(d.height))+';"/>';return T.array.each(e,function(f){if(T.dom.query("iframe.bgiframe",f).length==0){f.insertBefore(T.dom.create(c),f.firstChild)}})}:function(){return this});a.fn.bgIframe=a.fn.bgiframe;function b(c){return c&&c.constructor===Number?c+"px":c}})(T);T.swf.createClipBoard=function(a){var c={id:"id"+(+new Date()),flashId:"head",flashContainer:"HeadCodeCopyBtn",width:62,height:22,clip:function(d){},success:function(d){},fail:function(d){}},b=T.object.extend(c,a);T.swf.create({id:b.id,width:b.width,height:b.height,ver:"9.0.28",errorMessage:"请下载最新的Flash播放器！",url:T.config.systemConfig.webRoot+"/flash/clipboard.swf",bgcolor:"#000",wmode:"transparent",vars:{flashId:b.flashId}},b.flashContainer);if(!window.onClip){window.onClip=b.clip}if(!window.onFail){window.onFail=b.fail}if(!window.onSuccess){window.onSuccess=b.success}};(function(d){var j=d.page;var i;var c;var e;var l=[];var n="scroll";var g="resize";var m=[n,g];d.page.destoryScrollBind=function(){d.each(m,function(o){d.event.un(window,o,b)})};d.page.scrollBind=function(r,q,p){if(!q){return}if(!i){h()}return d.element(r).each(o);function o(u){var s=d.dom.getPosition(u);var v=s.top;if(!v){var t=d.dom.getAncestorBy(u,function(w){return d.dom.getStyle(w,"visibility")=="visible"});v=d.dom.getPosition(t).top}(v<i)?f(u,q,p):a({top:v,item:u,action:q,opts:p})}};function h(o){if(!o){e=j.getScrollTop();c=j.getViewHeight()}else{if(o.type==g){c=j.getViewHeight()}else{if(o.type==n){e=j.getScrollTop()}}}i=c+e}function f(p,q,o){q.call(p,o)}function a(o){if(!l.length){k()}l.push(o)}function k(){d.each(m,function(o){d.event.on(window,o,b)})}function b(q){h(q);for(var o=l.length-1;o>=0;o--){if(l[o].top<=i){var p=l[o];f(p.item,p.action,p.opts);l.splice(o,1)}}if(!l.length){d.each(m,function(r){d.event.un(window,r,b)})}}})(baidu);function DateController(a){this.dateSelectBar=a.container||"ControlBar";this.prefix=a.prefix||"";this.singleSelection=a.singleSelection||false;this.alwaysCompare=a.alwaysCompare||false;this.calendarCount=a.calendarCount||3;var b=getUniqueId();this.calendarContainerId="calendarContainer"+b;this.maskIframeId="Iframe"+b;this.calendarContainerClass=a.calendarContainerClass||"calendar-box";this.toolTipClass=a.toolTipClass||"date-select-tip";this.btnBarClass=a.toolTipClass||"btn-bar";this.onchange=a.onchange||{};this.compareChange=a.compareChange||{};this.startDate=a.startDate||new Date(1970,1,1);this.endDate=a.endDate||new Date();this.otherStartDate=a.otherStartDate||null;this.otherEndDate=a.otherEndDate||null;this.todayDate=a.todayDate||new Date();this.firstDate=a.firstDate||new Date(1970,1,1);this.dateCompare=false;this.msg="";this.dateSelector=null;this.diff;this.selected={};this.hasManualInputs=a.hasManualInputs!=undefined?a.hasManualInputs:true;this.init()}DateController.prototype={tpl:'<iframe src="about:blank" frameborder="0" scrolling="no" id="#{maskIframeId}"></iframe><div></div><div class="#{toolTipClass}"></div><div class="#{btnBarClass} clearfix"><div class="date-change"><input type="button" value="确定" id="#{prefix}ChangeDate">&nbsp;&nbsp;&nbsp;<input type="button" value="取消" id="#{prefix}CancelChangeDate"></div></div>',init:function(){var a=baidu.G(this.prefix+"DateSelectBar").getElementsByTagName("A");T.event.ons(a,"click",this.selectHandle());this.createCalendarContainer();this.createCalendar();this.initInputDate();this.initShortcutDate();this.bindHandle();this.showDateTip();this.hideDateBoxFn=this.hideDateBoxHandle()},reset:function(a){this.startDate=a.startDate||this.startDate;this.endDate=a.endDate||this.endDate;this.otherStartDate=a.otherStartDate||this.otherStartDate;this.otherEndDate=a.otherEndDate||this.otherEndDate;this.todayDate=a.todayDate||new Date();this.firstDate=a.firstDate||new Date(1970,1,1);this.dateCompare=a.dateCompare||this.dateCompare;T.dom.remove(this.calendarContainerId);this.createCalendarContainer();this.createCalendar();this.initInputDate();this.initShortcutDate();this.bindResetHandle();this.showDateTip();this.hideDateBoxFn=this.hideDateBoxHandle()},bindResetHandle:function(){var b=T.g(this.calendarContainerId);baidu.on(b,"click",function(c){T.event.stopPropagation(c)});var a=T.dom.query(".date-change input",b);T.on(a[0],"click",this.submitDateSelect());T.on(a[1],"click",this.hideDateBoxHandle())},bindHandle:function(){var a=T.g(this.dateSelectBar);var d=T.g(this.calendarContainerId);T.on(this.prefix+"DateSelect","click",this.showDateBox(0));T.g(this.prefix+"CompareDate")&&T.on(this.prefix+"CompareDate","click",this.showDustDateInput());T.g(this.prefix+"CompareDateSelect")&&T.on(this.prefix+"CompareDateSelect","click",this.showDateBox(2));baidu.on(d,"click",function(e){T.event.stopPropagation(e)});var b=T.dom.query(".date-change input",d);T.on(b[0],"click",this.submitDateSelect());T.on(b[1],"click",this.hideDateBoxHandle());var c=this;if(T.g(this.prefix+"Scroll")){T.on(this.prefix+"Scroll","click",function(e){T.dom.toggleClass(this,"open");T.dom.toggleClass(this,"close");if(!T.dom.hasClass(this,"open")){T.removeClass(c.prefix+"ControlBar","date-controll-bar-scroll");T.setStyle(c.prefix+"ControlBar","width","100%")}});T.on(window,"scroll",T.fn.bind(this.dateScrollHandler,this));T.on(window,"resize",T.fn.bind(this.dateScrollHandler,this))}},dateScrollHandler:function(){var b=T.dom.getPosition(this.prefix+"ControlBarWrapper");var a=T.g(this.prefix+"Scroll");if(a&&!T.dom.hasClass(a,"open")){return}var d=document.documentElement.scrollTop+document.body.scrollTop,e=document.documentElement.scrollLeft+document.body.scrollLeft;var c=T.g(this.prefix+"ControlBar");if(d>b.top){T.addClass(c,"date-controll-bar-scroll");T.setStyles(c,{top:d-b.top,width:T.q("main")[0].offsetWidth+"px"})}else{T.removeClass(c,"date-controll-bar-scroll");T.setStyle(c,"width","100%")}this.hideDateBoxHandle().call(this)},showDustDateInput:function(){var a=this;return function(b){T.event.stopPropagation(b);if(this.checked){a.showInput();a.showDateBox(2).call(this,b)}else{a.hideInput();a.otherStartDate=null;a.otherEndDate=null;a.msg="";a.initInputDate();a.onchange(this.id)}}},submitDateSelect:function(){var a=this;return function(){var c=a.selected.from;var b=a.selected.to;if(a.dateCompare){a.otherStartDate=c;a.otherEndDate=b}else{a.startDate=c;a.endDate=b}a.currentSubmit=true;a.showDateTip();a.initShortcutDate();a.hideDateBoxFn();a.onchange("submitDateSelect")}},hideDateBoxHandle:function(){var a=this;return function(){baidu.un(document,"click",a.hideDateBoxFn);baidu.hide(a.calendarContainerId);a.initInputDate();var b=T.dom.query("#CustomDateSelect input");T.element(b).each(function(c){T.dom.removeClass(c,"drop")})}},showDateBox:function(a){var b=this;return function(l){var j=T.dom.query(".date-select-tip",T.g(b.calendarContainerId));j[0]&&(j[0].innerHTML="");var m=T.event.getTarget(l);if(m&&m.id&&m.id==this.prefix+"CompareDate"){m=T.g(this.prefix+"CompareDateSelect")}T.dom.addClass(m,"drop");T.event.stop(l);b.msg="";b.currentIndex=a;var t=baidu.date.format;var i=baidu.date.parse;var c=T.g(b.calendarContainerId);var u=baidu.dom.getPosition;b.dateCompare=(a==2)?true:false;b.diff=(a==2)?b.dateDiff(b.startDate,b.endDate):0;c.style.display="block";b.dateSelector.clickState="from";var s=(a==2)?b.otherStartDate:b.startDate;var r=(a==2)?b.otherEndDate:b.endDate;b.selected.from=s;b.selected.to=r;if(s){s=new Date(t(s,"yyyy/MM/dd")).getTime();r=new Date(t(r,"yyyy/MM/dd")).getTime();b.dateSelector.setSelected({from:s,to:r});b.hasManualInputs&&b.dateSelector.syncManualInputBoxes(s,r)}else{b.dateSelector.setSelected({});b.hasManualInputs&&b.dateSelector.syncManualInputBoxes()}var n=this;var g=(a==2&&b.calendarCount==3)?-150:0;var f=20;var p=u(n).left+g;var o=u(n).top+f;c.style.top=o+"px";c.style.left=p+"px";baidu.on(document,"click",b.hideDateBoxFn);if(baidu.ie==6){var d=T.g(b.maskIframeId);d.style.display="block";var k=c.offsetHeight;var q=c.offsetWidth;d.style.height=(k-5)+"px";d.style.width=q+"px"}}},initInputDate:function(){var c=baidu.G(this.dateSelectBar);var h=c.getElementsByTagName("INPUT");var a=T.g(this.prefix+"DateSelect");var j=baidu.date.format;var k=j(this.startDate,"yyyy/MM/dd");var i=j(this.endDate,"yyyy/MM/dd");var d=(k==i)?i:k+" - "+i;a.value=d;if(this.otherStartDate&&this.otherStartDate.constructor==Date){var g=Math.abs(this.dateDiff(this.startDate,this.endDate));var f=Math.abs(this.dateDiff(this.otherStartDate,this.otherEndDate));if(f!=g){this.otherEndDate=new Date(this.otherStartDate.getTime()+g*3600*24*1000)}this.showInput();var e=j(this.otherStartDate,"yyyy/MM/dd");var b=j(this.otherEndDate,"yyyy/MM/dd");T.g(this.prefix+"CompareDateSelect")&&(T.g(this.prefix+"CompareDateSelect").value=(e==b)?b:e+" - "+b)}else{this.hideInput()}this.showDateTip()},initShortcutDate:function(){var a=baidu.G(this.dateSelectBar);var o=a.getElementsByTagName("A");var d=o.length;var g=this.endDate;var b=this.startDate;var p=this.todayDate;var c=new Date(+T.config.systemConfig.now);this.removeClass();var m=this.dateDiff;var k=m(g,p);var e=m(b,g);var f=e;var f=Number.MAX_VALUE;if(k==-1&&e==0){f=-1}if(k==0&&e!=-1){f=e}for(var h=0,d=o.length;h<d;h++){var l=o[h].href.indexOf("#");if(l!=-1){var j=parseInt(o[h].href.substr(l+1));if(j==f){T.dom.addClass(o[h],"cur");break}}}},showInput:function(){if(T.g(this.prefix+"CompareDateSelect")&&this.alwaysCompare){if(this.currentIndex==2&&this.currentSubmit){var a=baidu.G(this.dateSelectBar);var b=a.getElementsByTagName("INPUT");T.g(this.prefix+"CompareDate")&&(T.g(this.prefix+"CompareDate").checked=true);T.g(this.prefix+"CompareDateSelect")&&(T.g(this.prefix+"CompareDateSelect").style.display="");T.g(this.prefix+"CompareDateSelect")&&T.dom.addClass(T.g(this.prefix+"CompareDateSelect"),"cur")}}else{var a=baidu.G(this.dateSelectBar);var b=a.getElementsByTagName("INPUT");T.g(this.prefix+"CompareDate")&&(T.g(this.prefix+"CompareDate").checked=true);T.g(this.prefix+"CompareDateSelect")&&(T.g(this.prefix+"CompareDateSelect").style.display="");T.g(this.prefix+"CompareDateSelect")&&T.dom.addClass(T.g(this.prefix+"CompareDateSelect"),"cur")}this.currentIndex=null;this.currentSubmit=null},hideInput:function(){var a=baidu.G(this.dateSelectBar);var b=a.getElementsByTagName("INPUT");T.g(this.prefix+"CompareDate")&&(T.g(this.prefix+"CompareDate").checked=false);T.g(this.prefix+"CompareDateSelect")&&T.dom.removeClass(T.g(this.prefix+"CompareDateSelect"),"cur");T.g(this.prefix+"CompareDateSelect")&&(T.g(this.prefix+"CompareDateSelect").value="与其他时间段对比")},disableInput:function(){var a=baidu.G(this.dateSelectBar);var b=a.getElementsByTagName("INPUT");T.g(this.prefix+"CompareDate").checked=false;T.g(this.prefix+"CompareDate").style.display="none";T.dom.removeClass(T.g(this.prefix+"CompareDateSelect"),"cur");T.g(this.prefix+"CompareDateSelect").style.display="none"},enableInput:function(){var a=baidu.G(this.dateSelectBar);var b=a.getElementsByTagName("INPUT");T.g(this.prefix+"CompareDate").style.display="inline";T.g(this.prefix+"CompareDateSelect").style.display="inline"},createCalendar:function(){var c=baidu.G(this.calendarContainerId);var b=c.getElementsByTagName("DIV");var e=b[1];var j=b[2];var h=this.todayDate;var d=this.firstDate;var f=this.todayDate.getTime();var a=3600*24*1000;var i=baidu.date.format;var g=this;this.dateSelector=new DateSelector({calendarCount:this.calendarCount,singleSelection:this.singleSelection,autoFill:0,onviewchange:function(l){var k=new Date(f+a*31);k.setDate(1);if(l.to-k>0){return false}},dateStyle:function(k){if(g.dateCompare){var l=g.diff?Math.abs(Math.floor(g.diff))+1:1;if(this.clickState=="to"&&Math.abs(this.selected.from-k)<a*l){return"background:#fbeaa7"}}if(k-h>0||k-d<0){return"color:#999;cursor:default;background:#fff"}if(i(k,"yyyy/MM/dd")==i(h,"yyyy/MM/dd")){return"font-weight:bold; border:1px solid #a7aebc"}},sideButtonClass:function(k){var l=h;if(k.type=="nextmonth"&&k.to>=new Date(l.getFullYear(),l.getMonth(),1)){return"ds-nextmonth-ed"}}});this.dateSelector.viewDate=new Date(f-a*1);this.dateSelector.onselect=function(k,m){if(m){e.style.display="block";e.innerHTML=m;return false}var o=k.from;var n=k.to;if(h-n<0){e.style.display="block";e.innerHTML="您所选日期内暂无数据，请重新选择。";return false}if((n-h)>0||(o-d)<0){e.style.display="block";e.innerHTML="您所选日期内暂无数据，请重新选择。";return false}if((n-d)<0||(o-d)<0){return false}var l=(n-o)/a;if(l>366){e.style.display="block";e.innerHTML="非常抱歉，时间范围查询不能超出366天!";return false}e.innerHTML="";g.selected=k;g.onSelect()};T.dom.empty(b[0]);this.dateSelector.appendTo(b[0]);this.hasManualInputs&&this.dateSelector.renderManualInputBoxes(j)},onSelect:function(){var a=baidu.G(this.dateSelectBar);var c=a.getElementsByTagName("INPUT");var f=baidu.date.format;var d=this.selected;var g=this.dateCompare?T.g(this.prefix+"CompareDateSelect"):T.g(this.prefix+"DateSelect");var e=f(d.from,"yyyy/MM/dd");var b=f(d.to,"yyyy/MM/dd");g.value=(e==b)?b:e+" - "+b;T.dom.addClass(g,"cur");if(!T.g(this.prefix+"CompareDateSelect")){T.dom.addClass(this.prefix+"DateSelect","mt")}this.hasManualInputs&&this.dateSelector.syncManualInputBoxes(e,b)},createCalendarContainer:function(){var a=document.createElement("DIV");a.id=this.calendarContainerId;a.className=this.calendarContainerClass;a.innerHTML=baidu.format(this.tpl,{maskIframeId:this.maskIframeId,toolTipClass:this.toolTipClass,btnBarClass:this.btnBarClass,prefix:this.prefix});document.body.appendChild(a)},selectHandle:function(){var a=this;return function(g){T.event.preventDefault(g);a.msg="";var h=this.href.lastIndexOf("#")+1;var d=parseInt(this.href.substring(h),10);if(d!=0){var b=(b==-1)?-1:d;a.startDate=new Date(a.recentDate(b));var f=(d==-1)?d:0;a.endDate=new Date(a.recentDate(f))}else{var c=a.todayDate;a.startDate=c;a.endDate=c}if(!a.alwaysCompare){a.otherStartDate=null;a.otherEndDate=null;if(T.g(a.prefix+"CompareDateSelect")){T.removeClass(a.prefix+"CompareDateSelect","cur")}}a.initInputDate();a.removeClass();T.dom.addClass(this,"cur");T.removeClass(a.prefix+"DateSelect","cur");T.dom.removeClass(a.prefix+"DateSelect","mt");a.showDateTip();a.onchange()}},removeClass:function(){var b=baidu.G(this.dateSelectBar).getElementsByTagName("A");for(var a=0,c=b.length;a<c;a++){T.removeClass(b[a],"cur")}},dateDiff:function(b,a){b.setHours(0);b.setMinutes(0);b.setSeconds(0);b.setMilliseconds(0);a.setHours(0);a.setMinutes(0);a.setSeconds(0);a.setMilliseconds(0);return parseInt((b-a)/1000/60/60/24,10)},recentDate:function(a){return this.todayDate.getTime()+a*3600*24*1000},showDateTip:function(){var e=baidu.G("Date");var h=baidu.date.format;var f=baidu.dom.next;var c=this.otherStartDate&&this.otherStartDate.constructor==Date?true:false;var b=h(this.startDate,"yyyy/MM/dd");var g=h(this.endDate,"yyyy/MM/dd");var d=(b==g)?b:(b+"~"+g);if(c){var a=h(this.otherStartDate,"yyyy/MM/dd");var i=h(this.otherEndDate,"yyyy/MM/dd");var j=(a==i)?a:(a+"~"+i);if(e){e.innerHTML="("+d+"与"+j+")"}}else{if(e){e.innerHTML="("+d+")"}}T.dom.one(".report-help")&&(T.dom.setStyle(T.dom.one(".tip-arrow"),"left",(T.dom.one(".report-help").offsetLeft+2)+"px"))},setDate:function(a,b){this.startDate=a;this.endDate=b;this.initInputDate();this.onchange("submitDateSelect");this.initShortcutDate()},setCompareDate:function(a,b){this.showInput();this.otherStartDate=new Date(a);this.otherEndDate=new Date(b);this.initInputDate()},hideCompareDate:function(){this.hideInput();this.otherStartDate=null;this.otherEndDate=null},disableCompareDate:function(){this.disableInput();this.otherStartDate=null;this.otherEndDate=null},enableCompareDate:function(){this.enableInput()}};function DateSelector(b){this.uniqueId=getUniqueId();b=b||{};this.onselect=b.onselect||new Function();this.singleSelection=b.singleSelection||false;this.onviewchange=b.onviewchange;this.autoFill=b.autoFill;if("undefined"==typeof this.autoFill||this.autoFill===null){this.autoFill=true}this.dateStyle=b.dateStyle||"";this.weekStyle=b.weekStyle||"";this.sideButtonStyle=b.sideButtonStyle;this.sideButtonClass=b.sideButtonClass;this.calendarCount=b.calendarCount||2;this.selected=b.selected||null;var a=this.selected?this.selected.to:(new Date());this.viewDate=new Date(a.getFullYear(),a.getMonth(),1);this.clickState="from";this.calWrapIdPrefix=this.uniqueId+"DSCalendarWrap";this.wrapClass="ds-wrap";this.prevClass="ds-prev";this.nextClass="ds-next";this.prevYearClass="ds-prevyear";this.prevMonthClass="ds-prevmonth";this.prevMonthActiveClass="ds-prevmonth-active";this.nextYearClass="ds-nextyear";this.nextMonthClass="ds-nextmonth";this.nextMonthActiveClass="ds-nextmonth-active";this.prevYearId="DSPrevYear";this.prevMonthId="DSPrevMonth";this.nextYearId="DSNextYear";this.nextMonthId="DSNextMonth";this.calWrapClass="ds-cal-wrap";this.calBlankClass="ds-cal-blank";this.calHeadClass="ds-cal-head";this.calHeadSelClass="ds-cal-head-selected";this.dateClass="ds-date-thismonth";this.dateSelectedClass="ds-date-selected";this.dateOtherClass="ds-date-othermonth";this.weekClass="ds-week"}DateSelector.getDateCountByMonth=function(a){var b=new Date(a.getFullYear(),a.getMonth()+1,0);return b.getDate()};DateSelector.prototype={setSelected:function(a){this.selected=(a&&a.from&&a.to)?a:{};this.renderCalendars();this.clickState="from";return this},getSelected:function(){return this.selected},appendTo:function(c){var d=document.createElement("table");var a=document.createElement("tbody");var e=document.createElement("tr");d.className=this.wrapClass;a.appendChild(e);d.appendChild(a);c.appendChild(d);d.onclick=this.getClickHandler();T.event.on(d,"mousedown",this.getMouseDownHandler());T.event.on(d,"mouseup",this.getMouseUpHandler());this.renderSide("prev",e);for(var b=0;b<this.calendarCount;b++){var f=document.createElement("td");f.vAlign="top";f.id=this.calWrapIdPrefix+b;f.className=this.calWrapClass;if(b==this.calendarCount-1){f.className=this.calWrapClass+" ds-cal-wrap-last"}e.appendChild(f);if(b<this.calendarCount-1){f=document.createElement("td");f.className=this.calBlankClass;e.appendChild(f)}}this.renderSide("next",e);this.renderCalendars();this.appendTo=new Function()},renderSide:function(l,k){var a='<div class="#{yearclass}" id="#{yearId}" sign="#{type}year" style="#{yearstyle}"></div><div class="#{monthclass}" id="#{monthId}" sign="#{type}month" style="#{monthstyle}"></div>';var p=["year","month"],b=["class","style"];var q={styleFn:this.sideButtonStyle||new Function(),classFn:this.sideButtonClass||new Function()};var h={from:new Date(this.viewDate.getFullYear(),this.viewDate.getMonth()-this.calendarCount+1,1),to:this.viewDate};var f={monthstyle:this[l+"MonthStyle"],yearstyle:this[l+"YearStyle"],monthclass:this[l+"MonthClass"],yearclass:this[l+"YearClass"],yearId:this[l+"YearId"],monthId:this[l+"MonthId"]};var o,d,n;for(var g=0;g<p.length;g++){o=p[g];for(var e=0;e<b.length;e++){n=q[b[e]+"Fn"];switch(typeof n){case"function":h.type=l+o;d=n(h);if(d){f[o+b[e]]=d}break;case"string":f[o+b[e]]=n;break}}}var m=this.uniqueId+l+"Side";var c=baidu.G(m);if(!c){if(!k){return}c=document.createElement("td");c.id=m;l=l.toLowerCase();c.vAlign="top";c.className=this[l+"Class"];k.appendChild(c)}c.innerHTML=baidu.format(a,{type:l,yearclass:f.yearclass,monthclass:f.monthclass,yearstyle:f.yearstyle,monthstyle:f.monthstyle,yearId:f.yearId,monthId:f.monthId})},renderCalendars:function(){for(var b=0;b<this.calendarCount;b++){var a=new Date(this.viewDate.getFullYear(),this.viewDate.getMonth()-this.calendarCount+1+b,1);baidu.G(this.calWrapIdPrefix+b).innerHTML=this.getCalendarHtml(a.getFullYear(),a.getMonth())}},getCalendarHtml:function(h,g){var e='<div id="Calendar#{year}#{month}" class="#{clazz}" sign="month" y="#{year}" m="#{month}">#{year}年#{nextmonth}月</div>';var c='<td sign="date" style="#{4}" class="#{3}" y="#{2}" m="#{1}" d="#{0}">#{0}</td>';var i='<table cellpadding="0" cellspacing="0" border="0" class="#{className}"><thead>#{thead}</thead><tbody>#{tbody}</tbody></table>';var d=[];var f=this.calHeadClass;var b=new Date(h,g,1);var a=new Date(b);a.setMonth(a.getMonth()+1);a.setDate(0);if(this.selected&&b-this.selected.from>=0&&a-this.selected.to<=0){f=this.calHeadSelClass}d.push(baidu.format(e,{clazz:f,year:h,month:g,nextmonth:(g+1)}),baidu.format(i,{thead:this.getCalHeadHtml(),className:this.singleSelection?"single":"",tbody:this.getCalBodyHtml(h,g)}));return d.join("")},getCalHeadHtml:function(){var d=["日","一","二","三","四","五","六"];var c=[baidu.format('<tr><td style="background:#fff;" class="#{0}"></td>',this.weekClass)];var a="<td>#{0}</td>";for(var b=0;b<7;b++){c.push(baidu.format(a,d[b]))}c.push("</tr>");return c.join("")},getCalBodyHtml:function(h,t){var r='<td sign="#{3}" style="#{5}" class="#{4}" y="#{2}" m="#{1}" d="#{0}">#{6}</td>';var n='<td class="#{0}" sign="week" style="#{1}"></td>';var g=[];function j(){var i=Array.apply(i,arguments);i.unshift(r);g.push(baidu.format.apply(null,i))}var l=new Date(h,t,1);var w=new Date(h,(t-1),1);var k=DateSelector.getDateCountByMonth(w);var c=DateSelector.getDateCountByMonth(l);var d=0-new Date(h,t,1).getDay();var e,f,u,v,a,b;if(this.dateStyle.constructor==String){a=this.dateStyle}if("function"==typeof this.weekStyle){b=this.weekStyle(new Date(w.getFullYear(),w.getMonth(),k+d+1))||""}g.push("<tr>",baidu.format(n,this.weekClass,b));for(var s=0;d<c;d++,s++){var q="date";if(s>0&&s%7===0){if("function"==typeof this.weekStyle){b=this.weekStyle(new Date(h,t,d+1))||""}g.push("</tr><tr>",baidu.format(n,this.weekClass,b))}if(d<0){e=k+d+1;f=w.getMonth();u=w.getFullYear();v=this.dateOtherClass;if(!this.autoFill){q=""}}else{e=d+1;f=t;u=h;v=this.dateClass;if(this.selected){var m=new Date(u,f,e);if(m-this.selected.from>=0&&m-this.selected.to<=0){v=this.dateSelectedClass}}}if("function"==typeof this.dateStyle&&q){a=this.dateStyle(new Date(u,f,e))||""}j(e,f,u,q,v,(v==this.dateSelectedClass?"":a),(q?e:""))}f=t+1;u=h;if(f>11){f=0;u++}v=this.dateOtherClass;a="";for(var o=s%7,p=o;o>0&&o<7;o++){if(this.autoFill){q="date";e=o-p+1;if("function"==typeof this.dateStyle){a=this.dateStyle(new Date(u,f,e))||""}}else{e="&nbsp;";q=""}j(e,f,u,q,v,a,e)}g.push("</tr>");return g.join("")},getMouseUpHandler:function(){var a=this;return function(d){d=d||window.event;var c=d.srcElement||d.target,b=c.getAttribute("sign");b=="prevmonth"&&T.dom.removeClass(c,a.prevMonthActiveClass);b=="nextmonth"&&T.dom.removeClass(c,a.nextMonthActiveClass)}},getMouseDownHandler:function(){var a=this;return function(d){d=d||window.event;var c=d.srcElement||d.target,b=c.getAttribute("sign");b=="prevmonth"&&T.dom.addClass(c,a.prevMonthActiveClass);b=="nextmonth"&&T.dom.addClass(c,a.nextMonthActiveClass)}},getClickHandler:function(){var a=this;return function(k){k=k||window.event;var j=k.srcElement||k.target;var c=j.getAttribute("sign");var m=new Date(a.viewDate);var f,n,l,i;switch(c){case"prevmonth":m.setMonth(a.viewDate.getMonth()-1);break;case"prevyear":m.setFullYear(a.viewDate.getFullYear()-1);break;case"nextmonth":m.setMonth(a.viewDate.getMonth()+1);break;case"nextyear":m.setFullYear(a.viewDate.getFullYear()+1);break;case"date":var b=new Date(j.getAttribute("y"),j.getAttribute("m"),j.getAttribute("d"));if(a.clickState=="from"){f={from:b,to:b}}else{f={from:a.selected.from,to:b};if(f.to-f.from<0){var g=f.to;f.to=f.from;f.from=g}}break;case"week":if(a.singleSelection){return}var d=j.nextSibling;l=new Date(d.getAttribute("y"),d.getAttribute("m"),d.getAttribute("d"));i=new Date(l);i.setDate(i.getDate()+6);f={from:l,to:i};break;case"month":if(a.singleSelection){return}l=new Date(j.getAttribute("y"),j.getAttribute("m"),1);i=new Date(l);i.setMonth(i.getMonth()+1);i.setDate(0);f={from:l,to:i};break;default:return}switch(c){case"prevmonth":case"prevyear":case"nextmonth":case"nextyear":if(a.onviewchange){var h=new Date(m);h.setMonth(h.getMonth()-a.calendarCount+1);n=a.onviewchange.call(a,{from:h,to:m});if(n===false){return}}a.viewDate=m;a.renderSide("prev");a.renderSide("next");break;case"date":case"week":case"month":n=a.onselect.call(a,f);if(n===false){return}a.selected=f;a.clickState=(c=="date"&&a.clickState=="from")?"to":"from";if(a.singleSelection){a.clickState="from"}break}a.renderCalendars()}},renderManualInputBoxes:function(d){var b='<div class="date-range">                    <span>日期区间</span>                    <input type="text" value="" placeholder="起始日期" id="#{0}DateStart" class="date-start" maxlength="10" style="IME-MODE: disabled" />                    <span> - </span>                    <input type="text" value="" placeholder="终止日期" id="#{0}DateEnd" class="date-end" maxlength="10" style="IME-MODE: disabled" />                    </div>';T.dom.insertHTML(d,"afterBegin",T.format(b,this.uniqueId));var a=T.dom.query("#"+this.uniqueId+"DateStart, #"+this.uniqueId+"DateEnd"),c=this;T.event.ons(a,"keyup",function(j){var i=T.event.getKeyCode(j);if(i==8||i==9||i==17||i==16||i==229||i==35||i==36||i==37||i==38||i==39||i==40){return}this.value=this.value.replace(/[^0-9|[^\/]/g,"");var k=T.string.trim(T.g(c.uniqueId+"DateStart").value),g=T.string.trim(T.g(c.uniqueId+"DateEnd").value),f=new Date(k),h=new Date(g);if(this.value.length==10){c.validateDateInputs();c.setSelected(c.selected)}});T.event.ons(a,"blur",function(f){c.validateDateInputs()})},validateDateInputs:function(){var h=T.dom.query("#"+this.uniqueId+"DateStart, #"+this.uniqueId+"DateEnd"),f=T.dom.query(".date-change input",T.dom.getParent(T.dom.getParent(h[0]))),e=/^[\d]{4,4}[/]([0][1-9]|[1][0-2])[/]([0][1-9]|[1-2][\d]|[3][0-1])$/;var a=T.string.trim(T.g(this.uniqueId+"DateStart").value),c=T.string.trim(T.g(this.uniqueId+"DateEnd").value),b=new Date(a),g=new Date(c);if(!e.test(a)){T.dom.addClass(h[0],"date-invalid");f[0].disabled=true;this.onselect.call(this,d,"开始日期输入有误，日期格式yyyy/MM/dd。")}else{if(!e.test(c)){T.dom.addClass(h[1],"date-invalid");f[0].disabled=true;this.onselect.call(this,d,"结束日期输入有误，日期格式yyyy/MM/dd。")}else{if(a!=""&&c!=""&&g<b){T.dom.addClass(h[1],"date-invalid");f[0].disabled=true;this.onselect.call(this,d,"结束日期不能小于开始日期！")}else{T.dom.removeClass(h[0],"date-invalid");T.dom.removeClass(h[1],"date-invalid");f[0].disabled=false;var d={from:b,to:g},i=this.onselect.call(this,d);if(i===false){return}this.selected=d}}}},syncManualInputBoxes:function(d,b){d&&(d=T.date.format(new Date(d),"yyyy/MM/dd"));b&&(b=T.date.format(new Date(b),"yyyy/MM/dd"));d=d||"";b=b||"";T.g(this.uniqueId+"DateStart").value=d;T.g(this.uniqueId+"DateEnd").value=b;var a=T.dom.query("#"+this.uniqueId+"DateStart, #"+this.uniqueId+"DateEnd"),c=T.dom.query(".date-change input",T.dom.getParent(T.dom.getParent(a[0])));T.dom.removeClass(a[0],"date-invalid");T.dom.removeClass(a[1],"date-invalid");c[0].disabled=false}};T.ui.Dialog=T.createUI({options:{id:"",titleText:"默认标题",content:"默认内容",position:{left:360,top:100},isSingle:false,isModal:false,hasClose:true,className:"dialog",zIndex:99999},_type:"dialog",_init:function(){var a=this;a.options.id=a.id=a.getId();a.render()},_getInnerString:function(){var b=document;var a=this;var c=['<div class="dialog-title">'];c.push('<div class="dialog-title-text">');c.push(a.options.titleText);c.push("</div>");if(this.options.hasClose){c.push('<a href="javascript:void(0);" class="dialog-close">×');c.push("</a>")}c.push("</div>");c.push('<div class="dialog-content">');c.push(a._getContentHTML());c.push("</div>");return c.join("")},_update:function(){var e=this;var a=e.getContainer();if(a){var f="#"+e.id+" .dialog-title-text";var d=T.dom.query(f)[0];if(d){d.innerHTML=e.options.titleText}var c="#"+e.id+" .dialog-content";var b=T.dom.query(c)[0];if(b){b.innerHTML=e._getContentHTML()}T.dom.setPosition(a,e.options.position)}else{return}},_setIFrame:function(d,c,a){var b='<iframe class="bgiframe"frameborder="0"tabindex="-1"src="javascript:false;"style="display:block;position:absolute;z-index:-1;filter:Alpha(Opacity=\'0\');top:'+(0)+"px;left:"+(0)+"px;width:"+(c)+"px;height:"+(a)+'px;"/>';if(T.q("bgiframe",d).length===0){T.dom.insertHTML(d,"beforeBegin",b)}},_getContentHTML:function(){var b=this;var c=document;if(T.lang.isString(b.options.content)){return b.options.content}else{if(T.lang.isElement(b.options.content)){T.show(b.options.content);var a=c.createElement("div");a.appendChild(b.options.content);return a.innerHTML}else{return""}}},setTitleText:function(b){var a=this;if(T.lang.isString(b)){a.options.titleText=b}a._update()},setContent:function(c){var b=this;var a=c;if(T.lang.isString(a)||T.lang.isElement(a)){b.options.content=a}b._update()},render:function(){var h=document;var e=this;var a=h.createElement("div");a.id=e.id;a.className="dialog-container "+e.options.className;var d="";if(e.options.isModal){var c=e.options.zIndex-1;var g=h.createElement("div");g.className=e.options.className+" modal";g.id=e.id+"modal";T.dom.setStyles(g,{position:"absolute",top:0,left:0,"background-color":"black",width:T.page.getWidth(),height:T.page.getHeight(),opacity:0.6,"z-index":c});h.body.appendChild(g);if(T.browser.ie&&(T.browser.ie<7)){var b=h.createElement("div");g.appendChild(b);e._setIFrame(g.firstChild,T.page.getWidth(),T.page.getHeight())}T.un(window,"resize",e._modalResizeHandler);T.on(window,"resize",e._modalResizeHandler)}a.innerHTML=e._getInnerString();h.body.appendChild(a);if(T.browser.ie&&(T.browser.ie<7)){e._setIFrame(a.firstChild,a.offsetWidth,a.offsetHeight)}T.dom.setStyles(e.getContainer(),{position:"absolute","z-index":e.options.zIndex});if(e.options.width){T.dom.setStyle(e.getContainer(),"width",e.options.width);e.options.position.left=T.page.getScrollLeft()+(T.page.getViewWidth()-e.options.width)/2;e.options.position.top=Math.max(T.page.getScrollTop()+(T.page.getViewHeight()-e.getContainer().offsetHeight)/2,0)}T.dom.setPosition(e.getContainer(),{left:e.options.position.left,top:e.options.position.top});if(this.options.hasClose){var f="#"+e.id+" .dialog-close";T.dom.query(f)[0].onclick=function(){e.close()}}e.hide()},getContainer:function(){return T.g(this.id)},setPosition:function(a){var b=this;b.options.position.left=a.left;b.options.position.top=a.top;b._update()},show:function(){var a=this;T.dom.show(a.getContainer());if(a.options.width){T.dom.setStyle(a.getContainer(),"width",a.options.width);a.options.position.left=T.page.getScrollLeft()+(T.page.getViewWidth()-a.options.width)/2;a.options.position.top=Math.max(T.page.getScrollTop()+(T.page.getViewHeight()-a.getContainer().offsetHeight)/2,0)}T.dom.setPosition(a.getContainer(),{left:a.options.position.left,top:a.options.position.top});if(a.getModalContainer()){T.dom.show(a.getModalContainer())}},hide:function(){var a=this;T.dom.hide(a.getContainer());if(a.getModalContainer()){T.dom.hide(a.getModalContainer())}},close:function(){if(!this.options.isSingle){if(this.getContainer()){T.dom.remove(this.getContainer())}if(this.getModalContainer()){T.dom.remove(this.getModalContainer())}T.un(window,"resize",this._modalResizeHandler)}else{this.hide()}this.dispatchEvent("onclose")},getModalContainer:function(){return T.g(this.id+"modal")},_modalResizeHandler:function(){var b=T.q("modal");for(var a=0;a<b.length;a++){T.dom.setStyles(b[a],{width:T.page.getWidth(),height:T.page.getHeight()})}}});T.ui.Dialog.close=function(){T.element(".dialog-container, .modal").each(function(a){T.dom.remove(a)})};T.ui.Paging=T.createUI({options:{containerId:null,onchange:function(a){},offset:0,pageSize:20,pageSizeRange:[20,50,100],pageSizeSelectText:"每页显示：",fuzzy:false,withoutGoto:false,round:2,previousTemplate:'<a href="javascript:void(0);" class="previous" data="#{0}">&lt;上一页</a>',pageNumberTemplate:'<a class="number#{0}" href="javascript:void(0);" data="#{1}">#{1}</a>',moreTemplate:"...",nextTemplate:'<a href="javascript:void(0);" class="next" data="#{0}">下一页&gt;</a>',pagingWrapperTemplate:'<div class="paging clearfix">#{0}</div>',pageNumberWrapperTemplate:'<div class="page-number">#{0}#{1}</div>',gotoTemplate:'第<input class="text" type="text"/>页 <a href="javascript:void(0)" class="button"><span>确定</span></a>',pageSizeWrapperTemplate:'<div class="page-size">#{0}#{1}</div>',pageSizeSelectTemplate:"<select>#{0}</select>",pageSizeOptionTemplate:'<option value="#{0}"#{1}>#{0}</option>'},_type:"paging",_total:0,_offset:0,_pageSize:0,_fuzzy:false,_pageCount:0,_currentPage:0,_init:function(){this._offset=this.options.offset;this._pageSize=this.options.pageSize;this._fuzzy=this.options.fuzzy},_computeParams:function(){this._pageCount=Math.ceil(this._total/this._pageSize);if(this._pageCount==0){this._pageCount=1}this._currentPage=this._offset/this._pageSize+1},_computePageRange:function(b,c,a){var e=c-a;var d=c+a;if(e<1){e=1;d=Math.min(2*a+1,b)}if(d>b){d=b;e=Math.max(b-2*a,1)}return{from:e,to:d}},_renderPageSize:function(){if(!T.lang.isArray(this.options.pageSizeRange)||this.options.pageSizeRange.length==0){return""}if(this._total<=this.options.pageSizeRange[0]){return""}var c="";for(var b in this.options.pageSizeRange){var a=this.options.pageSizeRange[b];c+=T.format(this.options.pageSizeOptionTemplate,a,a==this._pageSize?' selected="selected"':"")}return T.format(this.options.pageSizeWrapperTemplate,this.options.pageSizeSelectText,T.format(this.options.pageSizeSelectTemplate,c))},_renderPaging:function(){if(this._pageCount<=1){return""}var c="";if(this._currentPage>1){c+=T.format(this.options.previousTemplate,this._currentPage-1)}var b=this._computePageRange(this._pageCount,this._currentPage,this.options.round);if(!this._fuzzy){if(b.from>1){c+=T.format(this.options.pageNumberTemplate,"",1)+this.options.moreTemplate}for(var a=b.from;a<=b.to;a++){c+=T.format(this.options.pageNumberTemplate,this._currentPage==a?" selected":"",a)}if(b.to<this._pageCount){c+=this.options.moreTemplate+T.format(this.options.pageNumberTemplate,"",this._pageCount)}}if(this._currentPage<this._pageCount){c+=T.format(this.options.nextTemplate,this._currentPage+1)}return T.format(this.options.pageNumberWrapperTemplate,c,this._fuzzy||this.options.withoutGoto?"":this.options.gotoTemplate)},_changePage:function(c){var d=T.event.get(c).target;var b=T.getAttr(d,"data");if(b==null){return}var a=parseInt(b,10);var e=(a-1)*this._pageSize;this._offset=e;this._currentPage=a;this.options.onchange({offset:this._offset,currentPage:this._currentPage,pageSize:this._pageSize,paging:this})},_gotoPage:function(b){var c=T.q("text",this.options.containerId)[0];var a=parseInt(T.trim(c.value),10);if(isNaN(a)||a>this._pageCount||a==this._currentPage||a<1){return}var d=(a-1)*this._pageSize;this._offset=d;this._currentPage=a;this.options.onchange({offset:this._offset,currentPage:this._currentPage,pageSize:this._pageSize,paging:this})},_changePageSize:function(a){var b=T.event.get(a).target;this._pageSize=parseInt(b.value,10);this._offset=0;this._computeParams();this.options.onchange({offset:this._offset,currentPage:this._currentPage,pageSize:this._pageSize,paging:this})},_bindEvent:function(){T.event.ons(T.q("page-number",this.options.containerId),"click",T.fn.bind(this._changePage,this));T.event.ons(T.q("button",this.options.containerId),"click",T.fn.bind(this._gotoPage,this));T.event.ons(T.dom.query("#"+this.options.containerId+" div.page-size select"),"change",T.fn.bind(this._changePageSize,this))},clear:function(){T.dom.empty(this.options.containerId)},render:function(c,d,b){if(!T.g(this.options.containerId)){return}if(c!=null){this._total=c}if(d!=null){this._offset=d}if(b!=null){this._fuzzy=b}if(c!=null||d!=null){this._computeParams()}T.dom.empty(this.options.containerId);var a=this._renderPageSize()+this._renderPaging();if(a!=null&&a.length>0){T.insertHTML(this.options.containerId,"beforeend",T.format(this.options.pagingWrapperTemplate,a));this._bindEvent()}}});T.ui.CheckGroup=T.createUI({options:{containerId:"CheckGroup",onchange:function(a,b){},limit:Number.MAX_VALUE,label:"",items:[],disabled:false,tip:false,selectedItems:[],template:'<label for="!{0}"><input id="!{0}" value="!{1}" type="#{2}" title="!{3}" #{4} name="#{5}" #{7} />#{6}</label>',groupTemplate:'<div class="group">#{1}#{0}</div>',separatorTemplate:'<div class="separator"></div>',tipTemplate:'<a class="help" data="#{0}" href="javascript:void(0)">&nbsp;</a>'},_type:"checkGroup",_items:null,_selectedItems:null,_init:function(){if(!T.lang.isArray(this.options.items[0])){this._items=[this.options.items]}else{this._items=this.options.items}this._selectedItems=T.object.clone(this.options.selectedItems);this._type=(this.options.limit==1?"radio":"checkbox")},_renderHtml:function(){var a=[];T.array.each(this._items,function(d,c){var b=[];if(d.length!=0){if(c!=0){a.push(this.options.separatorTemplate)}T.array.each(d,function(g,f){if(this.options.tip){var e=T.encodeHTML(g.label)+T.format(this.options.tipTemplate,g.id)}else{e=g.label}b.push(T.format(this.options.template,this.getId(g.id),g.id,this._type,g.label,(T.array.contains(this._selectedItems,g.id)?' checked="checked"':""),this.getId(this.options.containerId),e,this.options.disabled?" disabled":""))},this);a.push(T.format(this.options.groupTemplate,b.join(""),this.options.label?'<label class="label">'+this.options.label+"</label>":""))}},this);return a.join("")},_bind:function(){T.array.each(T.dom.query(":input",T.g(this.options.containerId)),function(a,b){var c=this;this.on(a,"click",function(f){if(c._type=="checkbox"){var d=c._selectedItems;if(this.checked){d.push(this.value)}else{if(d.length==1){this.checked=true;return false}T.array.remove(d,this.value)}if(d.length>c.options.limit){var e=T.array.removeAt(d,0);T.g(c.getId(e)).checked=false}}else{if(c._selectedItems&&c._selectedItems.length==1&&c._selectedItems[0]==this.value){return}c._selectedItems=[this.value]}var g=[];T.array.each(c._selectedItems,function(h){g.push(T.getAttr(c.getId(h),"title"))});c.options.onchange(c._selectedItems,g)})},this)},reset:function(){var a=T.g(this.options.containerId),c=this.getId(this.options.items[0].id),b=this;if(a){T.array.each(T.dom.query("input",a),function(d){var e=d.id;if(c==e){d.checked=true}else{d.checked=false}})}this._selectedItems=T.object.clone([this.options.items[0].id]);this.options.onchange(this._selectedItems,[])},render:function(){var a=T.g(this.options.containerId);if(a){T.dom.empty(a);T.insertHTML(a,"beforeEnd",this._renderHtml());this._bind()}},click:function(b){var a=T.g(this.getId(b));if(a){a.click()}},getSelectedLabels:function(){var b=[],a=this;T.array.each(this._selectedItems,function(c){b.push(T.getAttr(a.getId(c),"title"))});return b},getSelectedItems:function(){return this._selectedItems},hide:function(){T.dom.hide(this.options.containerId)},show:function(){T.dom.show(this.options.containerId)}});baidu.ui.Combobox=T.createUI({_type:"combobox",options:{containerId:null,items:null,selectedId:null,defaultText:"请选择",width:200,onchange:function(a){},comboboxTemplate:'<a class="combobox" href="javascript:void(0)" id="#{1}" layer="##{2}"><span title="!{0}" class="text">!{0,20}</span><span class="arrow"></span></a>',itemTemplate:'<li><a title="!{0}" href="javascript:void(0)" data="#{1}" class="#{2}">!{0}</a></li>',wrapperTemplate:'<ul class="options layer" style="display:none;position:absolute;width:#{2}px" id="#{1}">#{0}</ul>'},_init:function(){this._selectedId=this.options.selectedId;this._items=this.options.items;this._defaultText=this.options.defaultText},_selectedId:null,_items:null,_defaultText:null,_bindEvents:function(){var a=this;T.event.ons(T.dom.query("#"+this.getId("List")+">li>a"),"click",function(){var d=T.dom.getAttr(this,"data");var b=T.array.find(a._items,function(e){if(e.id==d){return true}});var c=T.dom.one(".text",a.getId());if(c){c.innerHTML=T.format("!{0,20}",b.label);c.title=b.label}a._hide();a.options.onchange(d)});T.on(this.getId(),"click",function(){if(T.dom.hasClass(this,"combobox-disabled")){return}var b=T.dom.one(".arrow",this);if(!T.dom.hasClass(b,"selected")){a._show()}})},_show:function(){var a=T.getCornerPosition(this.getId(),"bl");T.dom.setPosition(this.getId("List"),a)},_hide:function(){var a=T.dom.one(".arrow",this.getId());if(T.dom.hasClass(a,"selected")){T.dom.removeClass(a,"selected")}T.hide(this.getId("List"))},_render:function(){var d=this._defaultText;if(this._items&&this._items.length>0){d=this._items[0].label;if(this._selectedId){for(var a in this._items){var b=this._items[a];if(b.id==this._selectedId){d=b.label;break}}}}T.dom.insertHTML(this.options.containerId,"beforeend",T.format(this.options.comboboxTemplate,d,this.getId(),this.getId("List")));if(this._items&&this._items.length>0){T.dom.removeClass(this.getId(),"combobox-disabled");var c=[];for(var a=0;a<this._items.length;a++){var b=this._items[a];c.push(T.format(this.options.itemTemplate,b.label,b.id,b.disabled?"disabled":""))}T.dom.insertHTML(document.body,"beforeend",T.format(this.options.wrapperTemplate,c.join(""),this.getId("List"),this.options.width))}else{T.dom.addClass(this.getId(),"combobox-disabled")}},setDefaultText:function(a){this._defaultText=a},render:function(b,a){if(!T.g(this.options.containerId)){return}if(b||b===null){this._items=b}if(a||a===null){this._selectedId=a}T.dom.empty(this.options.containerId);if(T.g(this.getId("List"))){T.dom.remove(this.getId("List"))}this._render();this._bindEvents()}});T.CreateFlash=T.createClass({options:{ids:[],containerId:"FlashContainer",data:null,by:[],type:[],indicator:null},_init:function(){EventRouter.register("onflashLoaded",T.fn.bind(this._flashLoadedCallback,this));this.dataAdapter=new T.DataAdapter();this.flashFormatConverter=new T.FlashFormatConverter();var b=this,a=T.g(this.options.containerId);T.array.each(this.options.data,function(f,d){var c="Flash_"+d,e="FlashContainerId_"+d,g=T.dom.create("div",{id:e});a.appendChild(g);b._initFlash({id:c,type:b.options.type[d],flashContainerId:e,flashBaseUrl:"flash/"})})},_initFlash:function(b){var a=b.flashBaseUrl+b.type+".swf";T.swf.create({id:b.id,url:a,width:b.width||"100%",height:b.height||"320",bgColor:"#FFFFFF",wmode:"transparent",errorMessage:"载入FLASH出错",ver:"9.0.0",allowscriptaccess:"always",vars:{flashId:b.id,baseUrl:b.flashBaseUrl+"fla"}},b.flashContainerId)},_flashLoadedCallback:function(e){var a=e.split("_"),d=a[1],f=this.options.data[d];var h=f.msg,b=f.status,c=f.data;c.flashId=e;c.by=this.options.by[d];c.type=this.options.type[d];c.indicator=this.options.indicator;if(c.type=="bar"){c.tipLabel="SmallTip"}var g=this.dataAdapter.convertFlashDataFormat(c);this.flashFormatConverter.setFlash(g)}});T.CreateHtml5=T.createClass({options:{ids:[],containerId:["FlashContainer"],data:null,by:[],type:[],indicator:null,args:[]},_init:function(){this.dataAdapter=new T.DataAdapter();var a=this;T.array.each(this.options.data,function(c,b){var d=c.data;d.by=a.options.by[b];d.type=a.options.type[b];d.indicator=a.options.indicator;d=a.dataAdapter.convertFlashDataFormat(d);a._initHtml(d,T.extend({id:a.options.ids[b],type:a.options.type[b],chart:a.options.chart[b],containerId:a.options.containerId[b]},a.options.args[b]))})},_initHtml:function(e,b){var d,a;if(b.chart=="WorldArea"){a="450px"}var c=new T.charts[b.chart](e,{data:b.data,containerId:b.containerId,width:b.width,height:a})}});baidu.ui.CustomizableDroplist=T.createUI({_type:"CustomizableDroplist",options:{containerId:null,items:{systemItems:null,customItems:null},selectedId:null,defaultLabel:"",customizable:true,customizableButtonLabel:"",width:200,onchange:function(a){},ondelete:function(a){},onadd:function(){},templates:{header:'<span class="cst-dp-header">                         <span class="cst-dp-desc">#{0}</span>                         <span class="cst-dp-label" title="!{1}">!{1}</span>                         <span class="cst-dp-arrow"><em></em></span>                    </span>',droplist:'<ul class="cst-dp-body" style="display: none">#{0}</ul>',droplistItem:'<li data="#{1}">                              <a class="cst-dp-item-add-icon">&nbsp;</a>                              <a title="!{0}" class="ellipsis cst-dp-item-label">!{0}</a>#{2}                          </li>',droplistItemDelete:'<a class="cst-dp-item-del" data="#{0}"></a>',droplistItemAdd:'<li class="cst-dp-item-add">                                  <a class="cst-dp-item-add-icon">+</a>                                  <a title="#{0}" class="ellipsis cst-dp-item-label">#{0}</a>                             </li>'}},_selectedId:null,_systemItems:[],_customItems:[],_defaultLabel:"",_init:function(){this._selectedId=this.options.selectedId;this._defaultLabel=this.options.defaultLabel&&(this.options.defaultLabel+"：");if(!this.options.customizable||!this.options.items.systemItems){this._systemItems=this.options.items}else{this._systemItems=this.options.items.systemItems;this._customItems=this.options.items.customItems}this._render()},_render:function(){this._renderHeader();this._renderDropdown();this._bindEvents()},_renderHeader:function(){var a=this._fetchLabel(this._selectedId);var b=T.format(this.options.templates.header,this._defaultLabel,a);T.dom.insertHTML(this.options.containerId,"beforeend",b)},_updateHeader:function(c){var b=this._fetchLabel(this._selectedId);var a=T.dom.one(".cst-dp-label",T.g(this.options.containerId));a.innerHTML=T.string.encodeHTML(b);T.dom.setAttr(a,"title",b)},_renderDropdown:function(){var a=this._createDropItemHtml();var b=T.format(this.options.templates.droplist,a);T.dom.insertHTML(this.options.containerId,"beforeend",b);T.fn.bgiframe(T.dom.q(".cst-dp-body"))},_createDropItemHtml:function(){var a=[];var d;for(var c=0;c<this._systemItems.length;c++){d=this._systemItems[c];a.push(T.format(this.options.templates.droplistItem,d.label,d.id))}if(!this.options.customizable){return a.join("")}a.push(T.format(this.options.templates.droplistItemAdd,this.options.customizableButtonLabel));for(var b=0;b<this._customItems.length;b++){d=this._customItems[b];a.push(T.format(this.options.templates.droplistItem,d.label,d.id,T.format(this.options.templates.droplistItemDelete,d.id)))}return a.join("")},_bindEvents:function(){var a=T.g(this.options.containerId);T.event.on(document,"click",T.fn.bind(this._toggleBody,this));var b=T.dom.query(".cst-dp-body",a);T.event.ons(b,"mouseout",T.fn.bind(this._listItemHoverClearHandler,this));T.event.ons(b,"mouseover",T.fn.bind(this._listItemHoverHandler,this));T.event.ons(b,"click",T.fn.bind(this._listItemClickHandler,this));if(this.options.customizable){var c=T.dom.query(".cst-dp-item-del",a);T.event.ons(c,"click",T.fn.bind(this._listItemDeleteHandler,this))}},_toggleBody:function(c){T.event.stopPropagation(c);var d=T.event.getTarget(c);var b=T.g(this.options.containerId);var e=T.dom.one(".cst-dp-header",b);var a=T.dom.one(".cst-dp-body",b);if(T.dom.contains(e,d)){T.dom.toggleClass(e,"cst-dp-header-selected");T.dom.toggle(a)}else{if(!T.dom.contains(a,d)){T.dom.hide(a);T.dom.removeClass(e,"cst-dp-header-selected")}}},_listItemClickHandler:function(d){T.event.stop(d);var e=T.event.getTarget(d);var g=e.tagName!="LI"?T.dom.getAncestorByTag(e,"li"):e;var b=T.g(this.options.containerId);var f=T.dom.one(".cst-dp-header",b);var a=T.dom.one(".cst-dp-body",b);if(T.dom.contains(b,g)&&!T.dom.hasClass(g,"cst-dp-item-add")){var c=T.dom.getAttr(g,"data");this._selectedId=c;this._updateHeader();this.options.onchange(c)}else{if(T.dom.hasClass(g,"cst-dp-item-add")){this.options.onadd()}}T.dom.hide(a);T.dom.removeClass(f,"cst-dp-header-selected")},_listItemDeleteHandler:function(b){T.event.stop(b);var c=T.event.getTarget(b);var a=T.dom.getAttr(c,"data");this.options.ondelete(a)},_listItemHoverClearHandler:function(a){var b=T.dom.query(".cst-dp-body li",T.g(this.options.containerId));T.element(b).each(function(c){T.dom.removeClass(c,"hover")})},_listItemHoverHandler:function(a){T.event.stop(a);var b=T.event.getTarget(a);var c=b.tagName!="LI"?T.dom.getAncestorByTag(b,"li"):b;this._listItemHoverClearHandler();c&&T.dom.addClass(c,"hover")},_fetchLabel:function(d){var c;var b=this._systemItems.concat(this._customItems);for(var a=0;a<b.length;a++){c=b[a];if(c.id==d){return c.label||""}}return""},getItem:function(d){var b=this._systemItems.concat(this._customItems);var c;for(var a=0;a<b.length;a++){c=b[a];if(c.id==d){return c}}},hide:function(){T.dom.hide(this.options.containerId)},show:function(){T.dom.show(this.options.containerId)}});T.DataAdapter=T.createClass({options:{onflashError:function(a){},onchartError:function(a){},errorLinkTemplate:'<font color="#0965B8"><a title="#{0}" target="_blank" href="#{1}&from=#{2}">#{0}</a></font>',icoErrorTemplate:"暂无数据，请先安装代码，然后检查代码安装正确性，若安装正确20分钟之后将生成数据。",notIcoErrorTempalte:"暂无数据，请先#{0}，然后#{1}，若安装正确20分钟之后将生成数据。",multipleSiteErrorTemplate:"暂无数据。"},ConvertTableData:function(B){var r=T.config.indexInfo.indexes;var e=T.array.map(r,function(i){return i.id});var l=null;T.each(B.fields,function(j){var i=T.array.indexOf(e,j);if(i>-1){l=r[i]}});var y=T.config.indexInfo.indicators;var t=T.array.map(y,function(i){return i.id});var a=[];T.each(B.fields,function(j){var i=T.array.indexOf(t,j);if(i>-1){a.push(y[i])}});var w=[];var b=[];var s=[];if(l){var f=l.type?"table-index "+l.type:"table-index";w.push({id:l.id,label:l.label,sortable:l.sortable,className:f})}for(var v=0;v<a.length;v++){var q=a[v];w.push({id:q.id,label:q.label,sortable:q.sortable,className:q.type})}var A=false;var x=false;var o=1;if(B.items[2]&&B.items[2].length>0){A=true;o=3}if(B.items[3]&&B.items[3].length>0){x=true;o=4}for(var v in B.items[0]){var d=B.items[0][v];var p=B.items[1][v];var g=A?B.items[2][v]:null;var k=x?B.items[3][v]:null;if(!A){var h=[];if(l){var f=l.type?"table-index "+l.type:"table-index";if(T.lang.isObject(d[0])){var n={id:l.id,label:d[0].label,className:f};if(d[0].expandable!=null){n.expandable=d[0].expandable}if(d[0].hasOperation!=null){n.hasOperation=d[0].hasOperation}if(d[0].data!=null){n.data=d[0].data}h.push(n)}else{h.push({id:l.id,label:d[0],className:f})}}for(var u=0;u<a.length;u++){var q=a[u];h.push({id:q.id,label:this._formatTableText(p[u],q.type),className:q.type})}b.push(h)}else{var c=[];var z=[];var m=[];if(l){var f=l.type?"table-index "+l.type:"table-index";if(T.lang.isObject(d[0])){var n={id:l.id,label:d[0].label,className:f};if(d[0].expandable!=null){n.expandable=d[0].expandable}if(d[0].hasOperation!=null){n.hasOperation=d[0].hasOperation}if(d[0].data!=null){n.data=d[0].data}b.push([n,{label:"&nbsp;",className:"",colspan:a.length}])}else{b.push([{label:d[0],className:f},{label:"&nbsp;",className:"",colspan:a.length}])}}c.push({id:l.id,label:p[0]});z.push({id:l.id,label:g[0]});x&&m.push({id:l.id,label:k[0]});for(var u=0;u<a.length;u++){var q=a[u];c.push({id:q.id,label:this._formatTableText(p[u+1],q.type),className:q.type});z.push({id:q.id,label:this._formatTableText(g[u+1],q.type),className:q.type});x&&m.push({id:q.id,label:this._formatTableText(k[u+1],"ratio"),className:q.type})}b.push(c);b.push(z);x&&b.push(m)}}if(B.pageSum&&B.pageSum.length>0){var p=B.pageSum[0];var g=A?B.pageSum[1]:null;var k=x?B.pageSum[2]:null;if(!A){var h=[];if(l){h.push({id:l.id,label:"当页汇总"})}for(var u=0;u<a.length;u++){var q=a[u];h.push({id:q.id,label:this._formatTableText(p[u],q.type),className:q.type})}s.push(h)}else{var c=[];var z=[];var m=[];if(l){s.push([{id:l.id,label:"当页汇总",colspan:a.length+1}])}c.push({id:l.id,label:p[0]});z.push({id:l.id,label:g[0]});x&&m.push({id:l.id,label:k[0]});for(var u=0;u<a.length;u++){var q=a[u];c.push({id:q.id,label:this._formatTableText(p[u+1],q.type),className:q.type});A&&z.push({id:q.id,label:this._formatTableText(g[u+1],q.type),className:q.type});x&&m.push({id:q.id,label:this._formatTableText(k[u+1],"ratio"),className:q.type})}s.push(c);A&&s.push(z);x&&s.push(m)}}if(B.sum&&B.sum.length>0){for(var u=0;u<a.length;u++){var q=a[u];B.sum[0][u]=this._formatTableText(B.sum[0][u],q.type);if(A){B.sum[1][u]=this._formatTableText(B.sum[1][u],q.type)}}}B.thead=w;B.tbody=b;B.tfoot=s;B.group=o;B.isCompare=A;B.indicators=a;return B},_formatTableText:function(b,a){if(b==null){return""}if(b=="--"){return b}if(T.lang.isString(a)){switch(a){case"number":return T.i18n.number.formatNumber(b);case"ratio":return T.i18n.number.formatRatio(b);case"time":return T.i18n.number.formatTime(b);case"time2":return T.i18n.number.formatTime(b,2)}}return b},ConvertFlowData:function(f){var g={};for(var d in f){var a=f[d].items;var b=a[0],e=a[1];var c=[];T.array.each(b,function(j,h){c.push(j.concat(e[h]))});g[d]=c}return g},convertFlashDataFormat:function(a){var c,b=a.type;switch(b){case"line":c=this.convertFlashLineDataFormat(a);break;case"linepie":c=this.convertFlashLinePieDataFormat(a);break;case"area":c=this.convertFlashAreaDataFormat(a);break;case"areapie":c=this.convertFlashAreaPieDataFormat(a);break;case"circle":c=this.convertFlashCircleDataFormat(a);break;case"circlegraph":c=this.convertFlashCircleGraphDataFormat(a);break;case"bar":c=this.convertFlashBarDataFormat(a);break;default:break}return c},convertFlashLinePieDataFormat:function(c){var s=c.flashId,h=c.line,f=h.fields,t=h.items,k=c.pie,a=k.fields,e=k.items,g=[];var n=["label"],d=[];var m=t[0],r=t[1];if((m==null||m.length==0)||(r==null||r.length==0)){this._showErrorTip(s);return}for(var p=1,o=f.length;p<o;p++){n.push(f[p])}T.array.each(m,function(u,l){d.push(u.concat(r[l]))});this._addLineTip(c,n,d,"SmallTip",g);var b=["label","value"],q=[];var j=e[0],r=e[1];T.array.each(j,function(u,l){q.push(u.concat(r[l]))});return{flashId:s,type:c.type,units:this._getUnits([c.indicator]),highlightIndexs:g,indicator:this._getIndicatorLabel(c.indicator),bar:c.bar,line:{fields:n,items:d},pie:{fields:b,items:q}}},convertFlashCircleGraphDataFormat:function(d){var e=d.flashId,a=d.fields,b=d.items;var f=["label","dataB","dataL","dataR"],h=[];var c=b[0],g=b[1];if((c==null||c.length==0)||(g==null||g.length==0)){this._showErrorTip(e);return}T.array.each(c,function(k,j){h.push(k.concat(g[j]))});return{flashId:e,fields:f,items:h,type:d.type}},convertFlashBarDataFormat:function(a){var b=a.flashId,e=[];var f=this._convertFlashDataFormat(a);var c=f.flashFields,d=f.flashItems;return{flashId:b,fields:c,units:this._getUnits(a.fields),items:d,type:a.type,highlightIndexs:e,indicator:this._getIndicatorLabel(a.indicator)}},convertFlashCircleDataFormat:function(n){var j=n.flashId,f=n.fields,h=n.items;var a=["label","value","ratio"],m=[],b=[];var d=h[0],k=h[1];if((d==null||d.length==0)||(k==null||k.length==0)){this._showErrorTip(j);return}for(var e=1,c=f.length;e<c;e++){if(/^ratio/i.test(f[e])){b.push(e-1)}}for(var e in b){var g=b[e];T.array.each(k,function(i){i[g]=i[g]+"%"})}T.array.each(d,function(o,l){m.push(o.concat(k[l]))});return{flashId:j,fields:a,units:this._getUnits(f),items:m,type:n.type,indicator:this._getIndicatorLabel(n.indicator)}},convertFlashAreaPieDataFormat:function(a){return this.convertFlashAreaDataFormat(a)},convertFlashAreaDataFormat:function(b){var h=b.containerId,t=b.flashId,j=b.fields,g=b.items;var d=["label","value","ratio","color"],q=[];var m=g[0],s=g[1],a=g[2];if((m==null||m.length==0)||(s==null||s.length==0)){if(t=="FlashAreaPie"&&T.ie<7){this._showErrorTip(t,b)}else{this._showChartError(h)}return}T.array.each(m,function(u,l){q.push(u.concat(s[l]))});var f=0,c=1;for(var r=0,o=q.length;r<o;r++){var s=q[r],e=s[s.length-1];f=Math.max(f,e);c=Math.min(c,e)}var k=(f-c)/5,n=[f,f-k,f-k*2,f-k*3,f-k*4,c];for(var r=0,o=q.length;r<o;r++){var s=q[r],e=s[s.length-1],p;s[s.length-1]=s[s.length-1]+"%";if(e<=n[0]&&e>n[1]){p="0x1556a1"}else{if(e<=n[1]&&e>n[2]){p="0x136bd4"}else{if(e<=n[2]&&e>n[3]){p="0x6c98d5"}else{if(e<=n[3]&&e>n[4]){p="0x9fccff"}else{p="0xdcecff"}}}}s.push(p)}return{containerId:h,flashId:t,fields:d,units:this._getUnits(j),items:q,type:b.type,indicator:this._getIndicatorLabel(b.indicator)}},convertFlashLineDataFormat:function(a){var b=a.flashId,g=a.timeSpan,e=[],h=a.tipLabel||"BigTip";var f=this._convertFlashDataFormat(a);var c=f.flashFields,d=f.flashItems;this._addLineTip(a,c,d,h,e);return{flashId:b,fields:c,units:this._getUnits(a.fields,a.items[2]?a.items[2].length:0),items:d,type:a.type,highlightIndexs:e,indicator:this._getIndicatorLabel(a.indicator)}},_addLineTip:function(a,b,d,e,c){if(a.by=="hour"){b.push(b[0]+e);T.array.each(d,function(f){var g=T.config.lineChartDayTimeMap[f[0]];if(g){f.push(g)}else{f.push(f[0])}});T.array.each(d,function(g,f){if(f==d.length-1){g[0]=f+"/点"}else{g[0]=f}})}else{if(a.by=="day"){b.push(b[0]+e);T.array.each(d,function(g,f){T.array.each(g,function(p,k){if(k>0){return}var n=false,m;for(var i in T.config.holidays){m=T.config.holidays[i];if(m.test(p)){this.push(p+" ("+i+")");c.push(f);n=true;break}}if(!n){var m=new RegExp("^\\d+(\\-|\\/)\\d+(\\-|\\/)\\d+\x24");if(m.test(p)){var l=new Date(p),h=l.getDay(),o;switch(h){case 0:o=p+" (星期日) ";break;case 6:o=p+" (星期六) ";break;default:o=p;break}this.push(o);if(h==0||h==6){c.push(f);n=true}}}})})}}},_filterFlashData:function(d){var a=d.fields,c=d.items;var f=c[1],g=c[2];var b=new T.Indicator({indicators:T.config.indexInfo.flashIndicators});var e=b.map(a);T.array.each(e,function(j,h){if(j){T.array.each(f,function(k,i){k[h-1]=j.format(k[h-1])});T.array.each(g,function(k,i){k[h-1]=j.format(k[h-1])})}})},_convertFlashDataFormat:function(c){var t=c.flashId,r=c.timeSpan,k=c.fields,j=c.items,g=c.tipLabel||"BigTip";var m=j[0],s=j[1],a=j[2];var d=[],p=[],n=[];if((m==null||m.length==0)||(s==null||s.length==0)){this._showErrorTip(t,c);return{flashFields:[],flashItems:[]}}d.push("label");var e=new T.Indicator({indicators:T.config.indexInfo.flashIndicators});var h=e.map(k);if(!a||a.length==0){for(var q=1,o=h.length;q<o;q++){if(h[q]){d.push(h[q].label)}else{if(/^ratio/i.test(k[q])){d.push(d[d.length-1]+g);n.push(q-1)}}}T.array.each(s,function(i){T.array.each(i,function(v,l){if(T.array.contains(n,l)){i[l]=h[l].format(i[l-1])+" | 占比: "+T.i18n.number.formatRatio(i[l])}else{var u=h[l+1];if(u&&!T.array.contains(k,"ratio_"+u.id)){if(!T.array.contains(d,d[l+1]+g)){d.push(d[l+1]+g)}i.push(u.format(i[l]))}}})});T.array.each(m,function(u,l){p.push(u.concat(s[l]))})}else{T.array.each(k,function(u,l){if(/^ratio/i.test(u)){n.push(l-1)}});T.array.each(r,function(i){d.push(i);d.push(i+g)});T.array.each(s,function(i){T.array.each(i,function(v,l){if(l==0){return}if(T.array.contains(n,l)){i[l]=h[l].format(i[l-1])+" | 占比: "+T.i18n.number.formatRatio(i[l])}else{var u=h[l+1];if(u&&!T.array.contains(k,"ratio_"+u.id)){i.push(u.format(i[l]))}}})});T.array.each(a,function(i){T.array.each(i,function(v,l){if(l==0){return}if(T.array.contains(n,l)){i[l]=h[l].format(i[l-1])+" | 占比: "+T.i18n.number.formatRatio(i[l])}else{var u=h[l+1];if(u&&!T.array.contains(k,"ratio_"+u.id)){i.push(u.format(i[l]))}}})});if(c.by=="day"||c.by=="week"||c.by=="month"){var f=T.array.map(T.object.clone(a),function(i){T.array.removeAt(i,0);return i});T.array.each(s,function(u,l){p.push(s[l].concat(f[l]))})}else{if(c.by=="hour"){var b=T.array.map(T.object.clone(s),function(i){T.array.removeAt(i,0);return i});var f=T.array.map(T.object.clone(a),function(i){T.array.removeAt(i,0);return i});T.array.each(m,function(u,l){p.push(u.concat(b[l],f[l]))})}}}return{flashFields:d,flashItems:p}},_showChartError:function(b){var c;if(T.isMultipleSite()){c=this.options.multipleSiteErrorTemplate}else{if(!T.isIco()){c=T.format(this.options.notIcoErrorTempalte,T.format(this.options.errorLinkTemplate,"安装代码",T.config.systemConfig.scUri+"/home/site/getjs?siteId="+T.config.siteInfo.id,T.config.pageInfo.currentSystemId),T.format(this.options.errorLinkTemplate,"检查代码安装正确性",T.config.systemConfig.scUri+"/home/js/check?siteId="+T.config.siteInfo.id,T.config.pageInfo.currentSystemId))}else{c=this.options.icoErrorTemplate}}var a=T.g(b);if(a){T.dom.empty(a);T.dom.insertHTML(a,"beforeEnd",T.format('<div class="chart-tip-container">#{0}</div>',c))}this.options.onchartError(b,c)},_showErrorTip:function(c,a){var d=T.swf.getMovie(c),b;if(T.isMultipleSite()){b=this.options.multipleSiteErrorTemplate}else{if(!T.isIco()){b=T.format(this.options.notIcoErrorTempalte,T.format(this.options.errorLinkTemplate,"安装代码",T.config.systemConfig.scUri+"/home/site/getjs?siteId="+T.config.siteInfo.id,T.config.pageInfo.currentSystemId),T.format(this.options.errorLinkTemplate,"检查代码安装正确性",T.config.systemConfig.scUri+"/home/js/check?siteId="+T.config.siteInfo.id,T.config.pageInfo.currentSystemId))}else{b=this.options.icoErrorTemplate}}if(d){d.showErrorTip(b)}this.options.onflashError(c,a)},_getIndicatorLabel:function(b){if(!b){return}var a=b.split(","),c=[];T.array.each(a,function(e){var d=T.array.find(T.config.indexInfo.flashIndicators,function(f,g){return e==f.id});if(d){c.push(d.label)}});return c.join()},_getUnits:function(a,d){var c=T.array.map(a,function(e){return T.array.find(T.config.indexInfo.flashIndicators,function(f){return e==f.id})});var b=[];T.array.each(c,function(e){if(e){var f=e.unit;if(!T.array.contains(b,f)){b.push(f)}}});if(d&&d!=0){b=b.concat(b)}return b}});T.DateCompare=T.createClass({options:{containerId:"CheckOptionContainer",onchange:function(){},isComparable:0,checkedId:null,date:null},_checkedId:null,params:{},_init:function(){this._checkedId=this.options.checkedId;var b=T.g(this.options.containerId);if(b){var a=b.getElementsByTagName("input");T.event.ons(a,"click",this._onchange())}var c=parseInt(T.config.pageInfo.st),g=parseInt(T.config.pageInfo.et),e=parseInt(T.config.pageInfo.st2),f=parseInt(T.config.pageInfo.et2),d=3600*24*1000;this.params.st=this.params.et=c;if((g-c)<=d){if(T.g("CustomDateSelect")&&e&&f&&(f-e)<=d){this.params.et2=this.params.st2=e;this.show(this.params.st,1)}else{this.show(this.params.st)}}else{this.hide()}},_onchange:function(){var a=this;return function(){a._syncStartDate();var d=this.id,b=a._checkedId;if(!b){a._checkedId=d}else{var c=T.g(b);if(b!=d){c.checked=false;a._checkedId=d}else{a._checkedId=null}}a._handleParams();a.options.onchange(a.params,a.options.isComparable)}},checkComparation:function(a){var c=T.g(this.options.containerId);if(c){switch(a){case 0:this._checkedId="LastDay";break;case 1:this._checkedId="LastWeek";break;default:this._checkedId=null}var b=c.getElementsByTagName("input");for(var d=0,e=b.length;d<e;d++){b[d].checked=(d==a)}}},hide:function(){var a=T.g(this.options.containerId);if(a){a.style.display="none";this.params.st2=null;this.params.et2=null;this.options.isComparable=0}},show:function(c,b){var a=T.g(this.options.containerId);if(a){var f=T.date.format(new Date(c),"yyyy-MM-dd");c=T.date.parse(f);this.options.date=c.getTime();if(!b){this._handleParams()}else{var e=baidu.G("DateSelectBar").getElementsByTagName("A");if(this.params.st2+1000*3600*24==this.params.st){this.checkComparation(0)}else{if(this.params.st2+1000*3600*24*7==this.params.st){this.checkComparation(1)}else{this.checkComparation()}}}a.style.display="block"}},_handleParams:function(){var a=this.options.date;var c=T.g("LastDay");var b=T.g("LastWeek");if(c&&c.checked){this.params.et2=this.params.st2=a-3600*24*1000;this.options.isComparable=1}else{if(b&&b.checked){this.params.et2=this.params.st2=a-7*3600*24*1000;this.options.isComparable=1}else{this.options.isComparable=0;this.params.st2=null;this.params.et2=null}}},_syncStartDate:function(){var c=T.dom.query("#DateSelectBar a.cur");if(c&&c.length>0){c=c[0];var b=c.href.indexOf("#");if(b!=-1){var a=parseInt(c.href.substring(b+1,c.href.length));if(a==0||a==-1){this.options.date=parseInt(T.config.systemConfig.now)+a*3600*24*1000}}}else{var d=T.dom.query("#CustomDateSelect input")[0];if(d&&d.value!=="自定义时间段"){this.options.date=+new Date(d.value)}}},setDate:function(a){var b=T.date.format;this.params.st=new Date(b(new Date(a.st),"yyyy/MM/dd")).getTime();this.params.et=new Date(b(new Date(a.et),"yyyy/MM/dd")).getTime();if(a.st2){this.params.st2=new Date(b(new Date(a.st2),"yyyy/MM/dd")).getTime()}else{this.params.st2=null}if(a.et2){this.params.et2=new Date(b(new Date(a.et2),"yyyy/MM/dd")).getTime()}else{this.params.et2=null}}});T.dom.ready(function(){T.lang.Class.create(T.ToggleTarget,{memo:T.config.memo,onchange:function(f){EventRouter.dispatch("onchangeToggleTarget",f)}});T.lang.Class.create(T.TrackTarget,{onchange:function(f){EventRouter.dispatch("onchangeTrackTarget",f)}});T.lang.Class.create(T.RecordTarget,{onchange:function(f){EventRouter.dispatch("onchangeRecordTarget",f)}});T.event.ons(T.dom.query("ul.nav a.open,ul.nav a.close"),"click",function(f){T.event.preventDefault(f);if(T.dom.hasClass(this,"close")){T.show(T.dom.next(this))}else{T.hide(T.dom.next(this))}T.dom.toggleClass(this,"close");T.dom.toggleClass(this,"open")});if(T.g("MoreNav")){T.on("MoreNav","mouseover",function(){T.dom.addClass(this,"more-hover")});T.on("MoreNav","mouseout",function(){T.dom.removeClass(this,"more-hover")})}if(T.g("MoreNav2")){T.on("MoreNav2","mouseover",function(){T.dom.addClass(this,"more-hover")});T.on("MoreNav2","mouseout",function(){T.dom.removeClass(this,"more-hover")})}if(T.config&&T.config.siteInfo&&T.config.siteList&&T.config.userInfo&&T.g("SiteListContainer")){var e=new T.ui.SiteSelector({siteList:T.config.siteList,defaultSiteId:T.config.userInfo.defaultSiteId,siteId:T.config.siteInfo.id,containerId:"SiteListContainer"});e.render()}if(T.g("ReportTipIco")){T.event.on("ReportTipIco","click",function(f){T.event.preventDefault(f);if(T.dom.hasClass(this,"close")){T.fx.expand("ReportTip")}else{T.fx.collapse("ReportTip")}T.dom.toggleClass(this,"close");T.dom.toggleClass(this,"open")})}T.fn.bgIframe(T.dom.q("bg-iframe"));var d=function(){if((document.documentElement.scrollTop||document.body.scrollTop)>0){T.show("BackToTop")}else{T.hide("BackToTop")}};if(T.g("BackToTop")){T.on(window,"scroll",function(){d()})}if(T.g("BackToTop")){T.on(window,"resize",function(){d()})}T.inlineTip("Help");T.inlineTip("ReportHelp");T.dom.one(".report-help")&&(T.dom.setStyle(T.dom.one(".tip-arrow"),"left",(T.dom.one(".report-help").offsetLeft+2)+"px"));if(T.config.userInfo&&T.config.userInfo.auths){var b=T.dom.one(".market-link");if(b){var a=T.lang.Class.create(T.Guide,{newFunctionGuide:false,hasMarketAuth:T.config.userInfo.auths.hm_auth_module_marketing});T.on(b,"click",function(f){if(!T.config.userInfo.auths.hm_auth_module_marketing){T.event.stop(f);a.showTip("您还未开通百度精算权限，请联系管理员为您开通！")}})}}if(T.g("RecommendReportsContent")){baidu.lang.Class.create(T.SetRecommendReports)}setTimeout(function(){(new Image()).src=T.config.systemConfig.baseUri+"/stat/index"},30*60*1000);var c=T.g("OverviewDefault");if(c){T.on(c,"click",function(f){T.ajax.jsonPost(T.config.systemConfig.ajaxUri,{method:"overview/setDefault",type:T.config.pageInfo.overviewType=="sole"?"multi":"sole"},function(h,g){c.innerHTML="已设为默认查看页！";setTimeout(function(){T.hide(c)},4000)},function(g){T.hide(c)})})}});T.ui.Download=T.createUI({_type:"download",options:{trigerId:null,reportTitle:null,reportId:null,siteId:null,reportTypes:["pdf","csv"],url:null,onchange:function(a){},wrapperTemplate:'<div class="download-report-wrapper"><div class="download-report-title">#{title}</div><div class="download-report-items">文件类型：#{items}</div><div id="#{tipId}" class="download-report-tip">#{tip}</div><div class="download-report-buttons"><a class="button" id="#{downloadId}" href="javascript:void(0)"><span>下载</span></a><a id="#{cancelId}" href="javascript:void(0)">取消</a></div></div>',itemTemplate:'<label for="#{0}" title="#{2}"><input type="radio" title="#{2}" data="#{4}" id="#{0}"#{3} name="download__report"/>#{1}</label>',iframeTemplate:'<iframe id="#{0}" width="0" height="0"></iframe>',downloads:[{id:"pdf",label:"PDF",title:"本格式图文并茂，阅读时需pdf相应软件。"},{id:"csv",label:"CSV",title:"本格式不含图示，支持较大量数据，便于后期数据处理。"},{id:"html",label:"HTML",title:"本格式图文并茂，支持数据量较少，体积小便于下载阅读。"}]},_downloadType:null,_renderHTML:function(){var c=[];for(var b in this.options.downloads){var a=this.options.downloads[b];if(T.array.contains(this.options.reportTypes,a.id)){c.push(T.format(this.options.itemTemplate,this.getId(a.id),a.label,a.title,b==0?' checked="checked"':"",a.id))}}var d=this.options.downloads[0].title;return T.format(this.options.wrapperTemplate,{title:(this.options.reportTitle||"下载报告"),items:c.join(""),tipId:this.getId("Tip"),tip:d,downloadId:this.getId("Download"),cancelId:this.getId("Cancel")})},_bindEvents:function(){var c=this;for(var b in this.options.reportTypes){var a=this.options.reportTypes[b];T.on(this.getId(a),"click",function(){T.g(c.getId("Tip")).innerHTML=this.title;c._downloadType=T.dom.getAttr(this,"data")})}T.on(this.getId("Download"),"click",function(){c.dialog.close();c.options.onchange(c._downloadType)});T.on(this.getId("Cancel"),"click",function(){c.dialog.close()})},download:function(a){if(a.reportId==null){a.reportId=this.options.reportId}if(a.siteId==null){a.siteId=this.options.siteId}if(a.format==null){a.format=this._downloadType}if(!T.g("DownloadChannel")){T.insertHTML(document.body,"beforeend",T.format(this.options.iframeTemplate,"DownloadChannel"))}T.g("DownloadChannel").src=this.options.url+T.param(a)},_renderDialog:function(){this.dialog=new T.ui.Dialog({id:this.getId("Dialog"),titleText:"下载报告",content:this._renderHTML(),isModal:true,isSingle:true,width:360});this._bindEvents()},render:function(){var a=this;this._downloadType=this.options.reportTypes[0];if(this.options.reportTypes.length>1){T.on(this.options.trigerId,"click",function(){if(!a.dialog){a._renderDialog()}a.dialog.show()})}else{T.on(this.options.trigerId,"click",function(){a.options.onchange(a._downloadType)})}}});T.FlashFormatConverter=T.createClass({options:{onchange:function(a){}},setFlash:function(h){var g=h.flashId,c=h.fields,d=h.units,e=h.items,f=h.type||"line";if((c&&c.length==0)||(e&&e.length==0)){return}var a;if(f=="linepie"){var i=h.line,b=h.pie;a={line:this._convertDataformat(i.fields,i.items),pie:this._convertDataformat(b.fields,b.items)}}else{a=this._convertDataformat(c,e)}this._setData(h,a);this._setStyle(h,a);h.highlightIndexs&&this._setHighLightItem(g,h.highlightIndexs)},_convertDataformat:function(a,b){var d=[],c=[];T.array.each(b,function(e){d.push(T.array.hash(a,e))});return d},_setData:function(c,f){if(!f||f.length==0){return}var d=c.flashId,b=c.fields,e=c.type;var a=T.swf.getMovie(d);a.clear&&a.clear();this.options.onchange(a);if(e=="line"){a.setData(f);c&&c.indicator&&a.setValueName(c.indicator)}else{if(e=="bar"){a.setData(f)}else{if(e=="area"){c&&c.indicator&&a.setValueName(c.indicator);a.setMapData(f)}else{if(e=="areapie"){c&&c.indicator&&a.setValueName(c.indicator);a.setMapData(f);a.setPieData(f,"value","label")}else{if(e=="linepie"){a.setLinebarData(f.line);a.setPieData(f.pie,"value","label");c.indicator&&a.setValueName&&a.setValueName(c.indicator)}else{if(e=="circle"){c&&c.indicator&&a.setValueName(c.indicator);a.setData(f)}else{a.setData(f)}}}}}}},_setStyle:function(m,d){var k=m.flashId,f=m.fields,h=m.units,j=m.type;var b=T.swf.getMovie(k);if(j=="line"){this._setLineStyle(b,h,f)}else{if(j=="bar"){this._setBarStyle(b,h,f)}else{if(j=="pie"){}else{if(j=="areapie"){b.setPieData(d,"value","label");b.setPieGradient(false);b.setPieColors([4767476,14898746,1682015,11060822,5328533,14833299,15312960,12369084,9721830,1360336]);b.setRadius(100);b.setHasTip(false);b.addEvent();b.setLineStyle(2913222,1,0.5);b.setShowLabel(false);b.setShowLabelLine(false);b.setlabelLineLength(0.1);b.showTopNum(3)}else{if(j=="linepie"){T.array.each(m.line.fields,function(i){T.array.remove(m.line.fields,i+"SmallTip")});h[0]&&b.setTick(" / "+h[0],"left");b.setDataSuffix("I,III","left");b.setAxisLineStyle(4681895,2);if(m.bar){b.addBarGraph(m.line.fields[1],"label")}for(var e=2,c=m.line.fields.length;e<c;e++){b.addLineGraph(m.line.fields[e],"label");b.setLineDot("3",m.line.fields[e])}var a=[4767476,14898746,1682015,11060822,5328533,14833299,15312960,12369084,9721830,1360336];var g;if(m.bar){g=[7368816].concat(a)}else{g=a}b.setLinebarColors(g);b.setSplitLine(0);b.setLinebarGradient(false);b.setShowDataTips(true);b.setShowBigDataTips(false);b.setPieGradient(false);b.setPieColors(a);b.setRadius(90);b.setHasTip(false);b.addEvent();b.setLineStyle(2913222,1,0.5);b.setShowLabel(false);b.setShowLabelLine(false);b.setlabelLineLength(0.1);b.showTopNum(3)}else{if(j=="circle"){b.setColors([4767476,14898746,1682015,11060822,5328533,14833299,15312960,12369084,9721830,1360336,12949082,2913222,3705647,16162851,10208838])}else{if(j=="circlegraph"){b.setTick("时长","left");b.setColors([4767476,14898746,1682015,11060822,5328533,14833299,15312960,12369084,9721830,1360336,12949082,2913222,3705647,16162851,10208838])}}}}}}}},_setLineStyle:function(b,c,a){T.array.each(a,function(d){T.array.remove(a,d+"BigTip")});b.setSplitLine(0);c=T.array.unique(c);b.addLineGraph(a[1],a[0]||"label");this._setUnit(b,c[0],"left");if(a.length>2){if(c.length>1){b.addLineGraph(a[2],a[0]||"label","bottom","right");this._setUnit(b,c[1],"right")}else{b.addLineGraph(a[2],a[0]||"label")}b.addLegend("0",a[1]);b.addLegend("0",a[2]);b.setLineDot("3",a[1]);b.setLineDot("3",a[2])}b.setAxisLineStyle(4681895,2);b.setColors([4767476,16370368,1682015,11060822,5328533,14833299,15312960,12369084,9721830,1360336,12949082,2913222,3705647,16162851,10208838]);b.setGradient(false);b.setShowDataTips(false);b.setShowBigDataTips(true)},_setBarStyle:function(b,c,a){b.setSplitLine(0);T.array.each(a,function(d){T.array.remove(a,d+"SmallTip")});c=T.array.unique(c);c[0]&&b.setTick(" / "+c[0],"left");this._setUnit(b,c[0],"left");b.addBarGraph(a[1],a[0]||"label");if(a.length>2){if(c.length>1){b.addBarGraph(a[2],a[0]||"label","bottom","right");c[1]&&b.setTick(" / "+c[1],"right");this._setUnit(b,c[1],"right")}else{b.addBarGraph(a[2],a[0]||"label")}b.setBarType("2",a[2]);b.addLegend("1",a[1],6710886);b.addLegend("2",a[2],6710886)}b.setAxisLineStyle(4681895,2);b.setColors([4767476,14898746,1682015,11060822,5328533,14833299,15312960,12369084,9721830,1360336,12949082,2913222,3705647,16162851,10208838]);b.setSplitLine(0);b.setGradient(false);b.setShowDataTips(true);b.setShowBigDataTips(false);b.setBarWidth(15)},_setUnit:function(a,b,c){var b=b||"";if(b){a.setTick(" / "+b,c)}switch(b){case"百分比":a.setDataSuffix("I%",c);break;case"时长":break;case"元":a.setDataSuffix("I.DD",c);break;default:a.setDataSuffix("I,III",c);break}},_setHighLightItem:function(b,c){if(!T.lang.isArray(c)||(c.length==0)){return false}var a=T.swf.getMovie(b);var d=[];T.each(c,function(f,e){d.push({index:f,color:14982543})});a.setHighLightItem(d)}});T.ui.FlashIndicator=T.createUI({options:{containerId:"FlashIndicator",onchange:function(a){},limit:Number.MAX_VALUE,items:null,selectedItems:null,defaultItems:null,indicatorContainerTempalte:'<div class="flash-indicator-container layer" id="FlashOptionContainer"><div id="FlashIndicatorContainer">#{0}</div>#{1}</div>',indicatorTextTemplate:'<div class="flash-indicator-wrapper">指标：<a id="FlashIndicatorBtn"><span class="flash-indicator-text trackable" memo="{id:\'flash_poin\'}" id="FlashIndicatorText">正在加载中...</span></a></div>',setDefaultTemplate:'<div id="FlashTip" class="text">(可同时选择<span id="MaxFlashIndicatorNum" class="max-flash-indicator-num">#{0}</span>项)</div>',indicatorTemplate:'<label for="#{0}"><input name="#{5}" id="#{0}" value="#{1}" type="#{3}" title="#{2}" #{4} />#{2}</label>',indicatorWrapperTemplate:'<div class="group clearfix">#{0}</div>',separatorTemplate:'<div class="separator"></div>'},_defaultItems:null,_defaultLimit:Number.MAX_VALUE,_groupItems:[],selectedItems:[],_init:function(){this.selectedItems=T.object.clone(this.options.selectedItems);var c=this;if(!T.lang.isArray(this.options.items)){return}for(var a in this.options.items){var b=this.options.items[a];if(this._groupItems[b.group]==null){this._groupItems[b.group]=[]}this._groupItems[b.group].push(b)}this._defaultLimit=this.options.limit;this._defaultItems=this.selectedItems},_type:"flash-indicator",showIndicatorContainer:function(){var a=this;return function(c){T.event.stop(c);var b=T.dom.one(".flash-indicator-wrapper"),d=T.dom.getPosition(b);T.setStyles("FlashOptionContainer",{left:d.left+"px",top:d.top+b.offsetHeight+"px",display:(T.getStyle("FlashOptionContainer","display")=="none")?"block":"none"});T.on(document,"mousedown",a.hideIndicatorContainer);T.on("FlashOptionContainer","click",function(f){T.event.stopPropagation(f)});T.dom.toggleClass(T.dom.one(".flash-indicator-wrapper"),"selected")}},hideIndicatorContainer:function(c){var b=T.event.getTarget(c),a=hasParent(b,".flash-indicator-container")||hasParent(b,".flash-indicator-wrapper");if(!a){T.hide("FlashOptionContainer");T.dom.removeClass(T.dom.one(".flash-indicator-wrapper"),"selected")}},showDefaultIndicatorContent:function(){this.options.limit=this._defaultLimit;this.showIndicatorContent(this._defaultItems)},showSingleIndicatorContent:function(){var a=this.selectedItems[0];this.options.limit=1;this.showIndicatorContent([a])},showIndicatorContent:function(j){var f=T.g("FlashIndicatorText");if(f){var b=[],d=[],g=j||this._defaultItems;this._set(g);for(var c=0,a=g.length;c<a;c++){var h=T.g(this.getId(g[c]));if(h){b.push(g[c]);d.push(T.getAttr(h,"title"))}}var e=T.g("MaxFlashIndicatorNum");if(e){e.innerHTML=e.innerHTML.replace(/\d/g,this.options.limit)}f.innerHTML=d.join("、")}},_set:function(c){if(!c){return}this._unCheckAll();for(var b=0,a=c.length;b<a;b++){var d=T.g(this.getId(c[b]));if(d){d.checked=true}}this.selectedItems=c},_unCheckAll:function(){var a=this;T.array.each(this.selectedItems,function(b){var c=T.g(a.getId(b));if(c){c.checked=false}});this.selectedItems=[]},_bind:function(){T.on(T.dom.one(".flash-indicator-wrapper"),"click",this.showIndicatorContainer());var a=this;T.array.each(T.dom.query(":input",T.g(this.options.containerId)),function(b,c){a.on(b,"click",function(f){var d=a.selectedItems;if(this.checked){d.push(this.value)}else{if(d.length==1){this.checked=true;return false}T.array.remove(d,this.value)}if(d.length>a.options.limit){var e=T.array.removeAt(d,0);T.g(a.getId(e)).checked=false}a.options.onchange(a.selectedItems)})})},_renderIndicators:function(){var c=[],f=[],a,d=(this.options.limit==1?"radio":"checkbox"),e=this;c.push(this.options.indicatorTextTemplate);for(var b in this._groupItems){var g=this._groupItems[b];a=[];T.array.each(g,function(h){a.push(T.format(this.options.indicatorTemplate,this.getId(h.id),h.id,h.label,d,(T.array.contains(this.selectedItems,h.id)?' checked="checked"':""),this.getId(this.options.containerId)))},this);f.push(T.format(this.options.indicatorWrapperTemplate,a.join("")));if(b!=this._groupItems.length-1){f.push(this.options.separatorTemplate)}}c.push(T.format(this.options.indicatorContainerTempalte,f.join(""),T.format(this.options.setDefaultTemplate,this.options.limit)));return c.join("")},render:function(){if(T.g(this.options.containerId)){T.insertHTML(this.options.containerId,"beforeEnd",this._renderIndicators());this.showIndicatorContent(this.selectedItems);this._bind()}}});baidu.ui.FuzzyQuery=T.createUI({_type:"fuzzy_query",options:{formId:"QueryForm",submitId:"QueryByWord",cancelId:"CancelQueryByWord",inputs:{SearchWord:null},onchange:function(a){}},_init:function(){},_bindEvents:function(){var b=this;T.on(this.options.formId,"submit",function(d){T.event.preventDefault(d);var f=true;for(var c in b.options.inputs){var e=T.trim(T.G(c).value);if(T.G(c).defaultValue==e||e==""){b.options.inputs[c]=null}else{b.options.inputs[c]=e;f=false}}if(f){T.hide(b.options.cancelId)}else{T.show(b.options.cancelId)}b.options.onchange(b.options.inputs)});T.on(this.options.cancelId,"click",function(){T.hide(this);for(var c in b.options.inputs){T.G(c).value=T.G(c).defaultValue;T.dom.addClass(c,"gray");b.options.inputs[c]=null}b.options.onchange(b.options.inputs)});for(var a in b.options.inputs){T.inlineTip(a)}},render:function(){T.insertHTML(this.options.submitId,"afterEnd",T.format('&nbsp;&nbsp;<a id="#{0}" style="display:none;" href="javascript:void(0);">返回</a>',this.options.cancelId));this._bindEvents()}});T.Guide=T.createClass({options:{template:'<div id="GuideTip" class="guide-tip" style="display:none"><div class="tip-arrow"></div><div class="close-tip open #{recordable}" memo="{id:\'GuideTipClose\',type:\'guide\',global:1}" layer="#GuideTip">X</div><div class="tip-content"><p>#{content}</p></div></div>',getNewFunctionList:{name:"getNewFunctionList",uri:"guide/getNewFunctionList"},newFunctionGuide:false,hasMarketAuth:false,onsuccess:function(a){},onclose:function(){}},_type:"guide",_init:function(){if(this.options.newFunctionGuide){this.getNewFunctionList()}var a=T.config.memo;if(this.options.hasMarketAuth&&(!a.hasOwnProperty("GuideTipClose")||a.GuideTipClose)){this.showTip("您已经开通百度精算权限！")}},showTip:function(d){if(T.g("GuideTip")){T.dom.remove("GuideTip")}T.insertHTML(document.body,"beforeEnd",T.format(this.options.template,{content:d,recordable:this.options.hasMarketAuth?"recordable":""}));var b=T.g("GuideTip"),a=T.dom.one(".market-link");if(a){T.show(b);var c=a.offsetWidth-b.offsetWidth;T.setRelatedPosition(b,a,"bl",{left:c,top:7});T.setStyle(T.dom.one("#GuideTip .tip-arrow"),"left",b.offsetWidth-a.offsetWidth/2)}},getNewFunctionList:function(){this.ajax(this.options.getNewFunctionList)},ongetNewFunctionListSuccess:function(a,b){this.show(b)},ajax:function(c,a){var b=this;a=a||{};b.dispatchEvent("on"+c.name);T.extend(a,{method:c.uri});T.ajax.jsonPost(T.config.systemConfig.ajaxUri,a,function(e,d){b.dispatchEvent("on"+c.name+"Success",e);b.options.onsuccess(e)},function(d){})},closeHandler:function(b,a){this.GuideSilder.stop();this.options.onclose()},show:function(c,b){this.GuideDialog=new T.ui.Dialog({titleText:"",content:AceTemplate.format("GuideTemplate",{items:c.items,type:"function"}),isModal:true,className:"guide-dialog",width:739,height:530});this.GuideDialog.show();this.GuideDialog.addEventListener("onclose",T.fn.bind(this.closeHandler,this));var a=c.items[0].images;this.GuideSilder=T.ui.create(T.ui.Slide,{containerId:"SlidesContainer",sliderId:"Slider",controlId:"SliderBtn",direction:"left",duration:35,pause:2000,width:700,height:430,auto:a.length>1?true:false,autoRender:true,items:a});this.GuideSilder.run(0)}});T.Indicator=T.createClass({options:{indicators:null,groups:[1,2]},_init:function(){var a=this;T.array.map(this.options.indicators,function(b){b.format=a._format()})},_format:function(){var a=this;return function(b){if(b==null){return""}if(!T.lang.isNumber(b)){return b}if(T.lang.isString(this.type)){switch(this.type){case"number":return T.i18n.number.format(b,T.i18n.currentLocale);case"ratio":return T.i18n.number.format(b,T.i18n.currentLocale)+"%";case"time":return T.i18n.number.formatTime(b);case"time2":return T.i18n.number.formatTime(b,2)}}return b}},map:function(a){var b=this;return T.array.map(a,function(c){return T.array.find(b.options.indicators,function(d){return c==d.id})})},index:function(a){return T.array.find(this.options.indexes,function(b){return a==b.id})},group:function(b){var a=[];T.array.each(this.options.groups,function(c){a.push(T.array.filter(b,function(d){return d&&d.group==c}))});return a}});baidu.ui.InputCombobox=T.createUI({_type:"input-combobox",options:{maxlength:40,label:"",inlineTip:true,disabled:false,selectable:true,readonly:false,containerId:null,items:null,selectedId:null,defaultText:"请输入",width:244,onchange:function(a){},comboboxTemplate:'#{6}<span class="input-combobox" id="#{1}"><input maxlength="#{4}" id="#{2}" class="custom-text" title="!{0}" value="!{0,20}" #{3} #{5}/>#{7}</span>',selectTemplate:'<span layer="##{0}" class="arrow operation" id="#{1}"></span>',itemTemplate:'<li><a title="!{0}" href="javascript:void(0)" data="#{1}" class="#{2}">!{0}</a></li>',wrapperTemplate:'<div class="layer bg-iframe" style="display:none;" id="#{1}"><ul class="input-combobox-list options" style="position:relative;width:#{2}px">#{0}</ul>'},_init:function(){this._selectedId=this.options.selectedId;this._items=this.options.items;this._defaultText=this.options.defaultText;this._comboboxId=this.getId();this._inputId=this.getId("Input");this._listId=this.getId("List");this._arrowId=this.getId("Arrow")},_selectedId:null,_items:null,_defaultText:null,_bindEvents:function(){var b=this;T.event.ons(T.dom.query("#"+this._listId+">ul>li>a"),"click",function(){var d=T.dom.getAttr(this,"data");var c=T.array.find(b._items,function(e){if(e.id==d){return true}});b.setCustomText(c.label);b._hide();b.options.onchange(d,c.label)});var a=T.dom.one(".operation",this._comboboxId);if(a){T.on(a,"click",function(){if(T.dom.hasClass(this,"combobox-disabled")){return}if(!T.dom.hasClass(a,"selected")){b._show()}})}},_show:function(){var a=T.getCornerPosition(this._comboboxId,"bl");T.dom.setPosition(this._listId,a)},_hide:function(){var a=T.dom.one(".operation",this._comboboxId);if(T.dom.hasClass(a,"selected")){T.dom.removeClass(a,"selected")}T.hide(this._listId)},_render:function(){var f=this._defaultText;if(this._items&&this._items.length>0){if(!f){f=this._items[0].label}if(this._selectedId){for(var b in this._items){var c=this._items[b];if(c.id==this._selectedId){f=c.label;break}}}}var a=T.format(this.options.selectTemplate,this._listId,this._arrowId);var e=T.format(this.options.comboboxTemplate,f,this._comboboxId,this._inputId,this.options.disabled?" disabled":"",this.options.maxlength,this.options.readonly?"readonly":"",this.options.label?'<label class="lbl">'+this.options.label+"</label>":"",this.options.selectable?a:"");T.dom.insertHTML(this.options.containerId,"beforeend",e);if(this._items){T.dom.removeClass(this._comboboxId,"combobox-disabled");var d=[];for(var b=0;b<this._items.length;b++){var c=this._items[b];d.push(T.format(this.options.itemTemplate,c.label,c.id,c.disabled?"disabled":""))}T.dom.insertHTML(document.body,"beforeend",T.format(this.options.wrapperTemplate,d.join(""),this._listId,this.options.width))}else{T.dom.addClass(this._comboboxId,"combobox-disabled")}},setCustomText:function(b){var a=T.g(this._inputId);this.clearInlineTip();if(a){a.value=T.format("#{0}",b);a.title=b}},render:function(b,a){if(!T.g(this.options.containerId)){return}if(b||b===null){this._items=b}if(a||a===null){this._selectedId=a}T.dom.empty(this.options.containerId);if(T.g(this._listId)){T.dom.remove(this._listId)}this._render();this._bindEvents();this.setInlineTip()},setInlineTip:function(){this.options.inlineTip&&T.inlineTip(this._inputId)},clearInlineTip:function(){this.options.inlineTip&&T.clearInlineTipInputValue(this._inputId)}});T.ui.Layer=T.createUI({_type:"layer",options:{containerId:null,handlerSelector:null,type:"mouseover",autoClose:true,relatedOther:false,relatedPosition:"br",closeButton:false,mouseoverTime:500,mouseoutTime:500,className:"",offset:{left:0,top:0},onchange:function(a){},containerTemplate:'<div id="#{0}" class="layer shared-layer #{2}" style="display:none;position:absolute;">#{1}<div id="#{0}Content" class="layer-content"></div></div>',closeTemplate:'<div class="layer-close">X</div>'},_containerId:null,_handlerSelector:null,_init:function(){this._containerId=this.options.containerId;this._handlerSelector=this.options.handlerSelector},_show:function(a){this.options.onchange(a);T.show(this._containerId);T.setRelatedPosition(this._containerId,a,this.options.relatedPosition,this.options.offset)},_bindClick:function(){var a=this;T.event.ons(T.dom.query(a._handlerSelector),"click",function(){a.options.onchange(this);if(!a.options.relatedOther){T.setRelatedPosition(a._containerId,this,a.options.relatedPosition,a.options.offset)}})},_bindMouseOver:function(){var a=null;var b=this;if(T.g(b._containerId)==null){b._render();T.on(b._containerId,"mouseover",function(){clearTimeout(a)});if(this.options.autoClose){T.on(b._containerId,"mouseout",function(){a=setTimeout(function(){b.close()},b.options.mouseoutTime)})}}T.event.ons(T.dom.query(b._handlerSelector),"mouseover",function(){var c=this;clearTimeout(a);if(b.options.mouseoverTime>0){a=setTimeout(function(){b._show(c)},b.options.mouseoverTime)}else{b._show(c)}});if(this.options.autoClose){T.event.ons(T.dom.query(b._handlerSelector),"mouseout",function(){clearTimeout(a);a=setTimeout(function(){b.close()},b.options.mouseoutTime)})}},_bindEvent:function(){var a=this.options.type;var b=this;if(a=="click"){if(T.g(b._containerId)==null){b._render()}this._bindClick()}else{if(a=="mouseover"){this._bindMouseOver()}else{if(a=="mouseover&click"||a=="click&mouseover"){this._bindMouseOver();this._bindClick()}}}if(this.options.closeButton){T.event.ons(T.q("layer-close",this._containerId),"click",function(){b.close()})}},_render:function(){T.dom.insertHTML(document.body,"beforeend",T.format(this.options.containerTemplate,this._containerId,this.options.closeButton?this.options.closeTemplate:"",this.options.className))},render:function(){this._bindEvent()},content:function(b,a){T.g(this._containerId+"Content").innerHTML=b;if(a){T.setRelatedPosition(this._containerId,a,this.options.relatedPosition,this.options.offset)}},setPosition:function(a){T.setRelatedPosition(this._containerId,a,this.options.relatedPosition,this.options.offset)},close:function(){T.hide(this._containerId)}});T.ui.Mask=T.createUI({options:{containerId:"GlobalModalLayer",zIndex:99998},_type:"mask",_init:function(){},render:function(){var a=T.g(this.options.containerId);if(!a){a=T.dom.create("div",{id:this.options.containerId,className:"mask-layer"});document.body.appendChild(a)}this._show();if(T.browser.ie&&T.browser.ie<7){T.dom.addClass(document.body,"body-masked")}this.bind()},bind:function(){var a=this;this.on(window,"resize",function(b){a._show()})},_show:function(){var b=T.g(this.options.containerId),a=this.options;T.dom.setStyles(b,{left:a.left||0,top:a.top||0,position:"absolute",width:a.width||T.page.getWidth(),height:a.height||T.page.getHeight(),"z-index":a.zIndex})},show:function(a){T.extend(this.options,a);this.render()},_hide:function(){var a=T.g(this.options.containerId);T.setStyles(a,{left:-30,top:-30,position:"absolute",width:1,height:1,overflow:"hidden"})},hide:function(){var a=T.g(this.options.containerId);if(a){this._hide(a)}this.dispose();if(T.browser.ie&&T.browser.ie<7){T.dom.removeClass(document.body,"body-masked")}}});T.ui.Operations=T.createUI({options:{template:'<div id="Operations" class="operations-panel layer shared-layer" style="display:none"><div class="tip-arrow"></div><div class="tip-content"><ul id="OperationItems"></ul></div></div>',itemTemplate:'<li><a target="#{3}" data="#{2}" class="#{2}" href="#{0}" layer="##{2}Layer">#{1}</a></li>',loadingTemplate:'<div class="loading">正在加载，请稍候……</div>',isSingleHistory:false},_allOperations:{history:{label:"查看历史趋势",target:"_blank",hrefTemplate:"#{baseUri}/trend/history?#{query}"},speed:{label:"对该URL进行速度诊断",target:"_blank",hrefTemplate:"#{baseUri}/opt/speed?#{query}"},area:{label:"查看按地域分布情况",target:"_blank",hrefTemplate:"#{baseUri}/pro/conn?viewType=area&flag=area&#{query}"},isp:{label:"查看按网络供应商分布情况",target:"_blank",hrefTemplate:"#{baseUri}/pro/conn?viewType=isp&flag=isp&#{query}"},word:{label:"查看相关热门搜索词",hrefTemplate:"javascript:void(0);",render:function(d,b){var a=["<tr><th class='order'>序号</th><th>搜索词</th><th>热门程度</th></tr>"];for(var c=0;c<b.length;c++){b[c].order=c+1;a.push(T.format("<tr><td class='order'>#{order}</td><td><div class='word'><a href='http://www.baidu.com/s?wd=#{gbkWord}' title='!{word}' target='_blank'>!{word}</a></div></td><td><div class='ratio' style='width:#{frequence}%'></div></td></tr>",b[c]))}if(b.length==0){a.push("<tr><td class='empty' colspan='3'>暂无数据</td></tr>")}return T.format("<div class='title'>查看与<span class='red'>&nbsp;&nbsp;!{0,30}&nbsp;&nbsp;</span>相关的热门搜索词</div><table>#{1}</table>",d,a.join(""))}},referer:{label:"查看入口页链接",hrefTemplate:"javascript:void(0);",render:function(d,b){var a=["<tr><th class='order'>排名</th><th>入口页链接<th></tr>"];for(var c=0;c<b.length;c++){a.push(T.format("<tr><td class='order'>#{0}</td><td><div class='link'><a href='!{1}' title='!{1}' target='_blank'>!{1}</a></div></td></tr>",c+1,b[c]))}if(b.length==0){a.push("<tr><td class='empty' colspan='2'>暂无数据</td></tr>")}return T.format("<div class='title'>查看以<span class='red'>&nbsp;&nbsp;!{0,30}&nbsp;&nbsp;</span>为来源的入口页面</div><table>#{1}</table>",d,a.join(""))}},refererDistribution:{label:"查看来源分布",hrefTemplate:"javascript:void(0);",render:function(k,h){var e="<div id='RefererDistributionTab'>                                <div class='rd-tabs'>                                    <ul class='clearfix'>                                        <li class='selected'><a class='clearfix' href='javascript:void(0);'>来源类型</a></li>                                        <li><a class='clearfix' href='javascript:void(0);'>来源URL</a></li>                                    </ul>                                </div>                                <div class='rd-tab-contents clearfix'>                                    <ul class='clearfix'>                                        <li class='rd-tab-type'>                                            <div>#{0}</div>                                        </li>                                        <li style='display: none;' class='rd-tab-url'>                                            <table>#{1}</table>                                        </li>                                    </ul>                                </div>                            </div>",a="<div class='rd-tab-type-row clearfix'><div class='refer-dis-type'>#{0}</div><div class='refer-dis-type-base'><div style='width:#{1}%'>#{1}%</div></div></div>",b="<tr class='source-url-row'><td class='source-url'><div class='link'><a href='!{0}' title='!{0}' target='_blank'>!{0}</a></div></td><td class='source-number number'><div class='td-content'>#{1}</div></td><td class='number'><div class='td-content'>#{2}</div></td></tr>",g=[],f=["<tr><th class='source-url'>来源URL  TOP10</th><th class='source-number number'>来源次数</th><th class='number'>带来浏览量</th></tr>"];for(var d=0;d<h.items.length;d++){for(var c=0;c<h.items[d].length;c++){if(d===0){g.push(T.format(a,h.items[d][c][0].type,h.items[d][c][0].value))}if(d===1){f.push(T.format(b,h.items[d][c][0],T.i18n.number.formatNumber(h.items[d][c][1]),T.i18n.number.formatNumber(h.items[d][c][2])))}}if(h.items[d].length==0){d==0&&g.push("暂无数据");d==1&&f.push("<tr><td class='empty' colspan='3'>暂无数据</td></tr>")}}return T.format(e,g.join(""),f.join(""))},bindEvents:function(){new T.ui.Tabs({containerId:"RefererDistributionTab",selectedIndex:0,tabsSelector:">.rd-tabs>ul>li:not(.separator)",toggleSelector:">.rd-tabs>.toggle",contentsSelector:">.rd-tab-contents>ul>li",contentContainerSelector:">.rd-tab-contents",tabContainerSelector:">.rd-tabs>ul"})}},record:{label:"查看站点索引情况",target:"_blank",hrefTemplate:"#{source_engine_url}!{site_domain}"},index:{label:"查看百度指数",target:"_blank",hrefTemplate:"http://index.baidu.com/main/word.php?word=#{word}"},engine:{label:"查看搜索来路URL",hrefTemplate:"javascript:void(0);",render:function(d,b){var a=["<tr><th class='order'>次数</th><th>搜索链接</th><th>第几页</th></tr>"];for(var c=0;c<b.length;c++){b[c].order=c+1;a.push(T.format("<tr><td class='order'>#{count}</td><td><div class='link'><a href='!{url}' title='!{url}' target='_blank'>!{url}</a></link></td><td>#{page}</td></tr>",b[c]))}if(b.length==0){a.push("<tr><td class='empty' colspan='3'>暂无数据</td></tr>")}return T.format("<div class='title'>查看<span class='red'>&nbsp;&nbsp;!{0,30}&nbsp;&nbsp;</span>的搜索来路URL</div><table>#{1}</table>",d,a.join(""))}}},_type:"operations",_data:null,_contentType:null,_element:null,_renderItems:function(c,f){var e=[];this._data=f;for(var d=0;d<c.length;d++){var b=c[d];b.siteId=T.config.siteInfo.id;var g={webRoot:T.config.systemConfig.webRoot,baseUri:T.config.systemConfig.baseUri,source_engine_url:b.source_engine_url,userId:T.config.userInfo.id,query:T.param(b)};if(b.id=="index"){g.word=b.word}if(b.id=="record"){if(g.source_engine_url=="www.baidu.com/s?wd="){g.site_domain="";g.source_engine_url=T.config.systemConfig.baseUri+"/opt/indexes?siteId="+T.config.siteInfo.id}else{g.site_domain="site:"+T.config.siteInfo.name;g.source_engine_url="http://"+g.source_engine_url}}var a=T.format(this._allOperations[b.id].hrefTemplate,g);e.push(T.format(this.options.itemTemplate,a,this._allOperations[b.id].label,b.id,this._allOperations[b.id].target||""))}return e.join("")},_bindEvents:function(b){var d=this;for(var c=0;c<b.length;c++){var a=b[c];if(!this[a.id]&&this._allOperations[a.id].target!="_blank"){(function(e){d[e]=new T.ui.Layer({containerId:e+"Layer",type:"click",closeButton:true,relatedOther:true,className:e+"-layer",handlerSelector:"#Operations ."+e,onchange:function(f){d._contentType=e;d[e].setPosition(d._element);d.loading();d.options.onchange(d._contentType,d._data)}})})(a.id)}if(this._allOperations[a.id].target!="_blank"){this[a.id].render()}}},show:function(c,b,d){if(this.options.isSingleHistory&&b[0]&&b[0].id=="history"){var e=b[0];e.siteId=T.config.siteInfo.id;var a=T.format("#{0}/trend/history?#{1}",T.config.systemConfig.baseUri,T.param(e));window.open(a)}else{this._element=c;if(!T.g("Operations")){T.insertHTML(document.body,"beforeEnd",this.options.template)}T.dom.empty("OperationItems");T.dom.insertHTML("OperationItems","beforeEnd",this._renderItems(b,d));T.dom.setPosition("Operations",T.getCornerPosition(c,"br"));this._bindEvents(b)}},content:function(b,a){this[this._contentType].content(this._allOperations[this._contentType].render(b,a));this._allOperations[this._contentType].bindEvents&&this._allOperations[this._contentType].bindEvents()},loading:function(){T.hide("Operations");this[this._contentType].content(this.options.loadingTemplate)}});T.RecordTarget=T.createClass({_type:"record-target",options:{sign:"recordable",recordUri:null,memo:null,onchange:function(a){}},_memo:null,_init:function(){this.options.recordUri=this.options.recordUri||T.config.systemConfig.memoUri;this._memo=T.object.clone(this.options.memo||{});T.on(document.body,"mousedown",T.fn.bind(this.reordHandler,this))},reordHandler:function(a,e){var g=T.event.getTarget(a);if(!(g[this.options.sign]||T.dom.hasClass(g,this.options.sign))){return}var f=g.id||"",i=T.getAttr(g,"memo"),h,b;if(i){memoObj=T.json.parse(i);if(memoObj.hasOwnProperty("id")){f=memoObj.id}if(memoObj.hasOwnProperty("type")){h=memoObj.type}if(memoObj.hasOwnProperty("global")){b=memoObj.global}}var d={elementId:f,type:h||""};if(!b){T.extend(d,{siteId:T.config.siteInfo.id,pageId:T.config.pageInfo.id})}var c;if(this._memo.hasOwnProperty(f)){if(this._memo[f]){c=0}else{c=1}}else{if(T.dom.hasClass(g,"close")){c=1}else{if(T.dom.hasClass(g,"open")){c=0}}}this._memo[f]=c;d.status=c;this.options.onchange(d);this.postData(d)},postData:function(c){var b=(new Date()).getTime();var a=window["bd_holmes"+b]=new Image();a.src=this.options.recordUri+"?r="+b+"&"+T.url.jsonToQuery(c,function(e,d){return encodeURIComponent(e)});a.onload=a.onerror=a.onabort=function(){a.onload=a.onerror=a.onabort=null;a=null}}});T.ui.SelectGroup=T.createUI({_type:"select_group",options:{containerId:null,isDynamicChildren:false,label:"",items:[],selectedItems:[],separator:"",shortcuts:true,wrapperTemplate:'<span id="#{1}_container">#{0}<select id="#{1}" level="#{3}">#{2}</select></span>',optionTemplate:'<option value="!{0}"#{2}>!{1}</option>',onchange:function(a){}},_showLevel:1,_values:null,_init:function(){this._values=[]},_getData:function(e,g,b,f){if(f>b){return null}for(var c in e){var d=e[c];if(b==f&&d.id==g){return d}else{var a=this._getData(d.children,g,b,f+1);if(a!=null){return a}}}return null},_select:function(e,d){var b=this._getData(this.items,e,d,1);if(b==null){return}var c=d+1;for(var a=c;a<=this._showLevel;a++){T.dom.remove(this.getId()+"_"+a+"_container")}this._values.splice(d-1,this._values.length-d+1);this._values[d-1]=e;if(b&&b.children&&b.children.length>0){this._showLevel=c;this._values[d]=b.children[0].id;this._render(b.children,d)}else{this._showLevel=d}},_getLabels:function(d){var e=[];var a=this.items;for(var c=0;c<d.length;c++){if(a==null||a.length==0){break}for(var b in a){if(d[c]==a[b].id){e.push(a[b].label);a=a[b].children;break}}}return e},_change:function(c,b){var a=this.options.isDynamicChildren;if(!a){this._select(c,b)}else{this._syncDynamicItemStatus(c,b)}if(this._values.length==1&&this._values[0]==this.items[0].id){if(!a){this.options.onchange(T.object.clone(this._values),[])}else{this.options.onchange(T.object.clone(this._values),[],c,b)}}else{if(!a){this.options.onchange(T.object.clone(this._values),this._getLabels(this._values))}else{this.options.onchange(T.object.clone(this._values),this._getLabels(this._values),c,b)}}},_render:function(a,g){if(a){var e="";for(var c in a){var f=a[c];e+=T.format(this.options.optionTemplate,f.id,f.label,f.id==this.options.selectedItems[g||0]?' selected="selected"':"")}var b=this.getId()+"_"+this._showLevel;if(T.g(this.getId("search_shotcuts_container"))){T.insertHTML(this.getId("search_shotcuts_container"),"beforeBegin",T.format(this.options.wrapperTemplate,(this._showLevel==1&&this.options.label?'<label class="label">'+this.options.label+"</label>":this.options.separator),b,e,this._showLevel))}else{T.insertHTML(this.options.containerId,"beforeEnd",T.format(this.options.wrapperTemplate,(this._showLevel==1&&this.options.label?'<label class="label">'+this.options.label+"</label>":this.options.separator),b,e,this._showLevel))}var d=this;T.on(b,"change",function(){d._change(this.value,parseInt(T.getAttr(this,"level")))})}},_getShortcuts:function(a,d){for(var b in a){var c=a[b];if(c.shortcut){if(d==null){c.allId=c.id}else{c.allId=""+d+","+c.id}this._shortcuts.push(c)}if(c.children&&c.children.length>0){if(d==null){this._getShortcuts(c.children,c.id)}else{this._getShortcuts(c.children,""+d+","+c.id)}}}},_rendShortcuts:function(){this._getShortcuts(this.items);if(this._shortcuts.length==0){return}var b="";for(var c in this._shortcuts){var a=this._shortcuts[c];b+=T.format('<a href="javascript:void(0)" id="#{0}" data="#{1}">#{2}</a>',this.getId("search_shotcuts_"+a.id),a.allId,a.label)}T.insertHTML(this.options.containerId,"beforeEnd",T.format('<span id="#{0}" class="search-shotcuts-container">#{1}</span>',this.getId("search_shotcuts_container"),b));var d=this;for(var c in this._shortcuts){var a=this._shortcuts[c];T.on(this.getId("search_shotcuts_"+a.id),"click",function(){d.options.onchange([T.getAttr(this,"data")],[this.innerHTML])})}},render:function(a){if(!T.g(this.options.containerId)){return}if(a){this.items=a;T.dom.empty(this.options.containerId)}this._render(this.items);if(this.options.shortcuts){this._shortcuts=[];this._rendShortcuts()}if(this.options.selectedItems){for(var b=0;b<this.options.selectedItems.length;b++){var c=this.options.selectedItems[b];this._select(c,b+1)}}this.options.selectedItems=[]},disable:function(){for(var a=1;a<=this._showLevel;a++){T.g(this.getId()+"_"+a).disabled=true}},enable:function(){for(var a=1;a<=this._showLevel;a++){T.g(this.getId()+"_"+a).disabled=false}},select:function(a){T.g(this.getId()+"_"+this._showLevel).value=a},getGroupId:function(a){return this.getId()+"_"+a},reset:function(){this._select(this.items[0].id,1);this.select(this.items[0].id);this.options.onchange([],[])},getSelectedLabels:function(){return this._getLabels(this._values)},_syncDynamicItemStatus:function(e,d){var a=e==-1?false:true;var c=d+1;for(var b=c;b<=this._showLevel;b++){if(T.g(this.getId()+"_"+b+"_container")){T.dom.remove(this.getId()+"_"+b+"_container")}}this._values.splice(d-1,this._values.length-d+1);this._values[d-1]=e;this._showLevel=a?c:d},renderDynamicItems:function(f,h,g){var b=h==-1?false:true;if(b){if(f.length==0){this._showLevel=g}else{var a=this.items;var e=this._values;for(var d=0;d<e.length;d++){for(var c=0;c<a.length;c++){if(a==null||a.length==0){break}if(a[c].id==e[d]){if(!a[c].children||a[c].children.length==0){a[c].children=f;break}else{a=a[c].children}}}}this._values[g]=f[0].id;this._render(f,g)}}}});var SelectTimeGroup=function(k,j,i){var h=this;h.st=k;h.et=j;var i=i||6;var e=T.g("Hour");var b=T.g("Day");var d=T.g("FlashMonth");var c=T.g("FlashWeek");var a=T.g("FlashDay");var g=function(){if(b.checked){a.disabled=false;if((h.et-h.st)>(1000*3600*24*7)){c.disabled=false;if((h.et-h.st)>(1000*3600*24*31)){d.disabled=false}else{d.disabled=true}}else{c.disabled=true;d.disabled=true}}else{c.disabled=true;d.disabled=true;a.disabled=true}};h.onchange=function(){};h.setGran=function(l,n,m){h.st=l;h.et=n;switch(m){case 6:e.checked=true;break;case 5:b.checked=true;a.checked=true;break;case 4:b.checked=true;c.checked=true;break;case 3:b.checked=true;d.checked=true;break;default:e.checked=true}g();h.onchange(m)};var f=function(){h.setGran(h.st,h.et,i)};f();T.each(T.dom.query(".time-select input"),function(l){T.on(l,"click",function(o){g();var n=T.dom.query(".first-gran input:checked")[0];if(n==T.g("Hour")){h.onchange(6)}else{var m=T.dom.query(".second-gran input:checked")[0];if(m==T.g("FlashMonth")){h.onchange(3)}else{if(m==T.g("FlashWeek")){h.onchange(4)}else{if(m==T.g("FlashDay")){h.onchange(5)}}}}})})};T.ui.SendReport=T.createUI({_type:"send-report",options:{trigerId:null,reportTitle:null,reportId:null,siteId:null,reportTypes:["html","csv"],url:null,onchange:function(a){},wrapperTemplate:'<div class="send-report-wrapper"><div class="send-report-title">#{title}</div><div class="send-report-items">文件类型：#{types}<div id="#{tipId}" class="send-report-tip">#{typeTip}</div>发送周期：#{durations}<br/>发送时间：#{times}<br/>邮箱地址：#{mail}</div><div id="#{sendTipId}" class="red" style="display: none;"></div><div class="send-report-buttons"><a class="button" id="#{sendReportId}" href="javascript:void(0)"><span>确定</span></a><a id="#{cancelId}" href="javascript:void(0)">取消</a></div></div>',typeTemplate:'<label for="#{0}" title="#{2}"><input type="radio" title="#{2}" data="#{4}" id="#{0}"#{3} name="send__report"/>#{1}</label>',types:[{id:"html",label:"HTML",title:"本格式图文并茂，支持数据量较少，体积小便于下载阅读。"},{id:"csv",label:"CSV",title:"本格式不含图示，支持较大量数据，便于后期数据处理。"}],durationTemplate:'<label for="#{0}"><input type="radio" data="#{3}" id="#{0}"#{2} name="send__duration"/>#{1}</label>',durations:[{id:"day",label:"每天"},{id:"week",label:"每周一"},{id:"month",label:"每月一号"}],mailTemplate:'<input type="text" class="text send-report-mail" style="ime-mode:disabled" id="#{0}" ><div class="send-report-tip"> 多个邮箱请用分号隔开。</div>'},_downloadType:null,_renderHTML:function(){var d=[];for(var c in this.options.types){var e=this.options.types[c];if(T.array.contains(this.options.reportTypes,e.id)){d.push(T.format(this.options.typeTemplate,this.getId(e.id),e.label,e.title,c==0?' checked="checked"':"",e.id))}}var b=[];for(var c in this.options.durations){var f=this.options.durations[c];b.push(T.format(this.options.durationTemplate,this.getId(f.id),f.label,c==0?' checked="checked"':"",f.id))}var h=[];var a=(new Date()).getHours();if(a>8&&a<22){a=a+1}else{a=8}for(var c=8;c<=23;c++){h.push(T.format('<option value="#{0}" #{1}>#{0}</option>',""+(c<10?"0"+c:c)+":00",c==a?' selected="selected"':""))}var g=this.options.types[0].title;this._downloadType=this.options.reportTypes[0];this._duration=this.options.durations[0].id;return T.format(this.options.wrapperTemplate,{title:(this.options.reportTitle||"发送报告"),types:d.join(""),typeTip:g,durations:b.join(""),times:T.format('<select id="#{0}">#{1}</select>',this.getId("Time"),h.join("")),tipId:this.getId("Tip"),sendTipId:this.getId("SendTip"),mail:T.format(this.options.mailTemplate,this.getId("Mail")),sendReportId:this.getId("Send"),cancelId:this.getId("Cancel")})},_bindEvents:function(){var c=this;for(var b in this.options.reportTypes){var a=this.options.reportTypes[b];T.on(this.getId(a),"click",function(){T.g(c.getId("Tip")).innerHTML=this.title;c._downloadType=T.dom.getAttr(this,"data")})}for(var b in this.options.durations){var d=this.options.durations[b];T.on(this.getId(d.id),"click",function(){c._duration=T.dom.getAttr(this,"data")})}T.on(this.getId("Send"),"click",function(){if(T.dom.hasClass(this,"disabled")){return}var j=T.g(c.getId("Mail"));var g=j.value.replace("；",";");var f=g.split(";");var h=f.length;if(h>20){alert("最多可输入20个电子邮件地址！")}for(var e=0;e<h;e++){if(baidu.trim(f[e])==""){alert("您输入的第"+(e+1)+"个电子邮件地址为空，请重新填写！");return false}if(!T.lang.isEmail(f[e])){alert("您输入的第"+(e+1)+"个电子邮件地址有误，请重新填写！");return false}}c.options.onchange({format:c._downloadType,duration:c._duration,time:T.g(c.getId("Time")).value,mails:T.trim(T.g(c.getId("Mail")).value)});T.dom.addClass(this,"disabled")});T.on(this.getId("Cancel"),"click",function(){c.dialog.close()})},_renderDialog:function(){this.dialog=new T.ui.Dialog({id:this.getId("Dialog"),titleText:"发送报告",content:this._renderHTML(),isModal:true,isSingle:true,width:400});this._bindEvents()},render:function(){if(T.g(this.options.trigerId)==null){return}var a=this;T.on(this.options.trigerId,"click",function(){if(!a.dialog){a._renderDialog()}T.hide(a.getId("SendTip"));T.dom.removeClass(a.getId("Send"),"disabled");a.dialog.show()})},send:function(b){var c={method:this.options.method,reportId:this.options.reportId,format:this._downloadType,duration:this._duration,time:T.g(this.getId("Time")).value,mails:T.trim(T.g(this.getId("Mail")).value),siteId:this.options.siteId,params:T.param(b)};var a=this;T.ajax.jsonPost(this.options.url,c,function(d){T.show(a.getId("SendTip"));T.g(a.getId("SendTip")).innerHTML=d;T.dom.removeClass(a.getId("Send"),"disabled")},function(d){alert(d||"发送数据失败请稍后重试！");T.dom.removeClass(a.getId("Send"),"disabled")})}});T.SetRecommendReports=T.createClass({options:{containerId:"RecommendReportsContent"},_selectedItems:null,_init:function(){var a=T.dom.query(":input",T.g(this.options.containerId));this._selectedItems=[];T.array.each(a,function(b){if(b.checked){this._selectedItems.push(b.value)}},this);this._changeStatus(T.config.pageInfo.recommendReports);this.bind()},_changeStatus:function(a){if(a.length===0){if(T.g("RecommendReportBlank")){T.show("RecommendReportBlank")}}else{if(T.g("RecommendReportBlank")){T.hide("RecommendReportBlank")}}},_setRecommendDefaultStatus:function(){if(!T.config.pageInfo.defaultRecommendReports){return}var b=T.object.clone(T.config.pageInfo.defaultRecommendReports).sort().join();var a=T.object.clone(this._selectedItems).sort().join();if(b===a){T.addClass("RecommendReportsDefault","selected")}else{T.removeClass("RecommendReportsDefault","selected")}},_clickHandler:function(c,a){if(a.checked){this._selectedItems.push(a.value)}else{T.array.remove(this._selectedItems,a.value)}if(this._selectedItems.length>4){var b=T.array.removeAt(this._selectedItems,0);T.g("RecommendReport"+b).checked=false}this._setRecommendDefaultStatus()},_setDefaultRecommendReports:function(d,b){var a=T.dom.query(":input",T.g(this.options.containerId));T.dom.addClass(b,"selected");T.array.empty(this._selectedItems);if(!T.config.pageInfo.defaultRecommendReports){return}var c=this;T.array.each(a,function(e){if(T.array.contains(T.config.pageInfo.defaultRecommendReports,e.value)){e.checked=true;c._selectedItems.push(e.value)}else{e.checked=false}})},_confirmHandler:function(a,e){T.hide("RecommendReportsBox");var i=T.g("RecommendReports");var c,f=[];if(i){T.array.each(this._selectedItems,function(j){c=T.array.find(T.config.pageInfo.recommendReportList,function(k){if(k.children&&k.children.length!==0){c=T.array.find(k.children,function(l){return l.id==j});if(c){f.push(c);return false}else{return false}}else{return k.id==j}});if(c){f.push(c)}});var d=[];var g=T.config.pageInfo.menuId;T.array.each(f,function(j,k){d.push(T.format('<a #{4} #{2} href="#{0}">#{1}</a>#{3}',j.uri,j.label,g==j.id?' class="selected"':"",k!=f.length-1?"|":"",j.target!="_self"?' target="_blank"':""))})}var b={method:"guide/setRecommendReportList",id:this._selectedItems.join()},h=this;T.ajax.jsonPost(T.config.systemConfig.ajaxUri,b,function(k,j){T.dom.empty("RecommendReports");T.dom.insertHTML("RecommendReports","beforeEnd",d.join(""));h._changeStatus(f)})},bind:function(){var a=T.dom.query(":input",T.g(this.options.containerId));T.event.ons(a,"click",T.fn.bind(this._clickHandler,this));var d=T.g("RecommendReportsDefault");if(d){this._setRecommendDefaultStatus();T.on(d,"click",T.fn.bind(this._setDefaultRecommendReports,this))}var b=T.dom.one(".recommend-reports-operations .confirm");if(b){T.on(b,"click",T.fn.bind(this._confirmHandler,this))}var c=T.dom.one(".recommend-reports-operations .cancel");if(c){T.on(c,"click",function(f,e){T.hide("RecommendReportsBox")})}}});T.ShortDate=T.createClass({options:{containerId:"DateSelectBar",onchange:function(){}},_init:function(){var a=T.g(this.options.containerId).getElementsByTagName("A");for(var b=0,c=a.length;b<c;b++){T.on(a[b],"click",this._selectHandler())}},_selectHandler:function(){var a=this;return function(d){T.event.preventDefault(d);a.removeClass();T.dom.addClass(this,"cur");var g=this.href.lastIndexOf("#")+1;var b=parseInt(this.href.substring(g),10);if(b!=0){var c=(b==-1)?-1:b;var f=(b==-1)?-1:0;a.options.onchange([a._recentDate(c),a._recentDate(f)],b)}else{a.options.onchange([T.config.systemConfig.now,+T.config.systemConfig.now],b)}}},removeClass:function(){var a=T.g(this.options.containerId).getElementsByTagName("A");for(var b=0,c=a.length;b<c;b++){T.removeClass(a[b],"cur")}},_dateDiff:function(b,a){return parseInt(Math.abs(b-a)/1000/60/60/24)},_recentDate:function(a){return parseInt(T.config.systemConfig.now,10)+a*3600*24*1000},showDateTip:function(c,g){var b=baidu.G("Date");var f=baidu.date.format;var a=f(new Date(c),"yyyy/MM/dd");var e=f(new Date(g),"yyyy/MM/dd");var d=(a==e)?a:(a+"~"+e);if(b){b.innerHTML="("+d+")"}T.dom.one(".report-help")&&(T.dom.setStyle(T.dom.one(".tip-arrow"),"left",(T.dom.one(".report-help").offsetLeft+2)+"px"))}});T.ui.SiteSelector=T.createUI({_type:"siteselector",options:{containerId:"SiteListContainer",siteListId:"SiteList",siteList:null,siteId:null,defaultSiteId:"",subdirHoverClass:"sub-dir-hover",subdirTemplate:'<ul class="site-selector-subdir" style="display: none" id="#{1}">#{0}</ul>',subdirLiTemplate:'<li><a class="dir" href="#{0}" title="!{6}">!{1}#{5}</a><a href="javascript:void(0)" data="#{2}" class="set-default #{3}" title="#{4}"></a></li>',subdirWithAuth:'<span class="auth">(权限子目录)</span>',settings:{isDefault:{title:"取消默认网站",className:"is-default"},isNotDefault:{title:"设为默认网站",className:"is-not-default"}}},_container:null,_init:function(){this._container=T.g(this.options.containerId);this._initSubDirs.call(this)},_initSubDirs:function(){for(var c=0;c<this.options.siteList.length;c++){var m=this.options.siteList[c],f=[];if(m.children){for(var d in m.children){var h="javascript:window.location = window.location.href.replace(/siteId=(\\d*)/,'siteId="+m.children[d].id+"')",b=m.children[d].name,a=m.children[d].id,g=m.children[d].id==this.options.defaultSiteId?this.options.settings.isDefault.className:this.options.settings.isNotDefault.className,k=m.children[d].id==this.options.defaultSiteId?this.options.settings.isDefault.title:this.options.settings.isNotDefault.title,l=m.children[d].isAuth?this.options.subdirWithAuth:"",e=m.children[d].isAuth?b+"(权限网站)":b;f.push(T.format(this.options.subdirLiTemplate,h,b,a,g,k,l,e))}if(f.length!==0){f=T.format(this.options.subdirTemplate,f.join(""),m.id+"SubDir");T.dom.insertHTML(this._container,"beforeEnd",f)}}}this._bindSubDirEvent.call(this)},_bindEvent:function(){T.event.ons(T.dom.query("li",T.g(this.options.siteListId)),"mouseover",T.fn.bind(this._toggleSubDir,this));T.event.ons(T.dom.query(".arrow, div.text",this._container),"click",T.fn.bind(this._toggleSiteList,this));T.event.on(document,"click",T.fn.bind(this._hideSiteList,this));T.event.on(this._container,"click",T.fn.bind(this._setDefault,this));T.event.on(T.g("SetCurrentDefaultSite"),"click",T.fn.bind(this._setDefaultSiteForCurrentSite,this))},_bindSubDirEvent:function(){var a=T.dom.query(".site-selector-subdir>li");T.event.ons(a,"mouseover",function(c){var d=T.event.getTarget(c),b=T.dom.getAncestorByClass(d,"site-selector-subdir");T.element(T.dom.query("li",b)).each(function(f){T.dom.removeClass(f,"sub-dir-hover")});T.dom.addClass(this,"sub-dir-hover")});T.event.ons(a,"mouseout",function(){T.dom.removeClass(this,"sub-dir-hover")})},_toggleSubDir:function(f){T.event.stopPropagation(f);var d=T.event.getTarget(f),a=d.tagName=="LI"?d:T.dom.getAncestorByTag(d,"li"),b=T.dom.last(a),g=T.dom.getAttr(b,"data");T.dom.query("li",T.g(this.options.siteListId))&&T.element(T.dom.query("li",T.g(this.options.siteListId))).each(function(h){T.dom.removeClass(this,"hover")});T.dom.addClass(a,"hover");T.dom.query(".site-selector-subdir")&&T.element(T.dom.query(".site-selector-subdir")).each(function(h){T.dom.hide(h)});if(T.g(g+"SubDir")){var c=T.g(g+"SubDir");T.dom.addClass(T.dom.query("li",c)[0],this.options.subdirHoverClass);T.dom.show(c)}},_toggleSiteList:function(a){T.dom.toggle(T.g(this.options.siteListId));T.dom.query(".site-selector-subdir")&&T.element(T.dom.query(".site-selector-subdir")).each(function(b){T.dom.hide(b)});T.dom.query("li",T.g(this.options.siteListId))&&T.element(T.dom.query("li",T.g(this.options.siteListId))).each(function(b){T.dom.removeClass(this,"hover")})},_hideSiteList:function(c){T.event.stopPropagation(c);var b=T.event.getTarget(c),a=T.dom.getAncestorByClass(b,"site-selector");if(!a){T.dom.hide(T.g(this.options.siteListId));T.dom.query(".site-selector-subdir")&&T.element(T.dom.query(".site-selector-subdir")).each(function(d){T.dom.hide(d)})}},_setDefaultSiteForCurrentSite:function(d){T.event.stopPropagation(d);var c=T.event.getTarget(d);if(T.dom.hasClass(c,"set-default")){var a=T.dom.one(T.format("#SiteListContainer li>a.set-default[data=#{0}]",this.options.siteId));if(T.dom.hasClass(c,"is-default")){T.dom.removeClass(c,"is-default");T.dom.addClass(c,"is-not-default");this.title="设为默认网站";T.dom.removeClass(a,"is-default");T.dom.addClass(a,"is-not-default");a.title="设为默认网站";T.ajax.jsonPost(T.config.systemConfig.ajaxUri,{method:"home/user/setDefaultSite",sId:0})}else{var b=T.dom.one("#SiteListContainer li>a.is-default");if(b){T.dom.removeClass(b,"is-default");T.dom.addClass(b,"is-not-default");b.title="设为默认网站"}T.dom.removeClass(c,"is-not-default");T.dom.addClass(c,"is-default");this.title="取消默认网站";T.dom.removeClass(a,"is-not-default");T.dom.addClass(a,"is-default");a.title="取消默认网站";T.ajax.jsonPost(T.config.systemConfig.ajaxUri,{method:"home/user/setDefaultSite",sId:this.options.siteId})}}},_setDefault:function(b){T.event.stopPropagation(b);var a=T.event.getTarget(b);if(T.dom.hasClass(a,"set-default")&&a.id!="SetCurrentDefaultSite"){if(T.dom.hasClass(a,"is-default")){this._switchDefaultStatus.call(this,a,true)}else{this._switchDefaultStatus.call(this,a,false)}}},_switchDefaultStatus:function(c,d){var e=T.dom.getAttr(c,"data"),a=T.g("SetCurrentDefaultSite");if(d){T.dom.removeClass(c,"is-default");T.dom.addClass(c,"is-not-default");c.title="设为默认网站";if(e==T.dom.getAttr(a,"data")){T.dom.removeClass(a,"is-default");T.dom.addClass(a,"is-not-default");a.title="设为默认网站"}T.ajax.jsonPost(T.config.systemConfig.ajaxUri,{method:"home/user/setDefaultSite",sId:0})}else{var b=T.dom.one("#SiteListContainer li>a.is-default");if(b){T.dom.removeClass(b,"is-default");T.dom.addClass(b,"is-not-default");b.title="设为默认网站"}T.dom.removeClass(c,"is-not-default");T.dom.addClass(c,"is-default");c.title="取消默认网站";if(e==T.dom.getAttr(a,"data")){T.dom.removeClass(a,"is-not-default");T.dom.addClass(a,"is-default");a.title="取消默认网站"}else{T.dom.removeClass(a,"is-default");T.dom.addClass(a,"is-not-default");a.title="设为默认网站"}T.ajax.jsonPost(T.config.systemConfig.ajaxUri,{method:"home/user/setDefaultSite",sId:e})}},render:function(){this._bindEvent()}});T.ui.Slide=T.createUI({options:{containerId:"SlidesContainer",sliderId:"Slider",controlId:"SilderBtn",controlTemplate:"<ul>#{0}</ul>",sliderTemplate:'<table cellspacing="0" cellpadding="0" border="0" id="SliderTable"><tbody><tr>#{0}</tr></tbody></table>',items:null,count:null,width:680,height:355,direction:"left",auto:false,change:0,duration:35,time:10,pause:2000,tween:null,onStart:function(){},onFinish:function(){}},_type:"slide",items:null,auto:null,_slider:null,_container:null,_sliderControl:null,_timer:null,_count:null,_target:null,_t:null,_b:null,_c:null,index:0,_init:function(){this._slider=T.g(this.options.sliderId);this._container=T.g(this.options.containerId);this._sliderControl=T.g(this.options.controlId);this._timer=null;this._target=0;this._t=this._b=this._c=0;this.auto=this.options.auto;this.index=0;this.options.tween=this.options.tween||function(f,e,h,g){return -h*((f=f/g-1)*f*f*f-1)+e};var a=T.dom.getStyle(this._container,"position");if(!(a=="relative"||a=="absolute")){this._container.style.position="relative"}this.items=T.object.clone(this.options.items);this.count=this.options.count||this.items.length;this._container.style.overflow="hidden";this._slider.style.position="absolute"},renderHtml:function(){if(this._slider){var c=[];for(var d=0,b=this.count;d<b;d++){if(typeof this.items[d]==="object"&&this.items[d]["imgUrl"]&&this.items[d]["link"]){c.push(T.format("<td><a href='#{3}' target='_blank'><img width = '#{1}' height='#{2}' src='#{0}' /></a></td>",this.items[d]["imgUrl"],this.options.width,this.options.height,this.items[d]["link"]))}else{c.push(T.format("<td><img width = '#{1}' height='#{2}' src='#{0}' /></td>",this.items[d],this.options.width,this.options.height))}}T.dom.empty(this._slider);T.dom.insertHTML(this._slider,"beforeEnd",T.format(this.options.sliderTemplate,c.join("")));var a=this.options.direction=="left"?false:true;this._change=this.options.change?this.options.change:this._slider[a?"offsetHeight":"offsetWidth"]/this.count}if(this._sliderControl){T.dom.empty(this._sliderControl);if(this.count!=1){var e=[];for(var d=0,b=this.count;d<b;d++){e.push("<li></li>")}T.dom.insertHTML(this._sliderControl,"beforeEnd",T.format(this.options.controlTemplate,e.join("")))}}},render:function(a){this.renderHtml();this.bind()},bind:function(){if(this._sliderControl){var a=this._sliderControl.getElementsByTagName("li");var b=this;T.array.each(a,function(d,c){T.on(d,"mouseover",function(f,e){d.className="on";b.auto=false;b.run(c)});T.event.on(d,"mouseout",function(f,e){d.className="";b.auto=true;b.run()})})}},run:function(a){if(a==this.count){if(this.options.direction=="left"){if(T.g("SliderTable")){var e=T.g("SliderTable").rows[0];e.appendChild(e.children[0].cloneNode(true))}}else{var d=baidu.g("users_logos");if(d){for(var c=0;c<5;c++){var b=d.children[c].cloneNode(true);d.appendChild(b)}}}}if(a==undefined){a=this.index}else{if(a<0){a=this.count-1}else{if(a>this.count){a=0}}}this.index=a;this._target=-Math.abs(this._change)*this.index;this._t=0;this._b=parseInt(T.dom.getStyle(this._slider,this.options.direction));this._c=this._target-this._b;this.start();this.move()},start:function(){var c=this;var c=this;var a=T.g(this.options.controlId);if(a){var b=a.getElementsByTagName("li");T.array.each(b,function(e,d){e.className=c.index%c.count==d?"on":""})}this.options.onStart.call(this)},move:function(){clearTimeout(this._timer);if(this._c&&this._t<this.options.duration){this.moveTo(Math.round(this.options.tween(this._t++,this._b,this._c,this.options.duration)));this._timer=setTimeout(baidu.fn.bind(this.move,this),this.options.time)}else{if(this.index==this.count){this.moveTo(0);if(this.options.direction=="left"){if(T.g("SliderTable")){var c=baidu.g("SliderTable").rows[0];c.removeChild(c.children[c.cells.length-1])}}else{var b=baidu.g("users_logos");if(b){for(var a=0;a<5;a++){var d=b.children[b.children.length-1];b.removeChild(d)}}}}else{this.moveTo(this._target)}if(this.auto){this._timer=setTimeout(T.fn.bind(this.next,this),this.options.pause)}}},moveTo:function(a){T.setStyle(this._slider,this.options.direction,a+"px")},next:function(){this.run(++this.index)},previous:function(){this.run(--this.index)},stop:function(){clearTimeout(this._timer);this.options.onFinish.call(this);this.moveTo(this._target)}});T.ui.Summary=T.createUI({_type:"summary",options:{containerId:null,tdTemplate:'<td#{last}><span class="text">#{text}<a href="javascript:void(0)" data="#{id}" class="help">&nbsp;</a></span><br/><span class="value">#{value}</span>#{compare}</td>',compareDataTemplate:'<br/><span class="compare-value">#{0}</span>',tableTemplate:'<table class="summary"><tbody><tr>#{0}</tr></tbody></table>',lastClass:' class="last"'},_render:function(e,b){var d=[];var a=(e[1]&&e[1].length>0);for(var c in b){var g=b[c];var f=(c==b.length-1?this.options.lastClass:"");if(a){d.push(T.format(this.options.tdTemplate,{id:g.id,text:g.label,value:e[0][c],compare:T.format(this.options.compareDataTemplate,e[1][c]),last:f}))}else{d.push(T.format(this.options.tdTemplate,{id:g.id,text:g.label,value:e[0][c],last:f}))}}return T.format(this.options.tableTemplate,d.join(""))},render:function(b,a){if(!T.g(this.options.containerId)){return}T.dom.empty(this.options.containerId);T.insertHTML(this.options.containerId,"beforeend",this._render(b,a))}});T.ui.Table=T.createUI({_type:"table",options:{containerId:null,showNumber:true,multilevel:false,hasOperations:false,order:null,onchange:function(a){},onexpand:function(a){},onoperate:function(a){},loadingText:'<div class="loading">正在加载，请稍候……</div>',noDataText:'<div class="empty">暂无数据</div>',sumText:"当页汇总",className:"table",thStyleFn:null,thTextFn:null,thTemplate:'<td data="#{id}" class="#{className}"><div class="td-content">#{label}</div></td>',theadTemplate:"<thead>#{0}</thead>",tdStyleFn:null,tdTextFn:null,tdTemplate:'<td colspan="#{colspan}" class="#{className}" data="#{data}" id="#{id}"><div class="td-content">#{label}</div></td>',operationTdTemplate:'<td colspan="#{colspan}" class="#{className}" id="#{id}"><div class="td-content" data="#{data}" title="#{title}" layer="#Operations">#{label}</div></td>',tbodyTemplate:"<tbody>#{0}</tbody>",tfootTemplate:"<tfoot>#{0}</tfoot>",trTemplate:'<tr class="#{1}" id="#{2}">#{0}</tr>',tableTemplate:'<table class="#{2}">#{0}#{1}#{3}</table>',tipTemplate:'<tbody><tr><td colspan="#{colspan}">#{tip}</td></tr></tbody>'},_thead:null,_tbody:null,_tfoot:null,_group:1,_sortField:null,_offset:null,_sortDir:null,_expandTrId:null,_continuous:false,_init:function(){this.syncSortBehavior.call(this,this.options.order)},_renderLoading:function(){return T.format(this.options.tableTemplate,this._renderThead(),this._renderTipBody(this.options.loadingText),this.options.className)},_renderTable:function(){if(this._tbody==null||this._tbody.length==0){return T.format(this.options.tableTemplate,this._renderThead(),this._renderTipBody(this.options.noDataText),this.options.className)}else{return T.format(this.options.tableTemplate,this._renderThead(),this._renderTbody(),this.options.className,this._renderTfoot())}},_renderThead:function(){var a=[];if(this._thead&&this._thead.length>0){this._prefixTds(a,-1,false,"&nbsp;");for(var b in this._thead){var c=this._thead[b];if(c.sortable){c.className+=" sortable"}if(c.id==this._sortField){c.className+=" "+this._sortDir}a.push(T.format(this.options.thTemplate,c));if(b==0&&this.options.hasOperations){if(this.options.hasOperations.isSingleOperation){a.push(T.format(this.options.thTemplate,{className:"operateCol singleOptrate",label:"&nbsp;"}))}else{a.push(T.format(this.options.thTemplate,{className:"operateCol",label:"&nbsp;"}))}}}}else{a.push(T.format(this.options.thTemplate,{label:"&nbsp;"}))}return T.format(this.options.theadTemplate,T.format(this.options.trTemplate,a.join("")))},_renderTipBody:function(a){var b=1;if(this._thead&&this._thead.length>0){b=this._thead.length;if(this.options.showNumber){b++}if(this.options.multilevel){b++}if(this.options.hasOperations){b++}}return T.format(this.options.tipTemplate,{colspan:b,tip:a})},_renderTbody:function(){var a=[];for(var f=0;f<this._tbody.length/this._group;f++){for(var e=0;e<this._group;e++){var h=this._tbody[f*this._group+e];var d=h[0].expandable==false?false:true;var b=h[0].hasOperation==false?false:true;var g=[];if(e==0){this._prefixTds(g,f,d,f+1+this._offset)}else{this._prefixTds(g,f,d)}for(var c in h){g.push(T.format(this.options.tdTemplate,h[c]));if(c==0&&this.options.hasOperations){if(this.options.hasOperations&&b&&e==0){if(this.options.hasOperations.isSingleOperation){g.push(T.format(this.options.operationTdTemplate,{className:"operateCol singleOptrate",label:"&nbsp;",data:f,title:"查看历史趋势"}))}else{g.push(T.format(this.options.operationTdTemplate,{className:"operateCol",label:"&nbsp;",data:f}))}}else{g.push(T.format(this.options.tdTemplate,{className:"",label:"&nbsp;",data:f}))}}}if(this._group==e+1){a.push(T.format(this.options.trTemplate,g.join(""),"line",this._getRowId(f)))}else{a.push(T.format(this.options.trTemplate,g.join("")))}}}return T.format(this.options.tbodyTemplate,a.join(""))},_prefixTds:function(b,d,a,c){if(this.options.multilevel){b.push(T.format(this.options.tdTemplate,{id:"expand_"+(this._getRowId(d)||""),className:(a&&c!=null)?"expandCol":"noexpandCol",data:d!=null?d:"",label:"&nbsp;"}))}if(this.options.showNumber){b.push(T.format(this.options.tdTemplate,{className:"numberCol",label:c||"&nbsp;"}))}},_renderTfoot:function(){var a=[];for(var d=0;d<this._tfoot.length;d=(++d)*this._group){for(var c=0;c<this._group;c++){var f=this._tfoot[d+c];var e=[];this._prefixTds(e,-1,true,"&nbsp;");for(var b in f){e.push(T.format(this.options.tdTemplate,f[b]));if(b==0&&this.options.hasOperations){if(this.options.hasOperations.isSingleOperation){e.push(T.format(this.options.tdTemplate,{className:"operateCol singleOptrate",label:"&nbsp;"}))}else{e.push(T.format(this.options.tdTemplate,{className:"operateCol",label:"&nbsp;"}))}}}a.push(T.format(this.options.trTemplate,e.join("")))}}return T.format(this.options.tfootTemplate,a.join(""))},_renderTdStyle:function(b){var a=b.type||"";if(T.lang.isFunction(this.options.tdStyleFn)){a=this.options.tdStyleFn(a,b)}return a},_renderThText:function(a){var b=a.label;if(T.lang.isFunction(this.options.thTextFn)){return this.options.thTextFn(b,a)}return b},_renderTdText:function(a,c){var b=c.format?c.format(a):a;if(T.lang.isFunction(this.options.tdTextFn)){return this.options.tdTextFn(b,field,a)}return b},_sort:function(b,d){var a="desc";d=d.parentNode;var c=T.getAttr(d,"data");if(c==this._sortField&&this._sortDir=="desc"){a="asc"}this._sortField=c;this._sortDir=a;this.loading();this.options.onchange(c+","+a)},_expand:function(a,c){T.dom.toggleClass(c,"open");var d=parseInt(T.getAttr(c,"data"),10);var b=this._getRowId(d);if(T.dom.hasClass(c,"open")){if(T.dom.hasClass(c,"loaded")){T.each(T.dom.query("tr."+b),function(e){T.show(e)})}else{T.dom.addClass(c,"mini-loading");this.options.onexpand({target:c,expandTrId:b,rowIndex:d,data:T.object.clone(this._tbody[d*this._group][0].data)})}}else{T.each(T.dom.query("tr."+b),function(e){T.hide(e)})}},_operate:function(a,b){var c=parseInt(T.getAttr(b,"data"),10);this.options.onoperate({target:b,rowIndex:c,data:T.object.clone(this._tbody[c*this._group][0].data)})},_bindEvent:function(){T.event.ons(T.dom.query(T.format("##{0} thead .sortable .td-content",this.options.containerId)),"click",T.fn.bind(this._sort,this));T.event.ons(T.dom.query(T.format("##{0} tbody .expandCol",this.options.containerId)),"click",T.fn.bind(this._expand,this));T.event.ons(T.dom.query(T.format("##{0} tbody .operateCol .td-content",this.options.containerId)),"click",T.fn.bind(this._operate,this))},render:function(a){if(!T.g(this.options.containerId)){return}this._thead=a.thead;this._tbody=a.tbody;this._tfoot=a.tfoot;this._group=a.group;this._offset=a.offset||0;this._expandTrId=null;if(a.end==0){this._continuous=true}else{this._continuous=false}T.dom.empty(this.options.containerId);T.dom.insertHTML(this.options.containerId,"beforeend",this._renderTable());this._bindEvent()},_renderSubBody:function(g,f){var a=[];for(var d=0;d<g.length;d++){var h=g[d];var e=[];this._prefixTds(e);var b=h[0].hasOperation==false?false:true;for(var c in h){e.push(T.format(this.options.tdTemplate,h[c]));if(c==0&&this.options.hasOperations){if(this.options.hasOperations&&b){if(this.options.hasOperations.isSingleOperation){e.push(T.format(this.options.operationTdTemplate,{className:"operateCol singleOptrate",label:"&nbsp;",data:d,title:"查看历史趋势"}))}else{e.push(T.format(this.options.operationTdTemplate,{className:"operateCol",label:"&nbsp;",data:d}))}}else{e.push(T.format(this.options.tdTemplate,{className:"",label:"&nbsp;",data:d}))}}}a.push(T.format(this.options.trTemplate,e.join(""),"sub-line "+f))}return a.join("")},_getRowId:function(a){return this.getId("tr_"+a)},renderSub:function(c,d){var b=d.expandTrId;if(T.dom.hasClass("expand_"+b,"loaded")){return}T.dom.addClass("expand_"+b,"loaded");T.dom.removeClass("expand_"+b,"mini-loading");T.each(T.dom.query("#"+this.options.containerId+" ."+b),function(e){T.dom.remove(e)});T.dom.insertHTML(b,"afterend",this._renderSubBody(c,b));var a=this;T.event.ons(T.dom.query("#"+this.options.containerId+" ."+b+" .operateCol .td-content"),"click",function(){var e=parseInt(T.getAttr(this,"data"),10);a.options.onoperate({target:this,rowIndex:e,data:T.object.clone(c[e][0].data)})})},loading:function(){if(!this._continuous){T.dom.empty(this.options.containerId);T.dom.insertHTML(this.options.containerId,"beforeend",this._renderLoading())}},syncSortBehavior:function(b){if(b){var c=b.split(","),a=T.string.trim;this._sortField=a(c[0]);this._sortDir=a(c[1])}}});T.ui.TableIndicator=T.createUI({options:{containerId:null,items:null,groupNames:null,selected:null,limit:6,defaultSelected:null,onchange:function(a){},shortcutsTemplate:'<div class="shortcuts"><em class="gray r">提示：可同时选择<em class="red"> #{1} </em>项</em><a href="javascript:void(0)" id="#{0}">系统默认指标</a></div>',buttonsTemplate:'<div class="buttons"><a id="#{0}" class="button" href="javascript:void(0)"><span>确定</span></a></div>',groupNameTemplate:'<label class="groupName">#{0}:</label>',indicatorTemplate:'<label for="#{0}"><input type="checkbox" title="#{2}" value="#{1}" id="#{0}">#{2}</label>',indicatorWrapperTemplate:'<div class="group clearfix">#{0}</div>',separatorTemplate:'<div class="separator #{0}"></div>'},_init:function(){if(!T.lang.isArray(this.options.items)){return}for(var a in this.options.items){var b=this.options.items[a];this._allIds.push(b.id);if(this._groupItems[b.group]==null){this._groupItems[b.group]=[]}this._groupItems[b.group].push(b)}},_polymericGroup:1,_type:"table-indicator",_groupItems:[],_allIds:[],_selected:[],_tempSelected:[],_change:function(){this._selected=T.object.clone(this._tempSelected);this.options.onchange(this._selected)},_cancel:function(){this._tempSelected=T.object.clone(this._selected);for(var a in this._allIds){var c=this._allIds[a];var b=T.g(this.getId(c));if(T.array.contains(this._selected,c)){b.checked=true}else{b.checked=false}}this._highlightShortcut()},_highlightShortcut:function(){T.removeClass(this.getId("Default"),"selected");if(this._tempSelected.length==this.options.defaultSelected.length){var a=true;for(var b in this._tempSelected){if(!T.array.contains(this.options.defaultSelected,this._tempSelected[b])){a=false;break}}if(a){T.addClass(this.getId("Default"),"selected")}}},_selectItems:function(b){for(var a in this._allIds){var d=this._allIds[a];var c=T.g(this.getId(d));if(T.array.contains(b,d)){c.checked=true}else{c.checked=false}}},_clickOne:function(b){var c=T.event.get(b).target;if(c.value!=null){var d=c.value;if(c.checked==true){this._tempSelected.push(d);if(this._tempSelected.length>this.options.limit){var d=this._tempSelected.shift();var a=T.g(this.getId(d));if(a){a.checked=false}}}else{if(this._tempSelected.length==1){c.checked=true;return}T.array.remove(this._tempSelected,d)}this._highlightShortcut()}},_selectDefault:function(){this._tempSelected=T.object.clone(this.options.defaultSelected);this._selectItems(this._tempSelected);this._highlightShortcut()},setSelected:function(a){this._selected=T.object.clone(a);this._tempSelected=T.object.clone(a);this._selectItems(this._tempSelected);this._highlightShortcut()},_initSelected:function(){this._selected=T.object.clone(this.options.selected);this._tempSelected=T.object.clone(this.options.selected);this._selectItems(this._tempSelected);this._highlightShortcut()},_renderIndicators:function(){var e=[];e.push(T.format(this.options.shortcutsTemplate,this.getId("Default"),this.options.limit));for(var d in this._groupItems){var h=[];var a=this._groupItems[d];h.push(T.format(this.options.groupNameTemplate,this.options.groupNames[d].title));h.push("<div style='overflow:hidden;'>");for(var b in a){var g=a[b];h.push(T.format(this.options.indicatorTemplate,this.getId(g.id),g.id,g.label))}h.push("</div>");e.push(T.format(this.options.indicatorWrapperTemplate,h.join("")));if(d!=this._groupItems.length-1){var c=this._polymericGroup;var f=this.options.groupNames[+d+1];if(f){c=f.polymericGroup}e.push(T.format(this.options.separatorTemplate,c==this._polymericGroup?"":"separator-dashed"));this._polymericGroup=c}}e.push(T.format(this.options.buttonsTemplate,this.getId("Ok")));return e.join("")},_bindEvents:function(){T.on(this.getId("Default"),"click",T.fn.bind(this._selectDefault,this));T.on(this.getId("Ok"),"click",T.fn.bind(this._change,this));T.on(this.options.containerId,"click",T.fn.bind(this._clickOne,this))},render:function(){if(!T.g(this.options.containerId)){return}T.insertHTML(this.options.containerId,"beforeend",this._renderIndicators());T.dom.addClass(this.options.containerId,"table-indicator");this._bindEvents();this._initSelected()}});T.ui.Tabs=T.createUI({_type:"tabs",options:{containerId:null,tabsSelector:">.tabs>ul>li:not(.separator)",toggleSelector:">.tabs>.toggle",contentsSelector:">.tab-contents>ul>li",contentContainerSelector:">.tab-contents",tabContainerSelector:">.tabs>ul",eventType:"click",selectedClass:"selected",selectedIndex:null,onchange:function(a,b){}},_currentIndex:null,_tabs:null,_toggle:null,_contents:null,_tabContainer:null,_contentContainer:null,_init:function(){if(!T.g(this.options.containerId)){return}var c=this;this._tabs=T.dom.query("#"+this.options.containerId+this.options.tabsSelector);this._contents=T.dom.query("#"+this.options.containerId+this.options.contentsSelector);var b=T.dom.query("#"+this.options.containerId+this.options.toggleSelector);if(b&&b.length>0){this._toggle=b[0]}var d=T.dom.query("#"+this.options.containerId+this.options.contentContainerSelector);if(d&&d.length>0){this._contentContainer=d[0]}var a=T.dom.query("#"+this.options.containerId+this.options.tabContainerSelector);if(a&&a.length>0){this._tabContainer=a[0]}T.each(this._tabs,function(f,e){T.on(T.dom.one("a",f),c.options.eventType,function(g){c._change(e,this.parentNode)})});if(this._toggle){T.on(this._toggle,"click",T.fn.bind(this._toggleFn,this))}if(this.options.selectedIndex!=null){this._change(this.options.selectedIndex,this._tabs[this.options.selectedIndex],false);this._currentIndex=this.options.selectedIndex}},_change:function(a,b,c){if(c!==false){c=true}if(a==this._currentIndex){this._toggleFn();return false}else{this._unselect(this._currentIndex);this._currentIndex=a;this.open()}this.options.onchange(a,b,c)},_unselect:function(a){if(a==null){return}var c=this._tabs[a];T.removeClass(c,this.options.selectedClass);var b=T.dom.next(c);if(b&&T.dom.hasClass(b,"separator")){T.dom.show(b)}var d=T.dom.prev(c);if(d&&T.dom.hasClass(d,"separator")){T.dom.show(d)}if(this._contents&&this._contents.length>0){T.hide(this._contents[this._currentIndex])}},_select:function(a){var c=this._tabs[a];T.addClass(this._tabContainer,this.options.selectedClass);T.addClass(c,this.options.selectedClass);var b=T.dom.next(c);if(b&&T.dom.hasClass(b,"separator")){T.dom.hide(b)}var d=T.dom.prev(c);if(d&&T.dom.hasClass(d,"separator")){T.dom.hide(d)}if(this._contents&&this._contents.length>0){T.show(this._contents[a])}},open:function(){if(this._contentContainer&&this._toggle){this._toggle.innerHTML="收起";T.dom.removeClass(this._toggle,"close");T.dom.addClass(this._toggle,"open");T.show(this._contentContainer)}if(this._currentIndex==null){this._currentIndex=0}if(this._tabs[this._currentIndex].style.display=="none"){for(var a in this._tabs){if(a!=this._currentIndex&&this._tabs[a].style.display!="none"){this._currentIndex=a;break}}}this._select(this._currentIndex)},close:function(){if(this._contentContainer&&this._toggle){T.dom.removeClass(this._toggle,"open");this._toggle.innerHTML="展开";T.dom.addClass(this._toggle,"close");T.hide(this._contentContainer)}T.removeClass(this._tabContainer,this.options.selectedClass);this._unselect(this._currentIndex)},_toggleFn:function(){if(this._toggle){if(T.dom.hasClass(this._toggle,"open")){this.close()}else{this.open()}}this.options.onchange(this._currentIndex,this._tabs[this._currentIndex],true)},select:function(a){this._unselect(this._currentIndex);this._currentIndex=a;this.open();this.options.onchange(a,this._tabs[a],false)},reset:function(){T.removeClass(this._currentIndex,this.options.selectedClass);this._currentIndex=null},hide:function(a){var c=this._tabs[a];T.dom.hide(c);if(a==0){var b=T.dom.next(c);if(b&&T.dom.hasClass(b,"separator")){T.addClass(b,"invisible-separator")}}else{var d=T.dom.prev(c);if(d&&T.dom.hasClass(d,"separator")){T.addClass(d,"invisible-separator")}}if(a==this._currentIndex||this._currentIndex==null){this.close()}},show:function(a){var c=this._tabs[a];T.dom.show(c);if(a==0){var b=T.dom.next(c);if(b&&T.dom.hasClass(b,"separator")){T.removeClass(b,"invisible-separator")}}else{var d=T.dom.prev(c);if(d&&T.dom.hasClass(d,"separator")){T.removeClass(d,"invisible-separator")}}},getCurrentContent:function(){return this._contents[this._currentIndex]}});T.TimeSpan=T.createClass({options:{byHourId:"ByHour",byDayId:"ByDay",ByWeekId:"ByWeek",ByMonthId:"ByMonth",contianerId:"TimeSpan",gran:6,day:1000*3600*24,onchange:function(a){}},_granLinks:null,_init:function(){var b={"3":this.options.ByMonthId,"4":this.options.ByWeekId,"5":this.options.byDayId,"6":this.options.byHourId},a=b[this.options.gran];this._granLinks=T.dom.query("#"+this.options.contianerId+" a");this._addActiveClass(a!==undefined?a:this.options.byHourId);this.reset(T.config.pageInfo.st,T.config.pageInfo.et);this.bind()},reset:function(a,e){var c=T.g(this.options.ByMonthId),f=T.g(this.options.ByWeekId),d=T.g(this.options.byDayId),b=T.g(this.options.byHourId);T.dom.addClass(f,"disable");T.dom.addClass(c,"disable");if((e-a)>(this.options.day*7)){T.dom.removeClass(f,"disable");if((e-a)>(this.options.day*31)){T.dom.removeClass(c,"disable")}}},_addActiveClass:function(a){T.element(this._granLinks).each(function(b){T.removeClass(b,"selected")});T.addClass(a,"selected")},bind:function(){var a=this;T.event.ons(this._granLinks,"click",function(c,b){var d=T.event.getTarget(c);if(!T.dom.hasClass(d,"disable")){a._addActiveClass(d);a.options.onchange(T.dom.getAttr(d,"data"))}})}});T.ui.Tip=T.createUI({options:{target:document.body,tip:null,position:null},_type:"tip",_init:function(){this.position=this.options.position||T.dom.getPosition(this.target);if(T.lang.isElement(this.target)){var c=T.ui.Tip.targetsTips.length;if(c===0){T.ui.Tip.targetsTips.push(this)}else{var b=false;for(var a=0;a<T.ui.Tip.targetsTips.length;a++){if(T.ui.Tip.targetsTips[a].target===this.target){T.ui.Tip.targetsTips[a]=this;b=true;break}else{b=false}}if(!b){T.ui.Tip.targetsTips.push(this)}}}},getTargetPosition:function(){return T.dom.getPosition(this.target)},render:function(){if(this.getTargetPosition().left+275>=T.page.getViewWidth()){T.dom.setPosition(this.tip,{left:T.page.getViewWidth()-275,top:this.getTargetPosition().top+this.target.offsetHeight});var b=T.q("tip-arrow",this.tip)[0];var a=this.getTargetPosition().left+275-T.page.getViewWidth();T.dom.setStyle(b,"left",12+a)}else{var b=T.q("tip-arrow",this.tip)[0];T.dom.setPosition(this.tip,{left:this.getTargetPosition().left,top:this.getTargetPosition().top+this.target.offsetHeight});T.dom.setStyle(b,"left",12)}document.body.appendChild(this.tip);T.fn.bgIframe(T.dom.q("tip-container"))}});T.ui.Tip.targetsTips=[];T.ui.Tip.close=function(){T.element(".tip-container").each(function(a){T.dom.remove(a)})};T.ui.Tip.bindEvent=function(){T.event.on(document,"click",function(h){var h=h||window.event;var g=T.event.getTarget(h);var d=false;var f=T.ui.Tip.targetsTips;for(var c=0;c<f.length;c++){if(f[c].target===g){T.ui.Tip.close();f[c].render();d=true||d}else{d=false||d}}if(!d&&!hasParent(g,".help")&&!hasParent(g,".tip-container")){T.ui.Tip.close()}});var a,b;T.event.on(document,"mouseover",function(d){var d=d||window.event;var c=T.event.getTarget(d);var f=c;if(T.q("tip-container").length>0){if(hasParent(f,".help")||hasParent(f,".tip-container")){clearTimeout(a)}else{clearTimeout(a);a=setTimeout(function(){T.ui.Tip.close()},500)}}if(hasParent(f,".help")){clearTimeout(b);b=setTimeout(function(){var g=false;var h=T.ui.Tip.targetsTips;for(var e=0;e<h.length;e++){if(h[e].target===f){T.ui.Tip.close();h[e].render();g=true||g}else{g=false||g}}if(!g){T.ui.Tip.close()}},500)}else{clearTimeout(b)}})};T.ui.Tip.loadTips=function(){T.ui.Tip.targetsTips=[];var f=T.q("help");for(var b=0;b<f.length;b++){var c=T.dom.hasAttr(f[b],"data");if(!c){if(T.config.pageInfo.tip){var d=T.dom.create("div",{style:"position: absolute;"});d.className="tip-container";d.innerHTML='<div style="zoom: 1;position: relative; left:-13px;" class="tip-div tip-theme report-theme"><div class="tip-arrow"></div><div class="tip-wrap"><div class="tip-head"><div class="tip-head-text">'+T.config.pageInfo.title+'</div><div class="tip-close" onclick="T.ui.Tip.close()">×</div></div><div class="tip-body"><table class="tip-table"><tbody class="tip-table-body"><tr class="tip-row"><th class="tip-title">含义：</th><th class="tip-content">'+T.config.pageInfo.tip.title+'</th></tr><tr class="tip-row"><th class="tip-title">作用：</th><th class="tip-content">'+T.config.pageInfo.tip.content+"</th></tr></tbody></table></div></div></div>";new T.ui.Tip({target:f[b],tip:d})}}else{if(T.config.indexInfo.indicators){var g=T.dom.getAttr(f[b],"data");var e=T.config.indexInfo.indicators.concat(T.config.indexInfo.indexes);for(var a=0;a<e.length;a++){if(e[a].tip){if(e[a].id===g){var d=T.dom.create("div",{style:"position: absolute;"});d.className="tip-container";d.innerHTML='<div style="zoom: 1;position: relative; left:-12px;" class="tip-div tip-theme indicator-theme"><div class="tip-arrow"></div><div class="tip-wrap">'+e[a].tip+"</div></div>";new T.ui.Tip({target:f[b],tip:d})}}}}}}};T.ToggleTarget=T.createClass({_type:"toggle-target",options:{sign:"toggleable",onchange:function(a){},smoothExpandableElements:[".report-tip"],memo:null},_memo:null,_init:function(){this._memo=T.object.clone(this.options.memo||{});this._initStatus();T.on(document.body,"click",T.fn.bind(this.toggleHandler,this))},_initStatus:function(){T.each(T.dom.q("recordable"),function(e){var c=e.id||"",b=T.getAttr(e,"memo");if(b){memoObj=T.json.parse(b);if(memoObj.hasOwnProperty("id")){c=memoObj.id}}if(!this._memo.hasOwnProperty(c)){return}var a;T.removeClass(e,"open");T.removeClass(e,"close");if(this._memo[c]){a=true;T.addClass(e,"open")}else{a=false;T.addClass(e,"close")}var d=T.getAttr(e,"targets");if(d){T.each(T.dom.query(d),function(f){if(a){T.removeClass(f,"toggleable-hidden")}else{T.addClass(f,"toggleable-hidden")}});if(d.indexOf(".flash-text")!=-1){if(a){T.addClass(T.dom.one(".flash-text"),"toggleable-hidden")}else{T.removeClass(T.dom.one(".flash-text"),"toggleable-hidden")}}}},this)},toggleHandler:function(d,b){var e=T.event.getTarget(d);if(!(e[this.options.sign]||T.dom.hasClass(e,this.options.sign))){return}var a=T.getAttr(e,"targets");var c=this;T.each(T.dom.query(a),function(g,f){T.dom.toggleClass(g,"toggleable-hidden")});T.dom.toggleClass(e,"open");T.dom.toggleClass(e,"close");this.options.onchange(e.id)}});T.TrackTarget=T.createClass({options:{sign:"trackable",onchange:function(a){},trackUri:null},_type:"track-target",_init:function(){this.options.trackUrl=this.options.trackUri||T.config.systemConfig.trackUri;T.on(document.body,"mousedown",T.fn.bind(this.trackHandler,this))},_getTrackTarget:function(a){var b=T.event.getTarget(a);if(!(b[this.options.sign]||T.dom.hasClass(b,this.options.sign))){b=T.dom.getAncestorByClass(b,this.options.sign)}return b},trackHandler:function(e,d){var g=this._getTrackTarget(e);if(!g){return}var c=g.id||"",b=T.getAttr(g,"memo");if(b){memoObj=T.json.parse(b);if(memoObj.hasOwnProperty("id")){c=memoObj.id}}var f={siteId:T.config.siteInfo.id,pageId:T.config.pageInfo.id,elementId:c};var a=T.getAttr(g,"href");if(a&&!(/^javascript|#/.test(a))){f.url=encodeURIComponent(a)}if(g.innerHTML&&!(/^\s*</i.test(g.innerHTML))&&!(/>\s*$/i.test(g.innerHTML))){f.value=T.i18n.string.trim(g.innerHTML)}this.options.onchange(f);this.postData(f)},postData:function(c){var b=(new Date()).getTime();var a=window["bd_holmes"+b]=new Image();a.src=this.options.trackUrl+"?r="+b+"&"+T.url.jsonToQuery(c,function(e,d){return encodeURIComponent(e)});a.onload=a.onerror=a.onabort=function(){a.onload=a.onerror=a.onabort=null;a=null}}});T.Webpage=function(a){T.extend(this,{components:[],on:function(c,b){EventRouter.register(c,b)},fire:function(b){EventRouter.dispatch.apply(EventRouter,arguments)},_init:function(){T.extend(this,this.options);EventRouter.setOwner(this);T.extend(this,T.config);this.fire("onbeforeInit");this.initComponents(this.components);this._initDataAdapter({id:"DataAdapter"});this.fire("oninit")},initComponents:function(f){for(var d in f){var c=f[d];var e=null;var b=null;var h=null;if(T.lang.isString(c)){e=c;h=e}else{e=c.type;b=c.options;if(c.id){h=c.id}else{h=e}}var g="_init"+e;if(g!="_init"&&T.lang.isFunction(this[g])){this[g]({id:h,type:e,options:b})}this.fire("on"+h+"Initialized")}},_getEventName:function(c,b){return b?b+c:"onchange"+c},_initTimeSpan:function(c){var b=this;this[c.id]=new T.TimeSpan(T.extend({onchange:function(d){b.fire(b._getEventName(c.id),d)}},c.options))},_initGuide:function(c){var b=this;this[c.id]=new T.Guide(T.extend({onsuccess:function(d){b.fire(b._getEventName(c.id,"onsuccess"),d)},onclose:function(){b.fire(b._getEventName(c.id,"onclose"))}},c.options))},_initFlashFormatConverter:function(c){var b=this;this[c.id]=new T.FlashFormatConverter({onchange:function(d){b.fire("beforeSetFlashData",d)}})},_initToggleTarget:function(c){var b=this;this[c.id]=T.ui.create(T.ToggleTarget,T.extend({data:b.memo,onchange:function(d){b.fire(b._getEventName(c.id),d)}},c.options))},_initTrackTarget:function(c){var b=this;this[c.id]=T.ui.create(T.TrackTarget,T.extend({onchange:function(d){b.fire(b._getEventName(c.id),d)}},c.options))},_initRecordTarget:function(c){var b=this;this[c.id]=T.ui.create(T.RecordTarget,T.extend({onchange:function(d){b.fire(b._getEventName(c.id),d)}},c.options))},_initChart:function(g){var f=this;var c=g.options||{};var e=c.type||"Line";var b=c.containerId||g.id;if(c.height){T.dom.setStyle(b,"height",c.height)}if(c.width){T.dom.setStyle(b,"width",c.width)}var d;if(T.browser.ie<9&&e=="Line"){d=new T.charts.Line4vml({containerId:b})}else{d=new T.charts[e]({containerId:b})}this[g.id]={chart:d,render:function(i){var h=i.items;if(!h||!h[0]||h[0].length==0){this.hideError();this.showError("暂无数据")}else{this.hideError();if(i.gran==null){i.gran=f.context.gran}if(i.gran==null){i.gran=f.context.st==f.context.et?6:5}i.type=e;c=T.charts.mixin.ChartConvert["convert"+e](i,c);this.chart.setOption(c)}},show:function(){T.show(b);this.chart.setOption()},hide:function(){T.hide(b)},showError:function(h){this.chart.showErrorTip(h)},hideError:function(){this.chart.hideErrorTip()},showLoading:function(){this.chart.showLoading()},hideLoading:function(){this.chart.hideLoading()}};this[g.id].showLoading()},_initFlash:function(e){var b=this.systemConfig.webRoot+"/flash/"+e.options.type+".swf",d=T.extend({flashId:e.id,baseUrl:this.systemConfig.webRoot+"/flash/fla"},e.options.vars);var c="transparent";if(T.browser.chrome&&e.options&&e.options.type=="line"){c="opaque"}T.swf.create({id:e.id,url:b,width:e.options.width||"100%",height:e.options.height||"270",bgColor:"#FFFFFF",wmode:c,errorMessage:"载入FLASH出错",ver:"9.0.0",allowscriptaccess:"always",vars:d},e.options.flashContainerId);this[e.id]=T.swf.getMovie(e.id)},getFlash:function(b){return T.swf.getMovie(b)},_initDownload:function(c){var b=this;this[c.id]=new T.ui.Download(T.extend({trigerId:"DownloadReport",reportId:this.pageInfo.id,siteId:this.siteInfo.id,url:T.format("#{0}/download/?",this.systemConfig.baseUri),reportTitle:this.pageInfo.title+" - 百度统计",onchange:function(d){b.fire(b._getEventName(c.id),d)}},c.options));this[c.id].render()},_initSendReport:function(c){var b=this;this[c.id]=new T.ui.SendReport(T.extend({trigerId:"SendReport",url:this.systemConfig.ajaxUri,method:"home/reportsend/add",reportId:this.pageInfo.id,siteId:this.siteInfo.id,reportTitle:this.pageInfo.title+" - 百度统计",onchange:function(d){b.fire(b._getEventName(c.id),d)}},c.options));this[c.id].render()},_initIntelligentAnalytics:function(c){var b=this;this[c.id]=new T.ui.IntelligentAnalytics(T.extend({containerId:"IntelligentAnalytics",onchange:function(d,e){b._bindFilterResult(c.id,b[c.id].options.containerId,e,"IntelligentAnalyticsFilterResults");b.fire(b._getEventName(c.id),d)},onchangeAdvice:function(d){b.fire(b._getEventName(c.id,"onchangeAdvice"),d)},ondeleteAdvice:function(d){b.fire(b._getEventName(c.id,"ondeleteAdvice"),d)}},c.options));this[c.id].render();this._bindFilterResult(c.id,this[c.id].options.containerId,this[c.id].getSelectedLabels(),"IntelligentAnalyticsFilterResults")},_initDataStatusBox:function(b){this[b.id]=new T.ui.DataStatusBox(T.extend({autoRender:true,onsuccess:function(c){}},b.options))},_initAreas:function(c){var b=this;this[c.id]=new T.ui.SelectGroup(T.extend({containerId:"Areas",label:"地域过滤",items:this.areaList,onchange:function(d,e){b._bindFilterResult(c.id,"Areas",e);b.fire(b._getEventName(c.id),d)}},c.options));this[c.id].render();b._bindFilterResult(c.id,"Areas",this[c.id].getSelectedLabels())},_filterFlag:{},_bindFilterResult:function(g,b,f,e){var d=this;var e=e||"FilterResults";this._filterFlag[e]=this._filterFlag[e]||{};if(T.g(b+"Result")){this._filterFlag[e][b]={};if(f==null||f.length==0||(f.length==1&&f[0]=="全部")){T.g(b+"Result").innerHTML="";this._filterFlag[e][b].hasValue=false}else{var c=f[f.length-1];if(c=="全部"){c=f[f.length-2]}T.g(b+"Result").innerHTML=T.format('<em class="result">!{0}</em><em class="reset"></em>',c);T.on(T.dom.one("#"+b+"Result .reset"),"click",function(h){T.event.stopPropagation(h);d[g].reset()});this._filterFlag[e][b].hasValue=true}}this._renderFilterResult(e)},_renderFilterResult:function(d){var d=d||"FilterResults";if(T.g(d)){var c=false;for(var b in this._filterFlag[d]){if(this._filterFlag[d][b].hasValue&&this._filterFlag[d][b].show!==false){c=true;break}}if(c){T.show(d)}else{T.hide(d)}}},showFilter:function(b,c){var c=c||"FilterResults";T.show(b);T.show(b+"Result");if(!this._filterFlag[c][b]){this._filterFlag[c][b]={}}this._filterFlag[c][b].show=true;this._renderFilterResult()},hideFilter:function(b,c){var c=c||"FilterResults";T.hide(b);T.hide(b+"Result");if(!this._filterFlag[c][b]){this._filterFlag[c][b]={}}this._filterFlag[c][b].show=false;this._renderFilterResult()},_initClientDevices:function(c){var b=this;this[c.id]=new T.ui.CheckGroup(T.extend({containerId:"ClientDevices",label:"设备过滤",limit:1,selectedItems:["all"],items:this.clientDeviceList,onchange:function(d,e){b._bindFilterResult(c.id,"ClientDevices",e);b.fire(b._getEventName(c.id),d)}},c.options));this[c.id].render();b._bindFilterResult(c.id,"ClientDevices",this[c.id].getSelectedLabels())},_initSources:function(c){var b=this;this[c.id]=new T.ui.SelectGroup(T.extend({containerId:"Sources",label:"来源过滤",items:this.sourceList,onchange:function(d,e){b._bindFilterResult(c.id,"Sources",e);b.fire(b._getEventName(c.id),d)}},c.options));this[c.id].render();b._bindFilterResult(c.id,"Sources",this[c.id].getSelectedLabels())},_initEngines:function(c){var b=this;if(c.options&&c.options.selectedItems){c.options.selectedItems=c.options.selectedItems.slice(1)}this[c.id]=new T.ui.SelectGroup(T.extend({containerId:"Engines",label:"搜索引擎",items:this.sourceList,onchange:function(d,e){b._bindFilterResult(c.id,"Engines",e);d.unshift("search");b.fire(b._getEventName(c.id),d)}},c.options));this[c.id].render();b._bindFilterResult(c.id,"Engines",this[c.id].getSelectedLabels())},_initVisitors:function(c){var b=this;this[c.id]=new T.ui.CheckGroup(T.extend({containerId:"Visitors",label:"访客过滤",limit:1,selectedItems:["all"],items:this.visitorList,onchange:function(d,e){b._bindFilterResult(c.id,"Visitors",e);b.fire(b._getEventName(c.id),d)}},c.options));this[c.id].render();b._bindFilterResult(c.id,"Visitors",this[c.id].getSelectedLabels())},_initVisitors2:function(c){var b=this;this[c.id]=new T.ui.SelectGroup(T.extend({containerId:"Visitors2",label:"访客过滤",items:this.visitorList,onchange:function(d,e){b._bindFilterResult(c.id,"Visitors2",e);b.fire(b._getEventName(c.id),d)}},c.options));this[c.id].render();b._bindFilterResult(c.id,"Visitors2",this[c.id].getSelectedLabels())},_initISP:function(c){var b=this;this[c.id]=new T.ui.SelectGroup(T.extend({containerId:"ISP",label:"网络提供商过滤",items:this.ispList,onchange:function(d,e){b._bindFilterResult(c.id,"ISP",e);b.fire(b._getEventName(c.id),d)}},c.options));this[c.id].render();b._bindFilterResult(c.id,"ISP",this[c.id].getSelectedLabels())},_initDomainTypes:function(c){var b=this;this[c.id]=new T.ui.CheckGroup(T.extend({containerId:"DomainTypes",limit:1,label:"网站类型",selectedItems:[0],items:this.domainTypeList,onchange:function(d,e){b._bindFilterResult(c.id,"DomainTypes",e);b.fire(b._getEventName(c.id),d)}},c.options));this[c.id].render();b._bindFilterResult(c.id,"DomainTypes",this[c.id].getSelectedLabels())},_initAdProducts:function(c){var b=this;this[c.id]=new T.ui.SelectGroup(T.extend({containerId:"AdProducts",label:"推广方式",items:this.adProductList,onchange:function(d,g,f,e){b._bindFilterResult(c.id,"AdProducts",g);b.fire(b._getEventName(c.id),d,g,f,e)}},c.options));this[c.id].render();b._bindFilterResult(c.id,"AdProducts",this[c.id].getSelectedLabels())},_initFuzzyQuery:function(c){var b=this;this[c.id]=new T.ui.FuzzyQuery(T.extend({onchange:function(d){b.fire(b._getEventName(c.id),d)}},c.options));this[c.id].render()},_initPlan:function(c){var b=this;this[c.id]=new T.ui.SelectGroup(T.extend({containerId:"Plan",items:this.planList,selectedItems:this.pageInfo.planId?[this.pageInfo.planId]:[],label:"计划&nbsp;&nbsp;",onchange:function(d){b.fire(b._getEventName(c.id),d)}},c.options));this[c.id].render()},_initUnit:function(c){var b=this;this[c.id]=new T.ui.SelectGroup(T.extend({containerId:"Unit",items:this.unitList?this.unitList:[{id:-1,label:"全部"}],selectedItems:this.pageInfo.unitId?[this.pageInfo.unitId]:[],label:"&nbsp;-&nbsp;单元&nbsp;&nbsp;",onchange:function(d){b.fire(b._getEventName(c.id),d)}},c.options));this[c.id].render()},_initTransTarget:function(h){var d=this;var g=[];for(var c in this.targetList){var f=this.targetList[c];g.push({id:f.id,label:f.label});if(f.children&&f.children.length>0){for(var b in f.children){var e=f.children[b];g.push({id:e.id,label:"  "+e.label})}}}this[h.id]=new T.ui.SelectGroup(T.extend({containerId:"TransTarget",label:"转化目标&nbsp;&nbsp;",items:g,onchange:function(i){d.fire(d._getEventName(h.id),i)}},h.options));this[h.id].render()},_initShortDate:function(c){var b=this;this[c.id]=new T.ShortDate(T.extend({onchange:function(d){b.fire(b._getEventName(c.id),d)}},c.options))},_initDate:function(c){var b=this;this[c.id]=new DateController(T.extend({todayDate:T.config.pageInfo.ed?new Date(+T.config.pageInfo.ed):"",firstDate:T.config.pageInfo.sd?new Date(+T.config.pageInfo.sd):"",startDate:new Date(+T.config.pageInfo.st),endDate:new Date(+T.config.pageInfo.et),otherStartDate:T.config.pageInfo.st2?new Date(+T.config.pageInfo.st2):"",otherEndDate:T.config.pageInfo.et2?new Date(+T.config.pageInfo.et2):"",onchange:function(d){b.fire(b._getEventName(c.id),{st:this.startDate&&this.startDate.getTime(),et:this.endDate&&this.endDate.getTime(),st2:this.otherStartDate&&this.otherStartDate.getTime(),et2:this.otherEndDate&&this.otherEndDate.getTime(),id:d})}},c.options))},_initTable:function(c){var b=this;this[c.id]=new T.ui.Table(T.extend({containerId:"Table",order:this.pageInfo.order,index:this.indexInfo.indexes[0],onchange:function(d){b.fire(b._getEventName(c.id),d)},onexpand:function(d){b.fire("onexpand"+c.id,d)},onoperate:function(d){b.fire("onoperate"+c.id,d)}},c.options))},_initOperations:function(c){var b=this;this[c.id]=new T.ui.Operations(T.extend({onchange:function(d,e){b.fire(b._getEventName(c.id),d,e)}},c.options))},_initSummary:function(b){this[b.id]=new T.ui.Summary(T.extend({containerId:"Summary"},b.options))},_initPaging:function(c){var b=this;this[c.id]=new T.ui.Paging(T.extend({containerId:"Paging",onchange:function(d){b.fire(b._getEventName(c.id),d)}},c.options))},_initFilterTabs:function(c){var b=this;this[c.id]=new T.ui.Tabs(T.extend({containerId:"FilterTabs",onchange:function(e,f,g,d){b.fire(b._getEventName(c.id),e,f,g,d)}},c.options))},_initIndicator:function(b){this[b.id]=new T.Indicator(T.extend({indicators:this.indexInfo.indicators,indexes:this.indexInfo.indexes},b.options))},_initDateCompare:function(c){var b=this;this[c.id]=new T.DateCompare(T.extend({onchange:function(e,d){b.fire(b._getEventName(c.id),e,d)}},c.options))},_initSimpleFlashIndicator:function(c){var b=this;this[c.id]=new T.ui.CheckGroup(T.extend({containerId:"FlashIndicatorContainer",items:this.indexInfo.flashIndicators,selectedItems:this.indexInfo.flashSelected,limit:this.indexInfo.maxFlashSelectedNumber,autoRender:true,onchange:function(d,e){b.fire(b._getEventName(c.id),d,e)}},c.options))},_initCharacters:function(c){var b=this;this[c.id]=new T.ui.CheckGroup(T.extend({containerId:"CharacterIndicatorContainer",limit:1,tip:true,label:"访问特征:&nbsp;&nbsp;",selectedItems:[this.characterList[0].id],items:this.characterList,onchange:function(d,e){b.fire(b._getEventName(c.id),d,e)}},c.options));this[c.id].render()},_initClients:function(c){var b=this;this[c.id]=new T.ui.CheckGroup(T.extend({containerId:"ClientIndicatorContainer",limit:1,tip:true,selectedItems:[this.clientList[0].id],items:this.clientList,onchange:function(d,e){b.fire(b._getEventName(c.id),d,e)}},c.options));this[c.id].render()},_initFlashIndicator:function(c){var b=this;this[c.id]=new T.ui.FlashIndicator(T.extend({containerId:"FlashIndicator",items:this.indexInfo.flashIndicators,selectedItems:this.indexInfo.flashSelected,defaultItems:this.indexInfo.defaultFlashSelected,limit:this.indexInfo.maxFlashSelectedNumber,autoRender:true,onchange:function(d){b.fire(b._getEventName(c.id),d)}},c.options));if(this.pageInfo.st2||this.pageInfo.et2){this[c.id].showSingleIndicatorContent()}},_initTableIndicator:function(c){var b=this;this[c.id]=new T.ui.TableIndicator(T.extend({containerId:"TableIndicator",items:this.indexInfo.indicators,groupNames:this.indexInfo.indicatorGroups,selected:this.indexInfo.selected,limit:this.indexInfo.maxSelectedNumber,defaultSelected:this.indexInfo.defaultSelected,autoRender:true,onchange:function(d){b.fire(b._getEventName(c.id),d)},oncancelChange:function(d){b.fire(b._getEventName(c.id,"oncancelChange"),d)}},c.options))},_initTip:function(b){T.ui.Tip.bindEvent();T.ui.Tip.loadTips()},_initDataAdapter:function(c){var b=this;this.DataAdapter=new T.DataAdapter(T.extend({onflashError:function(e,d){b.fire("onflashError",e,d)},onchartError:function(d,e){b.fire("onchartError",d,e)}},c.options))},_initCombobox:function(){var b=new T.ui.Combobox(T.extend({trigerId:"ComboboxContainer",autoRender:true,items:[]},param.options))},auth:function(b){return this.userInfo.auths[b]},role:function(b){return this.userInfo.roles[b]},ajax:function(e,b,d){var c=this;b=b||{};b.reportId=this.pageInfo.id;T.extend(b,{method:e.uri,queryId:e.queryId||""});c.fire("on"+e.name);T.ajax.jsonPost(this.systemConfig.ajaxUri,b,function(g,f){if(T.lang.isString(e.adapter)&&T.lang.isFunction(c.DataAdapter[e.adapter])){c.fire("on"+e.adapter,g,{postData:b});g=c.DataAdapter[e.adapter](g);c.fire("after"+e.adapter,g)}c.fire("on"+e.name+"Success",g,{status:f,postData:b,extData:d})},function(f){c.fire("on"+e.name+"Failed",f)})},download:function(b){T.g("DownloadChannel").src=b},setIndexItem:function(c,b){var e=T.object.clone(c);for(var d in c){delete c[d]}if(T.lang.isObject(b)){T.extend(c,b)}else{c.label=b}c.data=e},sendFlashImage:function(b){b.createImage("http://"+window.location.host+this.systemConfig.imageSaveUri,this.systemConfig.imageSaveMethod)},isSpecialWord:function(b){return T.array.contains(["其他","未知","--","未知（推广页面未装代码或存在跳转导致）"],b)}});T.extend(this,a);this._init()};